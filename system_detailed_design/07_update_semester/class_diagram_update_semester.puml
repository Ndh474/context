@startuml Update Semester - Class Diagram
!theme plain
skinparam classAttributeIconSize 0
hide circle
skinparam circledCharacterRadius 0

class SemesterController {
  - semesterService : SemesterService
  + update(id : Short, request : SemesterUpdateRequest) : Response<SemesterDTO>
}

class SemesterService {
  - semesterRepository : SemesterRepository
  - semesterMapper : SemesterMapper
  + update(id : Short, request : SemesterUpdateRequest) : SemesterDTO
}

interface SemesterRepository <<interface>> {
  + findById(id : Short) : Optional<Semester>
  + existsByCodeAndIdNot(code : String, id : Short) : boolean
  + existsByNameAndIdNot(name : String, id : Short) : boolean
  + existsByDateRangeOverlapAndIdNot(startDate : LocalDate, endDate : LocalDate, id : Short) : boolean
  + countActiveClassesBySemesterId(semesterId : Short) : long
  + save(entity : Semester) : Semester
}

interface SemesterMapper <<interface>> {
  + toDTO(entity : Semester) : SemesterDTO
  + updateSemesterFromRequest(request : SemesterUpdateRequest, semester : Semester) : void
}

class Semester {
  - id : Short
  - name : String
  - code : String
  - startDate : LocalDate
  - endDate : LocalDate
  - academicClasses : Set<AcademicClass>
}

class BaseEntity {
  - isActive : Boolean
  - createdAt : Instant
  - updatedAt : Instant
}

class SemesterUpdateRequest {
  - name : String
  - code : String
  - startDate : LocalDate
  - endDate : LocalDate
}

class BaseRequest {
  - isActive : Boolean
}

class SemesterDTO {
  - id : Short
  - name : String
  - code : String
  - startDate : LocalDate
  - endDate : LocalDate
  - totalClass : Short
}

class BaseDTO {
  - isActive : Boolean
  - createdAt : Instant
  - updatedAt : Instant
}

class Response<T> {
  - status : int
  - message : String
  - code : String
  - data : T
}

SemesterController --> SemesterService
SemesterService --> SemesterRepository
SemesterService --> SemesterMapper

SemesterController ..> Response : <<use>>
SemesterController ..> SemesterDTO : <<use>>
SemesterController ..> SemesterUpdateRequest : <<use>>
SemesterService ..> Semester : <<use>>
SemesterService ..> SemesterDTO : <<use>>
SemesterService ..> SemesterUpdateRequest : <<use>>
SemesterRepository ..> Semester : <<use>>
SemesterMapper ..> Semester : <<use>>
SemesterMapper ..> SemesterDTO : <<use>>
SemesterMapper ..> SemesterUpdateRequest : <<use>>

Semester --|> BaseEntity
SemesterUpdateRequest --|> BaseRequest
SemesterDTO --|> BaseDTO

@enduml
