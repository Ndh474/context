@startuml view_exam_schedule_supervisor
!theme plain
hide footbox

actor "Supervisor" as Supervisor

participant "«user interaction»\n:SupervisorDashboardPage" as UI
participant "«control»\n:DashboardController" as Controller
participant "«service»\n:SupervisorDashboardService" as Service
participant "«database wrapper»\n:SemesterRepository" as SemesterRepo
participant "«database wrapper»\n:SlotRepository" as SlotRepo

' === MAIN FLOW ===
Supervisor -> UI: Navigate to dashboard\nor select semester
activate UI

UI -> Controller: GET /api/v1/dashboard/supervisor?semesterId={id}
activate Controller

Controller -> Service: getDashboardData(supervisorId, semesterId)
activate Service

' === VALIDATION ===
alt Invalid supervisorId
    Service -->> Controller: <<throw>> BadRequestException
    Controller -->> UI: 400 Bad Request
    UI -->> Supervisor: Show error message
end

' === GET AVAILABLE SEMESTERS ===
Service -> SemesterRepo: findSemestersWithSupervisionData(supervisorId)
activate SemesterRepo
SemesterRepo -->> Service: List<Semester>
deactivate SemesterRepo

Service -> SemesterRepo: findCurrentSemesters()
activate SemesterRepo
SemesterRepo -->> Service: List<Semester>
deactivate SemesterRepo

' === CALCULATE STATS ===
Service -> SlotRepo: calculateSupervisorStats(supervisorId, semesterId)
activate SlotRepo
SlotRepo -->> Service: SupervisorStatsDTO
deactivate SlotRepo

' === GET RECENT ACTIVITY ===
Service -> SlotRepo: findRecentSupervisionActivity(supervisorId, semesterId, start, end)
activate SlotRepo
SlotRepo -->> Service: List<RecentActivitySlotDTO>
deactivate SlotRepo

' === GET UPCOMING EXAMS ===
Service -> SlotRepo: findUpcomingExamSlots(supervisorId, semesterId, now, maxResults)
activate SlotRepo
SlotRepo -->> Service: List<TodaySlotDTO>
deactivate SlotRepo

Service -->> Controller: SupervisorDashboardResponse
deactivate Service

Controller -->> UI: 200 OK
deactivate Controller

UI -->> Supervisor: Display dashboard\n(stats, upcoming exams, recent activity)
deactivate UI

@enduml
