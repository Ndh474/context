{
  "metadata": {
    "codebase": "frontend-web",
    "category": "component_student",
    "generated_at": "2025-11-20T20:18:33.071576",
    "total_files": 4,
    "total_lines": 816,
    "total_bytes": 31726
  },
  "files": [
    {
      "path": "d:\\Work\\do_an_fall25\\fuacs\\frontend-web\\components\\student\\attendance\\student-attendance-matrix.tsx",
      "relative_path": "components/student/attendance/student-attendance-matrix.tsx",
      "filename": "student-attendance-matrix.tsx",
      "size_bytes": 9397,
      "lines": 247,
      "last_modified": "2025-11-15T22:18:53.562806",
      "encoding": "utf-8",
      "language": "typescript-react",
      "content": "\"use client\";\n\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\nimport { Table } from \"lucide-react\";\n\n/**\n * Slot DTO minimal (extracted from attendance history response)\n */\ninterface SlotDTO {\n  slotId: number;\n  slotDate: string;         // \"2024-12-31\"\n  slotTime: string;         // \"14:30-16:30\"\n  slotCategory: \"LECTURE\" | \"LECTURE_WITH_PT\" | \"FINAL_EXAM\";\n}\n\n/**\n * Attendance records mapped by slotId\n */\ntype AttendanceRecords = Record<number, \"present\" | \"absent\" | \"not_yet\">;\n\ninterface StudentAttendanceMatrixProps {\n  slots: SlotDTO[];\n  attendanceRecords: AttendanceRecords;\n  studentInfo: {\n    rollNumber: string;\n    fullName: string;\n  };\n}\n\nexport function StudentAttendanceMatrix({\n  slots,\n  attendanceRecords,\n  studentInfo,\n}: StudentAttendanceMatrixProps) {\n  // Format date from YYYY-MM-DD to DD/MM/YYYY\n  const formatDate = (dateString: string): string => {\n    const [year, month, day] = dateString.split(\"-\");\n    return `${day}/${month}/${year}`;\n  };\n\n  const getStatusBadge = (status: \"present\" | \"absent\" | \"not_yet\" | undefined) => {\n    if (status === \"present\") {\n      return (\n        <Badge\n          variant=\"outline\"\n          className=\"bg-green-500/10 text-green-700 dark:text-green-400 border-green-500/20 hover:bg-green-500/10 text-xs px-2 py-0\"\n        >\n          P\n        </Badge>\n      );\n    } else if (status === \"absent\") {\n      return (\n        <Badge\n          variant=\"outline\"\n          className=\"bg-red-500/10 text-red-700 dark:text-red-400 border-red-500/20 hover:bg-red-500/10 text-xs px-2 py-0\"\n        >\n          A\n        </Badge>\n      );\n    } else {\n      // not_yet or undefined\n      return (\n        <Badge\n          variant=\"outline\"\n          className=\"bg-muted text-muted-foreground hover:bg-muted text-xs px-2 py-0\"\n        >\n          -\n        </Badge>\n      );\n    }\n  };\n\n  const getStatusText = (status: \"present\" | \"absent\" | \"not_yet\" | undefined) => {\n    if (status === \"present\") {\n      return { text: \"Present\", color: \"text-green-600 dark:text-green-400\" };\n    } else if (status === \"absent\") {\n      return { text: \"Absent\", color: \"text-red-600 dark:text-red-400\" };\n    } else {\n      return { text: \"Not Yet Recorded\", color: \"text-muted-foreground\" };\n    }\n  };\n\n  if (slots.length === 0) {\n    return (\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Table className=\"h-5 w-5\" />\n            Attendance Matrix\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"text-center py-8 text-muted-foreground\">\n            <Table className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n            <p>No slots found for this subject</p>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          <Table className=\"h-5 w-5\" />\n          Attendance Matrix\n        </CardTitle>\n      </CardHeader>\n      <CardContent>\n        <div className=\"overflow-x-auto\">\n          <div className=\"inline-block min-w-full align-middle\">\n            <div className=\"overflow-hidden border rounded-lg\">\n              <TooltipProvider delayDuration={500}>\n                <table className=\"min-w-full divide-y divide-border\">\n                  {/* Header Row - Sticky */}\n                  <thead className=\"bg-muted sticky top-0 z-10\">\n                    <tr>\n                      {/* Sticky first column header */}\n                      <th\n                        scope=\"col\"\n                        className=\"sticky left-0 z-20 bg-muted px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider border-r\"\n                      >\n                        Student\n                      </th>\n                      {/* Slot columns */}\n                      {slots.map((slot, index) => (\n                        <th\n                          key={slot.slotId}\n                          scope=\"col\"\n                          className=\"px-3 py-3 text-center text-xs font-medium text-muted-foreground uppercase tracking-wider min-w-[100px]\"\n                        >\n                          <div className=\"flex flex-col gap-1\">\n                            <span className=\"font-semibold text-foreground truncate\">\n                              Slot {index + 1}\n                            </span>\n                            <span className=\"text-[10px] text-muted-foreground font-normal\">\n                              {formatDate(slot.slotDate)}\n                            </span>\n                            <span className=\"text-[10px] text-muted-foreground font-normal\">\n                              {slot.slotTime}\n                            </span>\n                          </div>\n                        </th>\n                      ))}\n                    </tr>\n                  </thead>\n\n                  {/* Body Row (Single student) */}\n                  <tbody className=\"bg-background divide-y divide-border\">\n                    <tr className=\"bg-background\">\n                      {/* Sticky first column - Student info */}\n                      <td className=\"sticky left-0 z-10 bg-inherit px-4 py-3 border-r\">\n                        <div className=\"flex flex-col\">\n                          <span className=\"text-sm font-medium text-foreground truncate\">\n                            {studentInfo.rollNumber}\n                          </span>\n                          <span className=\"text-xs text-muted-foreground truncate max-w-[150px]\">\n                            {studentInfo.fullName}\n                          </span>\n                        </div>\n                      </td>\n\n                      {/* Attendance status cells */}\n                      {slots.map((slot) => {\n                        const status = attendanceRecords[slot.slotId];\n                        const statusInfo = getStatusText(status);\n                        return (\n                          <td\n                            key={`${studentInfo.rollNumber}-${slot.slotId}`}\n                            className=\"px-3 py-3 text-center\"\n                          >\n                            <Tooltip>\n                              <TooltipTrigger asChild>\n                                <div className=\"inline-block cursor-pointer\">\n                                  {getStatusBadge(status)}\n                                </div>\n                              </TooltipTrigger>\n                              <TooltipContent>\n                                <div className=\"text-xs space-y-1\">\n                                  <p className=\"font-semibold\">Slot {slots.indexOf(slot) + 1}</p>\n                                  <p className=\"text-muted-foreground\">\n                                    {formatDate(slot.slotDate)} {slot.slotTime}\n                                  </p>\n                                  <div className=\"pt-1 border-t\">\n                                    <p className={`font-medium ${statusInfo.color}`}>\n                                      {statusInfo.text}\n                                    </p>\n                                  </div>\n                                </div>\n                              </TooltipContent>\n                            </Tooltip>\n                          </td>\n                        );\n                      })}\n                    </tr>\n                  </tbody>\n                </table>\n              </TooltipProvider>\n            </div>\n          </div>\n        </div>\n\n        {/* Legend */}\n        <div className=\"mt-4 pt-4 border-t\">\n          <h4 className=\"font-medium mb-2 text-sm\">Legend</h4>\n          <div className=\"flex flex-wrap gap-4 text-sm\">\n            <div className=\"flex items-center gap-2\">\n              <Badge\n                variant=\"outline\"\n                className=\"bg-green-500/10 text-green-700 dark:text-green-400 border-green-500/20 hover:bg-green-500/10 text-xs px-2 py-0\"\n              >\n                P\n              </Badge>\n              <span className=\"text-muted-foreground\">Present</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Badge\n                variant=\"outline\"\n                className=\"bg-red-500/10 text-red-700 dark:text-red-400 border-red-500/20 hover:bg-red-500/10 text-xs px-2 py-0\"\n              >\n                A\n              </Badge>\n              <span className=\"text-muted-foreground\">Absent</span>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Badge\n                variant=\"outline\"\n                className=\"bg-muted text-muted-foreground hover:bg-muted text-xs px-2 py-0\"\n              >\n                -\n              </Badge>\n              <span className=\"text-muted-foreground\">Not Yet Recorded</span>\n            </div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n"
    },
    {
      "path": "d:\\Work\\do_an_fall25\\fuacs\\frontend-web\\components\\student\\schedule\\student-calendar-week-container.tsx",
      "relative_path": "components/student/schedule/student-calendar-week-container.tsx",
      "filename": "student-calendar-week-container.tsx",
      "size_bytes": 12797,
      "lines": 305,
      "last_modified": "2025-11-15T20:20:06.757252",
      "encoding": "utf-8",
      "language": "typescript-react",
      "content": "\"use client\";\n\nimport { useMemo } from \"react\";\nimport { useTranslations } from \"next-intl\";\nimport { format } from \"date-fns\";\nimport { formatDisplayTime } from \"@/lib/calendar-utils\";\nimport { CalendarTimeGrid } from \"@/components/lecturer/calendar/calendar-time-grid\";\nimport { CalendarDayColumn } from \"@/components/lecturer/calendar/calendar-day-column\";\nimport { getWeekDays, getDayOfWeek, isToday } from \"@/lib/calendar-utils\";\nimport { CALENDAR_CONFIG } from \"@/lib/calendar-config\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { cn } from \"@/lib/utils\";\nimport { Slot } from \"@/types\";\nimport { getSlotDisplayData, getSlotCategoryStyles } from \"@/lib/slot-utils\";\nimport { parseVietnamTime } from \"@/lib/timezone-utils\";\nimport { CheckCircle2, XCircle, Clock } from \"lucide-react\";\n\ninterface StudentCalendarWeekContainerProps {\n  mondayDate: Date;\n  slots: Slot[];\n  isLoading?: boolean;\n  onSlotClick: (slot: Slot) => void;\n}\n\n/**\n * Student Calendar Week Container\n * Adapted from lecturer calendar for student view\n */\nexport function StudentCalendarWeekContainer({\n  mondayDate,\n  slots,\n  isLoading,\n  onSlotClick,\n}: StudentCalendarWeekContainerProps) {\n  const t = useTranslations(\"student\");\n  const weekDays = getWeekDays(mondayDate);\n\n  // Normalize slots: set default \"not_yet\" for attendance status if not provided\n  // This handles cases where student is enrolled but attendance record doesn't exist yet\n  const normalizedSlots = useMemo(() => {\n    return slots.map(slot => ({\n      ...slot,\n      // Default to \"not_yet\" if status not provided (student enrolled but no attendance record)\n      studentAttendanceStatus: slot.studentAttendanceStatus ?? (\"not_yet\" as const)\n    }));\n  }, [slots]);\n\n  // Group slots by day (0=Monday, 6=Sunday)\n  const slotsByDay = useMemo(() => {\n    const grouped: Record<number, Slot[]> = {};\n\n    // Initialize all days\n    for (let i = 0; i < 7; i++) {\n      grouped[i] = [];\n    }\n\n    // Group slots by day\n    normalizedSlots.forEach((slot) => {\n      // CRITICAL: Backend sends Vietnam time without Z suffix\n      // Must use parseVietnamTime to interpret correctly\n      const slotDate = parseVietnamTime(slot.startTime);\n      const dayIndex = getDayOfWeek(slotDate);\n\n      // Check if slot is in current week by comparing date string (YYYY-MM-DD)\n      // Use format to get consistent date string regardless of timezone\n      const slotDateStr = format(slotDate, \"yyyy-MM-dd\");\n      const isInCurrentWeek = weekDays.some(\n        (day) => format(day, \"yyyy-MM-dd\") === slotDateStr\n      );\n\n      if (dayIndex >= 0 && dayIndex <= 6 && isInCurrentWeek) {\n        grouped[dayIndex].push(slot);\n      }\n    });\n\n    return grouped;\n  }, [normalizedSlots, weekDays]);\n\n  // Memoize slot display data for ALL days (avoid re-computing on each render)\n  // This is computed ONCE for all days, not inside the map loop (Rules of Hooks)\n  const slotsByDayWithData = useMemo(() => {\n    const result: Record<number, Array<{\n      slot: Slot;\n      displayData: ReturnType<typeof getSlotDisplayData>;\n      styles: ReturnType<typeof getSlotCategoryStyles>;\n      timeRange: string;\n    }>> = {};\n\n    for (let dayIndex = 0; dayIndex < 7; dayIndex++) {\n      const daySlots = slotsByDay[dayIndex] || [];\n      result[dayIndex] = daySlots.map((slot) => ({\n        slot,\n        displayData: getSlotDisplayData(slot),\n        styles: getSlotCategoryStyles(getSlotDisplayData(slot).slotCategory),\n        timeRange: `${formatDisplayTime(slot.startTime)} - ${formatDisplayTime(slot.endTime)}`,\n      }));\n    }\n\n    return result;\n  }, [slotsByDay]);\n\n  // Loading skeleton\n  if (isLoading) {\n    return (\n      <div className=\"rounded-lg border overflow-hidden\">\n        <div className=\"p-8 space-y-4\">\n          <Skeleton className=\"h-8 w-full\" />\n          <Skeleton className=\"h-64 w-full\" />\n          <Skeleton className=\"h-64 w-full\" />\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Desktop View */}\n      <div className=\"hidden lg:block rounded-lg border overflow-hidden\">\n        <div className=\"overflow-x-auto\">\n          <div className=\"min-w-[900px]\">\n            {/* Header Row - Day Names */}\n            <div className=\"flex bg-muted/50 border-b sticky top-0 z-20\">\n              {/* Time column spacer */}\n              <div\n                className=\"flex-shrink-0 border-r p-3 font-medium text-sm\"\n                style={{ width: `${CALENDAR_CONFIG.TIME_COLUMN_WIDTH}px` }}\n              >\n                Time\n              </div>\n\n              {/* Day headers */}\n              {weekDays.map((day, index) => {\n                const dayIsToday = isToday(day);\n\n                return (\n                  <div\n                    key={index}\n                    className={cn(\n                      \"flex-1 p-3 text-center border-l\",\n                      dayIsToday && \"bg-emerald-500/10 dark:bg-emerald-500/20 border-emerald-500 dark:border-emerald-400 border-l-2\"\n                    )}\n                  >\n                    <div className=\"font-semibold text-sm\">{format(day, \"EEE\")}</div>\n                    <div\n                      className={cn(\n                        \"text-xs text-muted-foreground\",\n                        dayIsToday && \"text-emerald-700 dark:text-emerald-400 font-semibold\"\n                      )}\n                    >\n                      {format(day, \"MMM d\")}\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n\n            {/* Body - Time Grid + Day Columns */}\n            <div className=\"flex\">\n              {/* Time Grid */}\n              <CalendarTimeGrid />\n\n              {/* Day Columns */}\n              {weekDays.map((day, index) => {\n                const daySlots = slotsByDay[index] || [];\n                const dayIsToday = isToday(day);\n                const isWeekend = index >= 5;\n\n                return (\n                  <CalendarDayColumn\n                    key={index}\n                    slots={daySlots}\n                    isToday={dayIsToday}\n                    isWeekend={isWeekend}\n                    onSlotClick={onSlotClick}\n                  />\n                );\n              })}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Mobile/Tablet View - Vertical List */}\n      <div className=\"lg:hidden space-y-4\">\n        {weekDays.map((day, dayIndex) => {\n          const slotsWithData = slotsByDayWithData[dayIndex] || [];\n          const dayIsToday = isToday(day);\n\n          return (\n            <div\n              key={dayIndex}\n              className={cn(\n                \"rounded-lg border p-4 space-y-3\",\n                dayIsToday && \"border-emerald-500 dark:border-emerald-400 bg-emerald-500/5 dark:bg-emerald-500/10\"\n              )}\n            >\n              {/* Day Header */}\n              <div className={cn(\"font-semibold\", dayIsToday && \"text-emerald-700 dark:text-emerald-400\")}>\n                {format(day, \"EEEE, MMMM d\")}\n                {dayIsToday && <span className=\"ml-2 text-xs font-normal\">({t(\"today\")})</span>}\n              </div>\n\n              {/* Slots for this day */}\n              {slotsWithData.length > 0 ? (\n                <div className=\"space-y-2\">\n                  {slotsWithData.map(({ slot, displayData, styles, timeRange }) => {\n\n                    return (\n                      <div\n                        key={slot.id}\n                        role=\"button\"\n                        tabIndex={0}\n                        className=\"cursor-pointer focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary rounded-md\"\n                        onClick={() => onSlotClick(slot)}\n                        onKeyDown={(e) => {\n                          if (e.key === 'Enter' || e.key === ' ') {\n                            e.preventDefault();\n                            onSlotClick(slot);\n                          }\n                        }}\n                        aria-label={`${displayData.subjectCode} ${displayData.categoryLabel} on ${format(day, \"EEEE\")}, ${timeRange}`}\n                      >\n                        <div className={cn(\n                          \"rounded-md border-l-4 p-3 bg-card hover:shadow-md transition-shadow\",\n                          styles.border,\n                          styles.bg\n                        )}>\n                          <div className=\"flex items-start justify-between gap-2\">\n                            <div className=\"flex-1 min-w-0\">\n                              <div className=\"font-semibold text-sm\">{displayData.subjectCode}</div>\n                              <div className=\"text-xs text-muted-foreground truncate\">\n                                {displayData.subjectName}\n                              </div>\n                            </div>\n                            <div className=\"text-xs font-medium capitalize text-muted-foreground\">\n                              {displayData.categoryLabel}\n                            </div>\n                          </div>\n                          <div className=\"mt-2 flex items-center justify-between gap-2\">\n                            <div className=\"text-xs text-muted-foreground\">\n                              {timeRange} • {displayData.roomName} • {displayData.staffName}\n                            </div>\n                            {/* Attendance status badge - always shown (normalized to \"not_yet\" if undefined) */}\n                            <div\n                              className={cn(\n                                \"text-xs font-semibold px-2 py-1 rounded-md border flex items-center gap-1.5 flex-shrink-0\",\n                                slot.studentAttendanceStatus === \"present\" && \"text-green-700 dark:text-green-300 bg-green-100 dark:bg-green-900/50 border-green-300 dark:border-green-700\",\n                                slot.studentAttendanceStatus === \"absent\" && \"text-red-700 dark:text-red-300 bg-red-100 dark:bg-red-900/50 border-red-300 dark:border-red-700\",\n                                slot.studentAttendanceStatus === \"not_yet\" && \"text-amber-700 dark:text-amber-300 bg-amber-100 dark:bg-amber-900/50 border-amber-300 dark:border-amber-700\"\n                              )}\n                            >\n                              {slot.studentAttendanceStatus === \"present\" && (\n                                <>\n                                  <CheckCircle2 className=\"h-3.5 w-3.5\" />\n                                  <span>Present</span>\n                                </>\n                              )}\n                              {slot.studentAttendanceStatus === \"absent\" && (\n                                <>\n                                  <XCircle className=\"h-3.5 w-3.5\" />\n                                  <span>Absent</span>\n                                </>\n                              )}\n                              {slot.studentAttendanceStatus === \"not_yet\" && (\n                                <>\n                                  <Clock className=\"h-3.5 w-3.5\" />\n                                  <span>Not Yet</span>\n                                </>\n                              )}\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    );\n                  })}\n                </div>\n              ) : (\n                <p className=\"text-sm text-muted-foreground text-center py-4\">\n                  No classes scheduled\n                </p>\n              )}\n            </div>\n          );\n        })}\n      </div>\n\n      {/* Legend */}\n      <div className=\"flex flex-wrap items-center gap-4 text-sm text-muted-foreground\">\n        <span className=\"font-medium\">Legend:</span>\n        <div className=\"flex items-center gap-2\">\n          <div className=\"w-4 h-4 rounded border-l-4 border-l-blue-500 bg-blue-500/10 dark:bg-blue-500/20\" />\n          <span>Lecture</span>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <div className=\"w-4 h-4 rounded border-l-4 border-l-purple-500 bg-purple-500/10 dark:bg-purple-500/20\" />\n          <span>Lecture with PT</span>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <div className=\"w-4 h-4 rounded border-l-4 border-l-red-500 bg-red-500/10 dark:bg-red-500/20\" />\n          <span>Exam</span>\n        </div>\n      </div>\n    </div>\n  );\n}"
    },
    {
      "path": "d:\\Work\\do_an_fall25\\fuacs\\frontend-web\\components\\student\\schedule\\student-schedule-header.tsx",
      "relative_path": "components/student/schedule/student-schedule-header.tsx",
      "filename": "student-schedule-header.tsx",
      "size_bytes": 1764,
      "lines": 63,
      "last_modified": "2025-11-13T21:14:04.113318",
      "encoding": "utf-8",
      "language": "typescript-react",
      "content": "\"use client\";\n\nimport { useTranslations } from \"next-intl\";\nimport { Button } from \"@/components/ui/button\";\nimport { ChevronLeft, ChevronRight } from \"lucide-react\";\nimport { formatWeekRange } from \"@/lib/calendar-utils\";\n\ninterface StudentScheduleHeaderProps {\n  dateRange: { mondayDate: Date; sundayDate: Date };\n  onPrevious: () => void;\n  onNext: () => void;\n  onToday: () => void;\n}\n\nexport function StudentScheduleHeader({\n  dateRange,\n  onPrevious,\n  onNext,\n  onToday,\n}: StudentScheduleHeaderProps) {\n  const t = useTranslations(\"schedule\");\n  const { mondayDate, sundayDate } = dateRange;\n  const weekRangeText = formatWeekRange(mondayDate, sundayDate);\n\n  return (\n    <div className=\"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between\">\n      {/* Week range display */}\n      <div className=\"text-xl font-semibold\">{weekRangeText}</div>\n\n      {/* Navigation buttons */}\n      <div className=\"flex items-center gap-2\">\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          onClick={onPrevious}\n          aria-label={t(\"navigate_previous_week\")}\n        >\n          <ChevronLeft className=\"h-4 w-4 mr-1\" aria-hidden=\"true\" />\n          {t(\"previous\")}\n        </Button>\n\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          onClick={onToday}\n          aria-label={t(\"navigate_current_week\")}\n        >\n          {t(\"today\")}\n        </Button>\n\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          onClick={onNext}\n          aria-label={t(\"navigate_next_week\")}\n        >\n          {t(\"next\")}\n          <ChevronRight className=\"h-4 w-4 ml-1\" aria-hidden=\"true\" />\n        </Button>\n      </div>\n    </div>\n  );\n}"
    },
    {
      "path": "d:\\Work\\do_an_fall25\\fuacs\\frontend-web\\components\\student\\schedule\\student-slot-detail-dialog.tsx",
      "relative_path": "components/student/schedule/student-slot-detail-dialog.tsx",
      "filename": "student-slot-detail-dialog.tsx",
      "size_bytes": 7768,
      "lines": 201,
      "last_modified": "2025-11-15T20:19:48.206356",
      "encoding": "utf-8",
      "language": "typescript-react",
      "content": "\"use client\";\n\nimport { useTranslations } from \"next-intl\";\nimport { format, parseISO } from \"date-fns\";\nimport { formatDisplayTime } from \"@/lib/calendar-utils\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport {\n  Calendar,\n  MapPin,\n  User,\n  BookOpen,\n  CheckCircle2,\n  XCircle,\n  Clock,\n} from \"lucide-react\";\nimport { Slot } from \"@/types\";\nimport { getSlotDisplayData } from \"@/lib/slot-utils\";\nimport { cn } from \"@/lib/utils\";\n\ninterface StudentSlotDetailDialogProps {\n  slot: Slot | null;\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n}\n\nexport function StudentSlotDetailDialog({\n  slot,\n  open,\n  onOpenChange,\n}: StudentSlotDetailDialogProps) {\n  const tStudent = useTranslations(\"student\");\n\n  if (!slot) return null;\n\n  // Normalize attendance status: default to \"not_yet\" if not provided\n  // This handles cases where student is enrolled but attendance record doesn't exist yet\n  const attendanceStatus = slot.studentAttendanceStatus ?? (\"not_yet\" as const);\n\n  // Extract display data using utility function\n  const displayData = getSlotDisplayData(slot);\n\n  const startTime = parseISO(slot.startTime);\n  const endTime = parseISO(slot.endTime);\n  const duration = Math.round((endTime.getTime() - startTime.getTime()) / (1000 * 60));\n\n  // Map category for styling\n  const getTypeKey = (label: string): \"lecture\" | \"lecture_with_pt\" | \"exam\" => {\n    if (label === \"Lecture\") return \"lecture\";\n    if (label === \"Lecture with PT\") return \"lecture_with_pt\";\n    return \"exam\";\n  };\n\n  const type = getTypeKey(displayData.categoryLabel);\n\n  const getTypeColor = (type: string) => {\n    switch (type) {\n      case \"lecture\":\n        return \"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 border-blue-300 dark:border-blue-700\";\n      case \"lecture_with_pt\":\n        return \"bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 border-purple-300 dark:border-purple-700\";\n      case \"exam\":\n        return \"bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200 border-red-300 dark:border-red-700\";\n      default:\n        return \"bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200 border-gray-300 dark:border-gray-700\";\n    }\n  };\n\n  const getTypeIcon = (type: string) => {\n    switch (type) {\n      case \"lecture\":\n        return <BookOpen className=\"h-4 w-4\" />;\n      case \"lecture_with_pt\":\n        return <BookOpen className=\"h-4 w-4\" />;\n      case \"exam\":\n        return <BookOpen className=\"h-4 w-4\" />;\n      default:\n        return <BookOpen className=\"h-4 w-4\" />;\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-md\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            {getTypeIcon(type)}\n            {displayData.subjectCode}\n          </DialogTitle>\n        </DialogHeader>\n\n        <div className=\"space-y-4\">\n          {/* Attendance Status - Prominent Display (always show in student view) */}\n          <div\n            className={cn(\n              \"p-4 rounded-lg border-2 flex items-center gap-3\",\n              attendanceStatus === \"present\" && \"bg-green-50 dark:bg-green-950 border-green-500 dark:border-green-600\",\n              attendanceStatus === \"absent\" && \"bg-red-50 dark:bg-red-950 border-red-500 dark:border-red-600\",\n              attendanceStatus === \"not_yet\" && \"bg-amber-50 dark:bg-amber-950 border-amber-500 dark:border-amber-600\"\n            )}\n          >\n            {attendanceStatus === \"present\" && (\n              <>\n                <CheckCircle2 className=\"h-6 w-6 text-green-600 dark:text-green-400 flex-shrink-0\" />\n                <div>\n                  <div className=\"font-semibold text-green-800 dark:text-green-300\">Attendance: Present</div>\n                  <div className=\"text-sm text-green-700 dark:text-green-400\">You have been marked as present</div>\n                </div>\n              </>\n            )}\n            {attendanceStatus === \"absent\" && (\n              <>\n                <XCircle className=\"h-6 w-6 text-red-600 dark:text-red-400 flex-shrink-0\" />\n                <div>\n                  <div className=\"font-semibold text-red-800 dark:text-red-300\">Attendance: Absent</div>\n                  <div className=\"text-sm text-red-700 dark:text-red-400\">You have been marked as absent</div>\n                </div>\n              </>\n            )}\n            {attendanceStatus === \"not_yet\" && (\n              <>\n                <Clock className=\"h-6 w-6 text-amber-600 dark:text-amber-400 flex-shrink-0\" />\n                <div>\n                  <div className=\"font-semibold text-amber-800 dark:text-amber-300\">Attendance: Not Yet Marked</div>\n                  <div className=\"text-sm text-amber-700 dark:text-amber-400\">Your attendance has not been recorded</div>\n                </div>\n              </>\n            )}\n          </div>\n\n          {/* Subject Info */}\n          <div>\n            <h3 className=\"font-medium text-sm mb-1\">{displayData.subjectName}</h3>\n            <Badge className={getTypeColor(type)} variant=\"outline\">\n              {displayData.categoryLabel}\n            </Badge>\n          </div>\n\n          <Separator />\n\n          {/* Time & Duration */}\n          <div className=\"space-y-3\">\n            <div className=\"flex items-center gap-3\">\n              <Calendar className=\"h-4 w-4 text-muted-foreground\" />\n              <div>\n                <div className=\"font-medium text-sm\">\n                  {format(startTime, \"EEEE, MMMM d, yyyy\")}\n                </div>\n                <div className=\"text-xs text-muted-foreground\">\n                  {formatDisplayTime(slot.startTime)} - {formatDisplayTime(slot.endTime)} ({duration} {tStudent(\"minutes\")})\n                </div>\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-3\">\n              <MapPin className=\"h-4 w-4 text-muted-foreground\" />\n              <div>\n                <div className=\"font-medium text-sm\">{displayData.roomName}</div>\n                <div className=\"text-xs text-muted-foreground\">{tStudent(\"classroom\")}</div>\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-3\">\n              <User className=\"h-4 w-4 text-muted-foreground\" />\n              <div>\n                <div className=\"font-medium text-sm\">{displayData.staffName}</div>\n                <div className=\"text-xs text-muted-foreground\">{tStudent(\"lecturer\")}</div>\n              </div>\n            </div>\n          </div>\n\n          <Separator />\n\n          {/* Additional Info for Exams */}\n          {type === \"exam\" && (\n            <>\n              <Separator />\n              <div className=\"p-3 rounded-lg bg-red-50 dark:bg-red-950 border border-red-200 dark:border-red-800\">\n                <div className=\"flex items-start gap-2\">\n                  <BookOpen className=\"h-4 w-4 text-red-600 dark:text-red-400 mt-0.5\" />\n                  <div className=\"text-sm\">\n                    <p className=\"font-medium text-red-800 dark:text-red-300\">{tStudent(\"exam_information\")}</p>\n                    <p className=\"text-red-700 dark:text-red-400 text-xs mt-1\">\n                      {tStudent(\"exam_arrive_early\")}\n                    </p>\n                  </div>\n                </div>\n              </div>\n            </>\n          )}\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}"
    }
  ]
}