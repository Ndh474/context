{
  "metadata": {
    "codebase": "frontend-web",
    "category": "lib_util",
    "generated_at": "2025-11-24T20:05:17.465618",
    "total_files": 20,
    "total_lines": 6645,
    "total_bytes": 203175
  },
  "files": [
    {
      "path": "D:\\Work\\do_an_fall25\\fuacs\\frontend-web\\lib\\auth.ts",
      "relative_path": "lib/auth.ts",
      "filename": "auth.ts",
      "size_bytes": 3825,
      "lines": 141,
      "last_modified": "2025-11-24T18:35:55.520015",
      "encoding": "utf-8",
      "language": "typescript",
      "content": "import {\n  AUTH_REFRESH_TOKEN_KEY,\n  AUTH_TOKEN_KEY,\n  AUTH_USER_KEY,\n} from \"./constants\";\nimport type { AuthenticatedUser } from \"@/types\";\n\nexport const setAuthToken = (token: string): void => {\n  if (typeof window === \"undefined\") return;\n  localStorage.setItem(AUTH_TOKEN_KEY, token);\n};\n\nexport const getAuthToken = (): string | null => {\n  if (typeof window === \"undefined\") return null;\n  return localStorage.getItem(AUTH_TOKEN_KEY);\n};\n\nexport const clearAuthToken = (): void => {\n  if (typeof window === \"undefined\") return;\n  localStorage.removeItem(AUTH_TOKEN_KEY);\n};\n\nexport const setRefreshToken = (token: string): void => {\n  if (typeof window === \"undefined\") return;\n  localStorage.setItem(AUTH_REFRESH_TOKEN_KEY, token);\n};\n\nexport const getRefreshToken = (): string | null => {\n  if (typeof window === \"undefined\") return null;\n  return localStorage.getItem(AUTH_REFRESH_TOKEN_KEY);\n};\n\nexport const clearRefreshToken = (): void => {\n  if (typeof window === \"undefined\") return;\n  localStorage.removeItem(AUTH_REFRESH_TOKEN_KEY);\n};\n\nexport const setAuthUser = (user: AuthenticatedUser): void => {\n  if (typeof window === \"undefined\") return;\n  localStorage.setItem(AUTH_USER_KEY, JSON.stringify(user));\n};\n\nexport const clearAuthUser = (): void => {\n  if (typeof window === \"undefined\") return;\n  localStorage.removeItem(AUTH_USER_KEY);\n};\n\nexport const getAuthUser = (): AuthenticatedUser | null => {\n  if (typeof window === \"undefined\") return null;\n\n  const storedUser = localStorage.getItem(AUTH_USER_KEY);\n  if (!storedUser) {\n    return null;\n  }\n\n  try {\n    return JSON.parse(storedUser) as AuthenticatedUser;\n  } catch {\n    clearAuthUser();\n    return null;\n  }\n};\n\nexport const clearAuthSession = (): void => {\n  clearAuthToken();\n  clearRefreshToken();\n  clearAuthUser();\n};\n\nexport const getUserId = (): number | null => {\n  const user = getAuthUser();\n  return user?.userId ?? null;\n};\n\nexport const getStudentId = (): number | null => {\n  const user = getAuthUser();\n  // Ensure user has STUDENT role before returning ID\n  if (user && user.roles.includes(\"STUDENT\")) {\n    return user.userId;\n  }\n  return null;\n};\n\nexport const getLecturerId = (): number | null => {\n  const user = getAuthUser();\n  // Ensure user has LECTURER role before returning ID\n  if (user && user.roles.includes(\"LECTURER\")) {\n    return user.userId;\n  }\n  return null;\n};\n\nexport const getSupervisorId = (): number | null => {\n  const user = getAuthUser();\n  // Ensure user has SUPERVISOR role before returning ID\n  if (user && user.roles.includes(\"SUPERVISOR\")) {\n    return user.userId;\n  }\n  return null;\n};\n\nexport const getAdminId = (): number | null => {\n  const user = getAuthUser();\n  // Ensure user has DATA_OPERATOR role before returning ID\n  if (user && user.roles.includes(\"DATA_OPERATOR\")) {\n    return user.userId;\n  }\n  return null;\n};\n\n/**\n * Get the default redirect path based on user roles\n * Priority order: LECTURER > SUPERVISOR > STUDENT > DATA_OPERATOR\n *\n * @param roles - Array of role names from login response\n * @returns Path to redirect to after login\n */\nexport const getRoleBasedRedirectPath = (roles: string[]): string => {\n  // Check for lecturer role first\n  if (roles.includes(\"LECTURER\")) {\n    return \"/lecturer/dashboard\";\n  }\n\n  // Check for supervisor role\n  if (roles.includes(\"SUPERVISOR\")) {\n    return \"/supervisor/dashboard\";\n  }\n\n  // Check for student role\n  if (roles.includes(\"STUDENT\")) {\n    return \"/student/dashboard\";\n  }\n\n  // Check for admin role (DATA_OPERATOR)\n  if (roles.includes(\"DATA_OPERATOR\")) {\n    return \"/admin/dashboard\";\n  }\n\n  // Default fallback (should not happen with proper RBAC)\n  return \"/\";\n};\n"
    },
    {
      "path": "D:\\Work\\do_an_fall25\\fuacs\\frontend-web\\lib\\calendar-config.ts",
      "relative_path": "lib/calendar-config.ts",
      "filename": "calendar-config.ts",
      "size_bytes": 1923,
      "lines": 51,
      "last_modified": "2025-11-14T23:40:40.926528",
      "encoding": "utf-8",
      "language": "typescript",
      "content": "/**\n * Calendar Configuration\n * Core constants for calendar week view layout and calculations\n */\n\nexport const CALENDAR_CONFIG = {\n  // Time range\n  START_HOUR: 7,  // 7:00 AM - Start of academic day\n  END_HOUR: 22,   // 10:00 PM - End of academic day\n\n  // Layout dimensions\n  PIXELS_PER_HOUR: 40,      // 1 hour = 40px (compact view, no scroll needed)\n  TIME_COLUMN_WIDTH: 80,    // Width of time labels column (px)\n  HEADER_HEIGHT: 60,        // Height of day header row (px)\n  MIN_SLOT_HEIGHT: 30,      // Minimum slot card height (px)\n\n  // Spacing\n  SLOT_PADDING: 2,          // Padding between overlapping slots (px)\n  GRID_LINE_COLOR: \"#e5e7eb\", // Color for hour grid lines (gray-200)\n\n  // Colors for slot categories\n  CATEGORY_COLORS: {\n    LECTURE: {\n      bg: \"bg-blue-50 dark:bg-blue-950\",\n      border: \"border-l-blue-500 dark:border-l-blue-400\",\n      text: \"text-blue-900 dark:text-blue-100\",\n    },\n    LECTURE_WITH_PT: {\n      bg: \"bg-purple-50 dark:bg-purple-950\",\n      border: \"border-l-purple-500 dark:border-l-purple-400\",\n      text: \"text-purple-900 dark:text-purple-100\",\n    },\n    FINAL_EXAM: {\n      bg: \"bg-red-50 dark:bg-red-950\",\n      border: \"border-l-red-500 dark:border-l-red-400\",\n      text: \"text-red-900 dark:text-red-100\",\n    },\n  },\n} as const;\n\n// Derived constants\nexport const PIXELS_PER_HOUR = CALENDAR_CONFIG.PIXELS_PER_HOUR; // 40px per hour (for convenience)\nexport const PIXELS_PER_MINUTE = CALENDAR_CONFIG.PIXELS_PER_HOUR / 60; // ~0.667px per minute\nexport const TOTAL_HOURS = CALENDAR_CONFIG.END_HOUR - CALENDAR_CONFIG.START_HOUR; // 15 hours (7-22)\nexport const TOTAL_HEIGHT = TOTAL_HOURS * CALENDAR_CONFIG.PIXELS_PER_HOUR; // 600px (compact)\n\n// Hour array for grid rendering\nexport const HOUR_ARRAY = Array.from(\n  { length: TOTAL_HOURS + 1 },\n  (_, i) => CALENDAR_CONFIG.START_HOUR + i\n); // [7, 8, 9, ..., 22]\n"
    },
    {
      "path": "D:\\Work\\do_an_fall25\\fuacs\\frontend-web\\lib\\calendar-utils.ts",
      "relative_path": "lib/calendar-utils.ts",
      "filename": "calendar-utils.ts",
      "size_bytes": 9265,
      "lines": 307,
      "last_modified": "2025-11-09T20:23:57.410911",
      "encoding": "utf-8",
      "language": "typescript",
      "content": "/**\n * Calendar Utilities\n * Helper functions for position calculations, overlap detection, and date formatting\n *\n * IMPORTANT: Backend sends timestamps in Vietnam timezone (Asia/Ho_Chi_Minh) without 'Z' suffix.\n * All time parsing must interpret these timestamps AS Vietnam time, not browser local time.\n */\n\nimport { parseISO, format, startOfWeek, endOfWeek, addDays, isSameDay } from \"date-fns\";\nimport { Slot } from \"@/types\";\nimport { CALENDAR_CONFIG, PIXELS_PER_MINUTE } from \"./calendar-config\";\nimport {\n  parseVietnamTime,\n  getVietnamHours,\n  getVietnamMinutes,\n  formatVietnamTime,\n  getVietnamNow,\n} from \"./timezone-utils\";\n\n/**\n * Convert ISO time string to minutes from midnight (Vietnam time)\n * Backend sends Vietnam time like \"2024-10-30T08:30:00\" (no Z suffix).\n * We must interpret this AS Vietnam time, not browser local time.\n * Example: \"2024-10-30T08:30:00\" â†’ 510 (8*60 + 30 in Vietnam timezone)\n */\nexport function timeToMinutes(timeString: string): number {\n  const date = parseVietnamTime(timeString);\n  return getVietnamHours(date) * 60 + getVietnamMinutes(date);\n}\n\n/**\n * Calculate top position offset from grid start\n * Example: If grid starts at 7:00 and slot starts at 8:30:\n * - Start minutes: 510 (8:30)\n * - Grid start: 420 (7:00)\n * - Offset: 90 minutes = 90px\n */\nexport function calculateSlotTop(startTime: string): number {\n  const startMinutes = timeToMinutes(startTime);\n  const gridStartMinutes = CALENDAR_CONFIG.START_HOUR * 60;\n  const offsetMinutes = startMinutes - gridStartMinutes;\n\n  return Math.max(0, offsetMinutes * PIXELS_PER_MINUTE);\n}\n\n/**\n * Calculate slot height based on duration\n * Example: 8:00 - 9:30 = 90 minutes = 90px\n */\nexport function calculateSlotHeight(startTime: string, endTime: string): number {\n  const startMinutes = timeToMinutes(startTime);\n  const endMinutes = timeToMinutes(endTime);\n  const durationMinutes = endMinutes - startMinutes;\n  const height = durationMinutes * PIXELS_PER_MINUTE;\n\n  // Enforce minimum height\n  return Math.max(height, CALENDAR_CONFIG.MIN_SLOT_HEIGHT);\n}\n\n/**\n * Check if a slot is within calendar display range (Vietnam timezone)\n */\nexport function isSlotInRange(startTime: string, endTime: string): boolean {\n  const startDate = parseVietnamTime(startTime);\n  const endDate = parseVietnamTime(endTime);\n  const startHour = getVietnamHours(startDate);\n  const endHour = getVietnamHours(endDate);\n\n  return (\n    startHour >= CALENDAR_CONFIG.START_HOUR &&\n    endHour <= CALENDAR_CONFIG.END_HOUR\n  );\n}\n\n/**\n * Interface for positioned slot with layout info\n */\nexport interface PositionedSlot {\n  slot: Slot;\n  top: number;           // Top position in pixels\n  height: number;        // Height in pixels\n  column: number;        // Overlap column index (0-based)\n  totalColumns: number;  // Total overlapping slots\n}\n\n/**\n * Check if two slots overlap in time\n */\nexport function slotsOverlap(slot1: Slot, slot2: Slot): boolean {\n  const start1 = timeToMinutes(slot1.startTime);\n  const end1 = timeToMinutes(slot1.endTime);\n  const start2 = timeToMinutes(slot2.startTime);\n  const end2 = timeToMinutes(slot2.endTime);\n\n  return start1 < end2 && end1 > start2;\n}\n\n/**\n * Detect overlapping slots and assign them to groups\n * Returns slots grouped by overlap\n */\nexport function groupOverlappingSlots(slots: Slot[]): Slot[][] {\n  if (slots.length === 0) return [];\n\n  // Sort by start time\n  const sorted = [...slots].sort(\n    (a, b) => timeToMinutes(a.startTime) - timeToMinutes(b.startTime)\n  );\n\n  const groups: Slot[][] = [];\n\n  sorted.forEach((slot) => {\n    // Find a group that this slot overlaps with\n    let foundGroup = false;\n\n    for (const group of groups) {\n      const overlapsWithGroup = group.some((groupSlot) =>\n        slotsOverlap(slot, groupSlot)\n      );\n\n      if (overlapsWithGroup) {\n        group.push(slot);\n        foundGroup = true;\n        break;\n      }\n    }\n\n    // If no overlapping group found, create a new group\n    if (!foundGroup) {\n      groups.push([slot]);\n    }\n  });\n\n  return groups;\n}\n\n/**\n * Calculate positions for all slots, including overlap handling\n */\nexport function calculateSlotPositions(slots: Slot[]): PositionedSlot[] {\n  const groups = groupOverlappingSlots(slots);\n  const positioned: PositionedSlot[] = [];\n\n  groups.forEach((group) => {\n    const totalColumns = group.length;\n\n    group.forEach((slot, index) => {\n      positioned.push({\n        slot,\n        top: calculateSlotTop(slot.startTime),\n        height: calculateSlotHeight(slot.startTime, slot.endTime),\n        column: index,\n        totalColumns,\n      });\n    });\n  });\n\n  return positioned;\n}\n\n/**\n * Get day of week from date (0 = Monday, 6 = Sunday)\n * This matches the week view layout\n */\nexport function getDayOfWeek(date: Date | string): number {\n  const refDate = typeof date === \"string\" ? parseISO(date) : date;\n  const day = refDate.getDay();\n  // Convert JS day (0=Sun) to our day (0=Mon)\n  return day === 0 ? 6 : day - 1;\n}\n\n/**\n * Get week range from a specific date\n */\nexport function getWeekRange(date: Date | string): {\n  startDate: Date;\n  endDate: Date;\n  mondayDate: Date;\n  sundayDate: Date;\n} {\n  const refDate = typeof date === \"string\" ? parseISO(date) : date;\n  const monday = startOfWeek(refDate, { weekStartsOn: 1 });\n  const sunday = endOfWeek(refDate, { weekStartsOn: 1 });\n\n  // Debug removed to reduce console spam\n\n  return {\n    startDate: monday,\n    endDate: sunday,\n    mondayDate: monday,\n    sundayDate: sunday,\n  };\n}\n\n/**\n * Get all days in a week as array\n * Returns [Monday, Tuesday, ..., Sunday]\n */\nexport function getWeekDays(mondayDate: Date): Date[] {\n  const days: Date[] = [];\n  for (let i = 0; i < 7; i++) {\n    days.push(addDays(mondayDate, i));\n  }\n  return days;\n}\n\n/**\n * Navigate to previous week\n */\nexport function getPreviousWeek(currentDate: Date): Date {\n  return addDays(currentDate, -7);\n}\n\n/**\n * Navigate to next week\n */\nexport function getNextWeek(currentDate: Date): Date {\n  return addDays(currentDate, 7);\n}\n\n/**\n * Check if date is today (in Vietnam timezone)\n * Important: \"today\" is determined by Vietnam date, not browser local date\n */\nexport function isToday(date: Date | string): boolean {\n  const refDate = typeof date === \"string\" ? parseVietnamTime(date) : date;\n  const now = getVietnamNow();\n  return isSameDay(refDate, now);\n}\n\n/**\n * Format time from ISO string for display (Vietnam timezone)\n * Backend sends: \"2024-10-30T08:00:00\" (Vietnam time, no Z)\n * Display: \"08:00\" (always 8:00 AM Vietnam time, regardless of browser timezone)\n */\nexport function formatTimeFromISO(isoString: string): string {\n  const date = parseVietnamTime(isoString);\n  return formatVietnamTime(date, \"HH:mm\");\n}\n\n/**\n * Format time from ISO string for display (Vietnam timezone)\n * Backend sends: \"2024-10-30T08:00:00\" (Vietnam time, no Z)\n * Display: \"08:00\" (always 8:00 AM Vietnam time, regardless of browser timezone)\n */\nexport function formatDisplayTime(isoString: string): string {\n  const date = parseVietnamTime(isoString);\n  return formatVietnamTime(date, \"HH:mm\");\n}\n\n/**\n * Format time range for display (Vietnam timezone)\n * Example: \"08:00 - 09:30\"\n * Backend sends Vietnam time, display shows Vietnam time\n */\nexport function formatTimeRange(startISO: string, endISO: string): string {\n  const start = formatTimeFromISO(startISO);\n  const end = formatTimeFromISO(endISO);\n  return `${start} - ${end}`;\n}\n\n/**\n * Format week range for display\n * Example: \"October 28 - November 3, 2024\"\n */\nexport function formatWeekRange(mondayDate: Date, sundayDate: Date): string {\n  const startMonth = format(mondayDate, \"MMMM\");\n  const endMonth = format(sundayDate, \"MMMM\");\n  const startDay = format(mondayDate, \"d\");\n  const endDay = format(sundayDate, \"d\");\n  const year = format(sundayDate, \"yyyy\");\n\n  if (startMonth === endMonth) {\n    return `${startMonth} ${startDay} - ${endDay}, ${year}`;\n  } else {\n    return `${startMonth} ${startDay} - ${endMonth} ${endDay}, ${year}`;\n  }\n}\n\n/**\n * Format date for display (full format)\n * Example: \"Wednesday, October 30, 2024\"\n */\nexport function formatFullDate(date: Date | string): string {\n  const refDate = typeof date === \"string\" ? parseISO(date) : date;\n  return format(refDate, \"EEEE, MMMM d, yyyy\");\n}\n\n/**\n * Get current time position for \"current time\" indicator line (Vietnam timezone)\n * Returns pixel offset from grid start, or null if outside range\n */\nexport function getCurrentTimePosition(): number | null {\n  const now = getVietnamNow();\n  const currentHour = getVietnamHours(now);\n\n  // Check if current time is within calendar range\n  if (currentHour < CALENDAR_CONFIG.START_HOUR || currentHour > CALENDAR_CONFIG.END_HOUR) {\n    return null;\n  }\n\n  const currentMinutes = currentHour * 60 + getVietnamMinutes(now);\n  const gridStartMinutes = CALENDAR_CONFIG.START_HOUR * 60;\n  const offsetMinutes = currentMinutes - gridStartMinutes;\n\n  return offsetMinutes * PIXELS_PER_MINUTE;\n}\n"
    },
    {
      "path": "D:\\Work\\do_an_fall25\\fuacs\\frontend-web\\lib\\constants.ts",
      "relative_path": "lib/constants.ts",
      "filename": "constants.ts",
      "size_bytes": 47799,
      "lines": 1324,
      "last_modified": "2025-11-24T11:05:58.692875",
      "encoding": "utf-8",
      "language": "typescript",
      "content": "export const DEFAULT_PAGE_SIZE = 10;\n// Page size for combobox filters (maximize per docs 1-50)\nexport const FILTER_PAGE_SIZE = 50;\n\nexport const QUERY_KEYS = {\n  semesters: {\n    all: [\"semesters\"],\n    detail: (id: number) => [\"semesters\", id],\n    classes: (id: number) => [\"semesters\", id, \"classes\"],\n    subjects: (id: number) => [\"semesters\", id, \"subjects\"],\n    students: (id: number) => [\"semesters\", id, \"students\"],\n  },\n  majors: {\n    all: [\"majors\"],\n    detail: (id: number) => [\"majors\", id],\n    subjects: (id: number) => [\"majors\", id, \"subjects\"],\n  },\n  roles: {\n    all: [\"roles\"],\n    detail: (id: number) => [\"roles\", id],\n  },\n  permissions: {\n    all: [\"permissions\"],\n    detail: (id: number) => [\"permissions\", id],\n  },\n  subjects: {\n    all: [\"subjects\"],\n    detail: (id: number) => [\"subjects\", id],\n    classes: (id: number) => [\"subjects\", id, \"classes\"],\n  },\n  classes: {\n    all: [\"classes\"],\n    detail: (id: number) => [\"classes\", id],\n    slots: (id: number) => [\"classes\", id, \"slots\"],\n  },\n  rooms: {\n    all: [\"rooms\"],\n    detail: (id: number) => [\"rooms\", id],\n    cameras: (id: number) => [\"rooms\", id, \"cameras\"],\n    slots: (id: number) => [\"rooms\", id, \"slots\"],\n  },\n  cameras: {\n    all: [\"cameras\"],\n    detail: (id: number) => [\"cameras\", id],\n  },\n  slots: {\n    all: [\"slots\"],\n    detail: (id: number) => [\"slots\", id],\n    roster: (id: number) => [\"slots\", id, \"roster\"],\n    hasAttendance: (id: number) => [\"slots\", id, \"hasAttendance\"],\n  },\n  examParticipants: {\n    all: (slotId: number) => [\"exam-participants\", slotId],\n    allParticipants: (slotId: number) => [\"exam-participants\", \"all\", slotId],\n    detail: (slotId: number, participantId: number) => [\n      \"exam-participants\",\n      slotId,\n      participantId,\n    ],\n  },\n  examSlotSubjects: {\n    all: (slotId: number) => [\"exam-slots\", slotId, \"subjects\"],\n  },\n  attendanceRecords: {\n    all: [\"attendance-records\"],\n    detail: (id: number) => [\"attendance-records\", id],\n  },\n  examAttendanceRecords: {\n    all: [\"exam-attendance\"],\n    detail: (id: number) => [\"exam-attendance\", id],\n  },\n  enrollments: {\n    all: [\"enrollments\"],\n    detail: (classId: number, studentUserId: number) => [\n      \"enrollments\",\n      classId,\n      studentUserId,\n    ],\n    byClass: (classId: number) => [\"classes\", classId, \"enrollments\"],\n  },\n  studentProfiles: {\n    all: [\"student-profiles\"],\n    detail: (id: number) => [\"student-profiles\", id],\n    classes: (id: number) => [\"student-profiles\", id, \"classes\"],\n    attendanceHistory: (id: number) => [\n      \"student-profiles\",\n      id,\n      \"attendance-history\",\n    ],\n    subjects: (id: number) => [\"student-profiles\", id, \"subjects\"],\n    slots: (id: number) => [\"student-profiles\", id, \"slots\"],\n  },\n  staffProfiles: {\n    all: [\"staff-profiles\"],\n    detail: (id: number) => [\"staff-profiles\", id],\n    classes: (id: number) => [\"staff-profiles\", id, \"classes\"],\n    subjects: (id: number) => [\"staff-profiles\", id, \"subjects\"],\n    rooms: (id: number) => [\"staff-profiles\", id, \"rooms\"],\n    slots: (id: number) => [\"staff-profiles\", id, \"slots\"],\n  },\n  users: {\n    all: [\"users\"],\n    detail: (id: number) => [\"users\", id],\n  },\n  lecturer: {\n    schedule: (year: number, month: number) => [\n      \"lecturer\",\n      \"schedule\",\n      year,\n      month,\n    ],\n    roster: (classId: string, date: string) => [\n      \"lecturer\",\n      \"roster\",\n      classId,\n      date,\n    ],\n  },\n  students: {\n    semesters: (studentId: number) => [\"students\", studentId, \"semesters\"],\n  },\n  adminUsers: {\n    lecturerSemestersClasses: (userId: number) => [\n      \"admin-users\",\n      userId,\n      \"lecturer-semesters-classes\",\n    ],\n  },\n};\n\nexport const API_ENDPOINTS = {\n  auth: {\n    login: \"/auth/login\",\n    logout: \"/auth/logout\",\n    refresh: \"/auth/refresh-token\",\n    googleLogin: \"/auth/google/login\",\n    forgotPassword: \"/auth/forgot-password\",\n    resetPassword: \"/auth/reset-password\",\n  },\n  semesters: {\n    all: \"/semesters\",\n    byId: (id: number | string) => `/semesters/${id}`,\n    classes: (id: number | string) => `/semesters/${id}/classes`,\n    subjects: (id: number | string) => `/semesters/${id}/subjects`,\n    students: (id: number | string) => `/semesters/${id}/students`,\n    import: \"/semesters/import\",\n  },\n  majors: {\n    all: \"/majors\",\n    byId: (id: number | string) => `/majors/${id}`,\n    subjects: (id: number | string) => `/majors/${id}/subjects`,\n    import: \"/majors/import\",\n  },\n  roles: {\n    all: \"/roles\",\n    byId: (id: number | string) => `/roles/${id}`,\n  },\n  permissions: {\n    all: \"/permissions\",\n    byId: (id: number | string) => `/permissions/${id}`,\n  },\n  subjects: {\n    all: \"/subjects\",\n    byId: (id: number | string) => `/subjects/${id}`,\n    classes: (id: number | string) => `/subjects/${id}/classes`,\n    import: \"/subjects/import\",\n  },\n  classes: {\n    all: \"/classes\",\n    byId: (id: number | string) => `/classes/${id}`,\n    slots: (id: number | string) => `/classes/${id}/slots`,\n    import: \"/classes/import\",\n  },\n  rooms: {\n    all: \"/rooms\",\n    byId: (id: number | string) => `/rooms/${id}`,\n    cameras: (id: number | string) => `/rooms/${id}/cameras`,\n    slots: (id: number | string) => `/rooms/${id}/slots`,\n    import: \"/rooms/import\",\n  },\n  cameras: {\n    all: \"/cameras\",\n    byId: (id: number | string) => `/cameras/${id}`,\n    import: \"/cameras/import\",\n  },\n  slots: {\n    all: \"/slots\",\n    byId: (id: number | string) => `/slots/${id}`,\n    updateCategory: (id: number | string) => `/slots/${id}/category`,\n    import: \"/slots/import\",\n    importExams: \"/slots/import-exams\",\n    roster: (id: number | string) => `/slots/${id}/roster`,\n    startSession: (id: number | string) => `/slots/${id}/start-session`,\n    stopSession: (id: number | string) => `/slots/${id}/stop-session`,\n    rescan: (id: number | string) => `/slots/${id}/rescan`,\n    submitAttendance: (id: number | string) => `/slots/${id}/submit-attendance`,\n    hasAttendanceRecords: (id: number | string) => `/slots/${id}/has-attendance-records`,\n    // Exam session endpoints\n    startExamSession: (id: number | string) =>\n      `/slots/${id}/start-exam-session`,\n    stopExamSession: (id: number | string) => `/slots/${id}/stop-exam-session`,\n    rescanExam: (id: number | string) => `/slots/${id}/rescan-exam`,\n  },\n  examParticipants: {\n    all: (slotId: number | string) => `/exam-slots/${slotId}/participants`,\n    allParticipants: (slotId: number | string) => `/exam-slots/${slotId}/all-participants`,\n    byId: (slotId: number | string, participantId: number | string) =>\n      `/exam-slots/${slotId}/participants/${participantId}`,\n    import: \"/exam-slot-participants/import\",\n    // TODO: CSV bulk import endpoint - line 802 in API docs\n    // bulk: (slotId: number | string) =>\n    //   `/exam-slots/${slotId}/participants/bulk`,\n    // TODO: Download CSV template - line 981 in API docs\n    // template: (slotId: number | string) =>\n    //   `/exam-slots/${slotId}/participants/bulk/template`,\n  },\n  examSlotSubjects: {\n    all: (slotId: number | string) => `/exam-slots/${slotId}/subjects`,\n    byId: (slotId: number | string, subjectId: number | string) =>\n      `/exam-slots/${slotId}/subjects/${subjectId}`,\n  },\n  examSlots: {\n    attendanceReport: (slotId: number | string) =>\n      `/exam-slots/${slotId}/attendance-report`,\n  },\n  export: {\n    classesExcel: \"/export/classes/excel\",\n    classesCsv: \"/export/classes/csv\",\n    slotsExcel: \"/export/slots/excel\",\n    slotsCsv: \"/export/slots/csv\",\n  },\n  attendanceRecords: {\n    all: \"/attendance-records\",\n    byId: (id: number | string) => `/attendance-records/${id}`,\n    bulkUpdate: \"/attendance-records/bulk-update\",\n  },\n  examAttendance: {\n    all: \"/exam-attendance\",\n    byId: (id: number | string) => `/exam-attendance/${id}`,\n    bulkUpdate: \"/exam-attendance/bulk-update\",\n  },\n  enrollments: {\n    all: \"/enrollments\",\n    byId: (classId: number | string, studentUserId: number | string) =>\n      `/enrollments/${classId}/${studentUserId}`,\n    bulk: \"/enrollments/bulk\",\n    template: \"/enrollments/bulk/template\",\n    import: \"/enrollments/import\",\n    byClass: (classId: number | string) => `/classes/${classId}/enrollments`,\n  },\n  studentProfiles: {\n    all: \"/student-profiles\",\n    byId: (id: number | string) => `/student-profiles/${id}`,\n    import: \"/student-profiles/import\",\n    bulkUploadPhotosEmbeddings: \"/student-profiles/bulk-upload-photos-embeddings\",\n    classes: (id: number | string) => `/student-profiles/${id}/classes`,\n    attendanceHistory: (id: number | string) =>\n      `/student-profiles/${id}/attendance-history`,\n    subjects: (id: number | string) => `/student-profiles/${id}/subjects`,\n    slots: (id: number | string) => `/student-profiles/${id}/slots`,\n  },\n  staffProfiles: {\n    all: \"/staff-profiles\",\n    byId: (id: number | string) => `/staff-profiles/${id}`,\n    import: \"/staff-profiles/import\",\n    classes: (id: number | string) => `/staff-profiles/${id}/classes`,\n    subjects: (id: number | string) => `/staff-profiles/${id}/subjects`,\n    rooms: (id: number | string) => `/staff-profiles/${id}/rooms`,\n    slots: (id: number | string) => `/staff-profiles/${id}/slots`,\n  },\n  users: {\n    updatePassword: (id: number | string) => `/users/${id}/update-password`,\n  },\n  lecturer: {\n    schedule: (year: number, month: number) =>\n      `/lecturer/schedule/${year}/${month}`,\n    roster: (classId: string, date: string) =>\n      `/lecturer/roster/${classId}?date=${date}`,\n    submitAttendance: \"/lecturer/attendance/submit\",\n    semestersClasses: \"/lecturer/semesters-classes\",\n  },\n  students: {\n    semesters: (studentId: number | string) => `/students/${studentId}/semesters`,\n  },\n  adminUsers: {\n    lecturerSemestersClasses: (userId: number | string) =>\n      `/admin/users/${userId}/lecturer-semesters-classes`,\n  },\n};\n\nexport const AUTH_TOKEN_KEY = \"fuacs-auth-token\";\nexport const AUTH_REFRESH_TOKEN_KEY = \"fuacs-refresh-token\";\nexport const AUTH_USER_KEY = \"fuacs-auth-user\";\n\n// HTTP Status Codes\nexport const HTTP_STATUS = {\n  OK: 200,\n  CREATED: 201,\n  BAD_REQUEST: 400,\n  UNAUTHORIZED: 401,\n  FORBIDDEN: 403,\n  NOT_FOUND: 404,\n  CONFLICT: 409,\n  INTERNAL_SERVER_ERROR: 500,\n} as const;\n\n// API Error Codes (string codes from backend)\nexport const ERROR_CODES = {\n  // Common errors\n  INVALID_FIELD_TYPE: \"INVALID_FIELD_TYPE\",\n  MALFORMED_JSON: \"MALFORMED_JSON\",\n\n  // Semester errors\n  SEMESTER_NAME_REQUIRED: \"SEMESTER_NAME_REQUIRED\",\n  SEMESTER_CODE_REQUIRED: \"SEMESTER_CODE_REQUIRED\",\n  SEMESTER_START_DATE_REQUIRED: \"SEMESTER_START_DATE_REQUIRED\",\n  SEMESTER_END_DATE_REQUIRED: \"SEMESTER_END_DATE_REQUIRED\",\n  SEMESTER_NAME_EXISTS: \"SEMESTER_NAME_EXISTS\",\n  SEMESTER_CODE_EXISTS: \"SEMESTER_CODE_EXISTS\",\n  SEMESTER_DATE_RANGE_EXISTS: \"SEMESTER_DATE_RANGE_EXISTS\",\n  SEMESTER_INVALID_DATE_RANGE: \"SEMESTER_INVALID_DATE_RANGE\",\n  SEMESTER_NOT_FOUND: \"SEMESTER_NOT_FOUND\",\n  SEMESTER_HAS_ACTIVE_CLASSES: \"SEMESTER_HAS_ACTIVE_CLASSES\",\n  INVALID_START_DATE_FORMAT: \"INVALID_START_DATE_FORMAT\",\n  INVALID_END_DATE_FORMAT: \"INVALID_END_DATE_FORMAT\",\n  INVALID_MULTIPART_REQUEST: \"INVALID_MULTIPART_REQUEST\",\n  INVALID_IMPORT_MODE: \"INVALID_IMPORT_MODE\",\n\n  // Major errors\n  MAJOR_NAME_REQUIRED: \"MAJOR_NAME_REQUIRED\",\n  MAJOR_CODE_REQUIRED: \"MAJOR_CODE_REQUIRED\",\n  MAJOR_NAME_EXISTS: \"MAJOR_NAME_EXISTS\",\n  MAJOR_CODE_EXISTS: \"MAJOR_CODE_EXISTS\",\n  MAJOR_NOT_FOUND: \"MAJOR_NOT_FOUND\",\n  MAJOR_HAS_ACTIVE_DEPENDENCIES: \"MAJOR_HAS_ACTIVE_DEPENDENCIES\",\n  MAJOR_HAS_DEPENDENCIES: \"MAJOR_HAS_DEPENDENCIES\",\n\n  // Role errors\n  ROLE_NOT_FOUND: \"ROLE_NOT_FOUND\",\n  ROLE_NAME_EXISTS: \"ROLE_NAME_EXISTS\",\n  ROLE_CONSTRAINT: \"ROLE_CONSTRAINT\",\n\n  // Permission errors\n  PERMISSION_NOT_FOUND: \"PERMISSION_NOT_FOUND\",\n  PERMISSION_NAME_EXISTS: \"PERMISSION_NAME_EXISTS\",\n  PERMISSION_CONSTRAINT: \"PERMISSION_CONSTRAINT\",\n\n  // Subject errors\n  SUBJECT_NAME_REQUIRED: \"SUBJECT_NAME_REQUIRED\",\n  SUBJECT_CODE_REQUIRED: \"SUBJECT_CODE_REQUIRED\",\n  SUBJECT_MAJOR_IDS_REQUIRED: \"SUBJECT_MAJOR_IDS_REQUIRED\",\n  SUBJECT_MAJOR_IDS_EMPTY: \"SUBJECT_MAJOR_IDS_EMPTY\",\n  SUBJECT_NAME_EXISTS: \"SUBJECT_NAME_EXISTS\",\n  SUBJECT_CODE_EXISTS: \"SUBJECT_CODE_EXISTS\",\n  SUBJECT_NOT_FOUND: \"SUBJECT_NOT_FOUND\",\n  SUBJECT_HAS_ACTIVE_CLASSES: \"SUBJECT_HAS_ACTIVE_CLASSES\",\n  SUBJECT_HAS_DEPENDENCIES: \"SUBJECT_HAS_DEPENDENCIES\",\n  INACTIVE_MAJOR_NOT_ALLOWED: \"INACTIVE_MAJOR_NOT_ALLOWED\",\n\n  // Class errors\n  CLASS_CODE_REQUIRED: \"CLASS_CODE_REQUIRED\",\n  CLASS_SEMESTER_ID_REQUIRED: \"CLASS_SEMESTER_ID_REQUIRED\",\n  CLASS_SUBJECT_ID_REQUIRED: \"CLASS_SUBJECT_ID_REQUIRED\",\n  CLASS_EXISTS: \"CLASS_EXISTS\",\n  CLASS_NOT_FOUND: \"CLASS_NOT_FOUND\",\n  CLASS_HAS_ACTIVE_DEPENDENCIES: \"CLASS_HAS_ACTIVE_DEPENDENCIES\",\n  CLASS_HAS_DEPENDENCIES: \"CLASS_HAS_DEPENDENCIES\",\n  INACTIVE_REFERENCE_NOT_ALLOWED: \"INACTIVE_REFERENCE_NOT_ALLOWED\",\n\n  // Room errors\n  ROOM_NAME_REQUIRED: \"ROOM_NAME_REQUIRED\",\n  ROOM_NAME_EXISTS: \"ROOM_NAME_EXISTS\",\n  ROOM_NOT_FOUND: \"ROOM_NOT_FOUND\",\n  ROOM_HAS_CAMERAS: \"ROOM_HAS_CAMERAS\",\n  ROOM_HAS_SCHEDULED_SLOTS: \"ROOM_HAS_SCHEDULED_SLOTS\",\n  ROOM_HAS_ACTIVE_CAMERAS: \"ROOM_HAS_ACTIVE_CAMERAS\",\n  ROOM_HAS_ACTIVE_SLOTS: \"ROOM_HAS_ACTIVE_SLOTS\",\n\n  // Camera errors\n  CAMERA_NAME_REQUIRED: \"CAMERA_NAME_REQUIRED\",\n  CAMERA_RTSP_URL_REQUIRED: \"CAMERA_RTSP_URL_REQUIRED\",\n  CAMERA_ROOM_ID_REQUIRED: \"CAMERA_ROOM_ID_REQUIRED\",\n  CAMERA_NAME_EXISTS: \"CAMERA_NAME_EXISTS\",\n  RTSP_URL_EXISTS: \"RTSP_URL_EXISTS\",\n  CAMERA_NOT_FOUND: \"CAMERA_NOT_FOUND\",\n\n  // Slot errors\n  SLOT_START_TIME_REQUIRED: \"SLOT_START_TIME_REQUIRED\",\n  SLOT_END_TIME_REQUIRED: \"SLOT_END_TIME_REQUIRED\",\n  SLOT_CLASS_ID_REQUIRED: \"SLOT_CLASS_ID_REQUIRED\",\n  SLOT_ROOM_ID_REQUIRED: \"SLOT_ROOM_ID_REQUIRED\",\n  SLOT_STAFF_USER_ID_REQUIRED: \"SLOT_STAFF_USER_ID_REQUIRED\",\n  SLOT_CATEGORY_REQUIRED: \"SLOT_CATEGORY_REQUIRED\",\n  SLOT_IS_ACTIVE_REQUIRED: \"SLOT_IS_ACTIVE_REQUIRED\",\n  INVALID_SLOT_CATEGORY: \"INVALID_SLOT_CATEGORY\",\n  INVALID_SLOT_CATEGORY_TRANSITION: \"INVALID_SLOT_CATEGORY_TRANSITION\",\n  INVALID_TIME_RANGE: \"INVALID_TIME_RANGE\",\n  INVALID_SLOT_DURATION: \"INVALID_SLOT_DURATION\",\n  SLOT_OUTSIDE_SEMESTER_RANGE: \"SLOT_OUTSIDE_SEMESTER_RANGE\",\n  ROOM_TIME_CONFLICT: \"ROOM_TIME_CONFLICT\",\n  STAFF_TIME_CONFLICT: \"STAFF_TIME_CONFLICT\",\n  SLOT_NOT_FOUND: \"SLOT_NOT_FOUND\",\n  SLOT_HAS_DEPENDENCIES: \"SLOT_HAS_DEPENDENCIES\",\n  DELETE_TIME_RESTRICTION: \"DELETE_TIME_RESTRICTION\",\n  EXAM_ATTENDANCE_EXISTS: \"EXAM_ATTENDANCE_EXISTS\",\n  INVALID_STAFF_ROLE_FOR_SLOT: \"INVALID_STAFF_ROLE_FOR_SLOT\",\n  INVALID_STAFF_ROLE: \"INVALID_STAFF_ROLE\",\n  NOT_ASSIGNED_TO_SLOT: \"NOT_ASSIGNED_TO_SLOT\",\n  SESSION_NOT_STARTED: \"SESSION_NOT_STARTED\",\n  INVALID_FINALIZATION_RULE: \"INVALID_FINALIZATION_RULE\",\n  INSUFFICIENT_PERMISSIONS_FOR_FULL_UPDATE:\n    \"INSUFFICIENT_PERMISSIONS_FOR_FULL_UPDATE\",\n  NOT_ASSIGNED_TO_CLASS: \"NOT_ASSIGNED_TO_CLASS\",\n  // Exam session errors\n  EXAM_SESSION_RUNNING: \"EXAM_SESSION_RUNNING\",\n  EXAM_SESSION_ALREADY_RUNNING: \"EXAM_SESSION_ALREADY_RUNNING\",\n  REGULAR_SESSION_RUNNING: \"REGULAR_SESSION_RUNNING\",\n  EXAM_SESSION_NOT_STARTED: \"EXAM_SESSION_NOT_STARTED\",\n  USE_EXAM_RESCAN_INSTEAD: \"USE_EXAM_RESCAN_INSTEAD\",\n  NO_INITIAL_EXAM_SCAN: \"NO_INITIAL_EXAM_SCAN\",\n  NO_STUDENTS_FOR_EXAM_SESSION: \"NO_STUDENTS_FOR_EXAM_SESSION\",\n\n  // Exam participant errors\n  STUDENT_USER_ID_REQUIRED: \"STUDENT_USER_ID_REQUIRED\",\n  INVALID_USER_ROLE: \"INVALID_USER_ROLE\",\n  INVALID_SLOT_TYPE: \"INVALID_SLOT_TYPE\",\n  INACTIVE_STUDENT_NOT_ALLOWED: \"INACTIVE_STUDENT_NOT_ALLOWED\",\n  ALREADY_ENROLLED: \"ALREADY_ENROLLED\",\n  PARTICIPANT_NOT_FOUND: \"PARTICIPANT_NOT_FOUND\",\n  HAS_ATTENDANCE_RECORDS: \"HAS_ATTENDANCE_RECORDS\",\n  IS_ENROLLED_REQUIRED: \"IS_ENROLLED_REQUIRED\",\n  INVALID_CSV_FORMAT: \"INVALID_CSV_FORMAT\",\n  FILE_TOO_LARGE: \"FILE_TOO_LARGE\",\n  TOO_MANY_ROWS: \"TOO_MANY_ROWS\",\n  FILE_REQUIRED: \"FILE_REQUIRED\",\n  INVALID_FILE_TYPE: \"INVALID_FILE_TYPE\",\n\n  // Exam slot subject errors\n  SUBJECT_ID_REQUIRED: \"SUBJECT_ID_REQUIRED\",\n  DUPLICATE_SUBJECTS_NOT_ALLOWED: \"DUPLICATE_SUBJECTS_NOT_ALLOWED\",\n  EXAM_SLOT_SUBJECT_NOT_FOUND: \"EXAM_SLOT_SUBJECT_NOT_FOUND\",\n  EXAM_SLOT_SUBJECT_HAS_PARTICIPANTS: \"EXAM_SLOT_SUBJECT_HAS_PARTICIPANTS\",\n  INVALID_EXAM_SLOT_TYPE: \"INVALID_EXAM_SLOT_TYPE\",\n\n  // Attendance Record errors\n  ATTENDANCE_RECORD_NOT_FOUND: \"ATTENDANCE_RECORD_NOT_FOUND\",\n  STATUS_REQUIRED: \"STATUS_REQUIRED\",\n  REMARK_REQUIRED: \"REMARK_REQUIRED\",\n  REMARK_CANNOT_BE_EMPTY: \"REMARK_CANNOT_BE_EMPTY\",\n  INVALID_STATUS_VALUE: \"INVALID_STATUS_VALUE\",\n  EDIT_WINDOW_EXPIRED: \"EDIT_WINDOW_EXPIRED\",\n\n  // Exam Attendance errors\n  EXAM_ATTENDANCE_NOT_FOUND: \"EXAM_ATTENDANCE_NOT_FOUND\",\n\n  // Exam Attendance Remark errors\n  REMARK_NOT_FOUND: \"REMARK_NOT_FOUND\",\n\n  // Enrollment errors\n  CLASS_ID_REQUIRED: \"CLASS_ID_REQUIRED\",\n  ENROLLMENT_NOT_FOUND: \"ENROLLMENT_NOT_FOUND\",\n  RECOGNITIONS_REQUIRED: \"RECOGNITIONS_REQUIRED\",\n  RECOGNITIONS_EMPTY: \"RECOGNITIONS_EMPTY\",\n  TOO_MANY_RECOGNITIONS: \"TOO_MANY_RECOGNITIONS\",\n  INVALID_CONFIDENCE_VALUE: \"INVALID_CONFIDENCE_VALUE\",\n  INVALID_API_KEY: \"INVALID_API_KEY\",\n\n  // Time-based validation errors\n  CLASS_ALREADY_STARTED: \"CLASS_ALREADY_STARTED\",\n  SLOT_ALREADY_STARTED: \"SLOT_ALREADY_STARTED\",\n\n  // Student Profile errors\n  STUDENT_PROFILE_NOT_FOUND: \"STUDENT_PROFILE_NOT_FOUND\",\n  FULL_NAME_REQUIRED: \"FULL_NAME_REQUIRED\",\n  EMAIL_REQUIRED: \"EMAIL_REQUIRED\",\n  USERNAME_REQUIRED: \"USERNAME_REQUIRED\",\n  ROLL_NUMBER_REQUIRED: \"ROLL_NUMBER_REQUIRED\",\n  MAJOR_ID_REQUIRED: \"MAJOR_ID_REQUIRED\",\n  INVALID_EMAIL_FORMAT: \"INVALID_EMAIL_FORMAT\",\n  INVALID_USERNAME_FORMAT: \"INVALID_USERNAME_FORMAT\",\n  INVALID_ROLL_NUMBER_FORMAT: \"INVALID_ROLL_NUMBER_FORMAT\",\n  EMAIL_EXISTS: \"EMAIL_EXISTS\",\n  USERNAME_EXISTS: \"USERNAME_EXISTS\",\n  ROLL_NUMBER_EXISTS: \"ROLL_NUMBER_EXISTS\",\n\n  // Staff Profile errors\n  STAFF_PROFILE_NOT_FOUND: \"STAFF_PROFILE_NOT_FOUND\",\n  STAFF_CODE_REQUIRED: \"STAFF_CODE_REQUIRED\",\n  ROLES_REQUIRED: \"ROLES_REQUIRED\",\n  INVALID_ROLE: \"INVALID_ROLE\",\n  STAFF_CODE_EXISTS: \"STAFF_CODE_EXISTS\",\n  ROLE_ASSIGNMENT_CONFLICT: \"ROLE_ASSIGNMENT_CONFLICT\",\n\n  // Common errors\n  USER_NOT_FOUND: \"USER_NOT_FOUND\",\n  FORBIDDEN: \"FORBIDDEN\",\n  INVALID_PAGE: \"INVALID_PAGE\",\n  INVALID_PAGE_SIZE: \"INVALID_PAGE_SIZE\",\n  INVALID_SORT: \"INVALID_SORT\",\n  INVALID_SORT_BY: \"INVALID_SORT_BY\",\n  INVALID_STATUS: \"INVALID_STATUS\",\n  INVALID_ATTENDANCE_STATUS: \"INVALID_ATTENDANCE_STATUS\",\n\n  // Foreign key constraint\n  FOREIGN_KEY_CONSTRAINT_VIOLATION: \"FOREIGN_KEY_CONSTRAINT_VIOLATION\",\n} as const;\n\n// API Error Catalog - Links status code, error code, and message\nexport const API_ERRORS = {\n  // Common errors (400)\n  [ERROR_CODES.INVALID_FIELD_TYPE]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_FIELD_TYPE,\n    message: \"Invalid field type provided.\",\n  },\n  [ERROR_CODES.MALFORMED_JSON]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.MALFORMED_JSON,\n    message: \"Malformed JSON request.\",\n  },\n\n  // Semester validation errors (400)\n  [ERROR_CODES.SEMESTER_NAME_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SEMESTER_NAME_REQUIRED,\n    message: \"Semester name is required.\",\n  },\n  [ERROR_CODES.SEMESTER_CODE_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SEMESTER_CODE_REQUIRED,\n    message: \"Semester code is required.\",\n  },\n  [ERROR_CODES.SEMESTER_START_DATE_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SEMESTER_START_DATE_REQUIRED,\n    message: \"Start date is required.\",\n  },\n  [ERROR_CODES.SEMESTER_END_DATE_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SEMESTER_END_DATE_REQUIRED,\n    message: \"End date is required.\",\n  },\n  [ERROR_CODES.SEMESTER_INVALID_DATE_RANGE]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SEMESTER_INVALID_DATE_RANGE,\n    message: \"Start date must be before end date.\",\n  },\n  [ERROR_CODES.INVALID_START_DATE_FORMAT]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_START_DATE_FORMAT,\n    message: \"Invalid start date format. Expected YYYY-MM-DD.\",\n  },\n  [ERROR_CODES.INVALID_END_DATE_FORMAT]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_END_DATE_FORMAT,\n    message: \"Invalid end date format. Expected YYYY-MM-DD.\",\n  },\n\n  // Semester conflict errors (400/409)\n  [ERROR_CODES.SEMESTER_NAME_EXISTS]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SEMESTER_NAME_EXISTS,\n    message: \"A semester with this name already exists.\",\n  },\n  [ERROR_CODES.SEMESTER_CODE_EXISTS]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SEMESTER_CODE_EXISTS,\n    message: \"A semester with this code already exists.\",\n  },\n  [ERROR_CODES.SEMESTER_DATE_RANGE_EXISTS]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SEMESTER_DATE_RANGE_EXISTS,\n    message: \"A semester with this date range already exists.\",\n  },\n\n  // Semester not found (404)\n  [ERROR_CODES.SEMESTER_NOT_FOUND]: {\n    status: HTTP_STATUS.NOT_FOUND,\n    code: ERROR_CODES.SEMESTER_NOT_FOUND,\n    message: \"Semester not found. It may have been deleted.\",\n  },\n\n  // Semester business logic errors (409)\n  [ERROR_CODES.SEMESTER_HAS_ACTIVE_CLASSES]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.SEMESTER_HAS_ACTIVE_CLASSES,\n    message:\n      \"Cannot deactivate semester with ongoing classes. Deactivate classes first.\",\n  },\n\n  // Major validation errors (400)\n  [ERROR_CODES.MAJOR_NAME_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.MAJOR_NAME_REQUIRED,\n    message: \"Major name is required.\",\n  },\n  [ERROR_CODES.MAJOR_CODE_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.MAJOR_CODE_REQUIRED,\n    message: \"Major code is required.\",\n  },\n  [ERROR_CODES.MAJOR_NAME_EXISTS]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.MAJOR_NAME_EXISTS,\n    message: \"A major with this name already exists.\",\n  },\n  [ERROR_CODES.MAJOR_CODE_EXISTS]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.MAJOR_CODE_EXISTS,\n    message: \"A major with this code already exists.\",\n  },\n\n  // Major not found (404)\n  [ERROR_CODES.MAJOR_NOT_FOUND]: {\n    status: HTTP_STATUS.NOT_FOUND,\n    code: ERROR_CODES.MAJOR_NOT_FOUND,\n    message: \"Major not found. It may have been deleted.\",\n  },\n\n  // Major business logic errors (409)\n  [ERROR_CODES.MAJOR_HAS_ACTIVE_DEPENDENCIES]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.MAJOR_HAS_ACTIVE_DEPENDENCIES,\n    message:\n      \"Cannot deactivate major. Found active subjects and enrolled students.\",\n  },\n  [ERROR_CODES.MAJOR_HAS_DEPENDENCIES]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.MAJOR_HAS_DEPENDENCIES,\n    message:\n      \"Cannot delete major. Found subjects and students. Please reassign or delete them first.\",\n  },\n\n  // Role validation errors (400)\n  [ERROR_CODES.ROLE_NAME_EXISTS]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.ROLE_NAME_EXISTS,\n    message: \"A role with this name already exists.\",\n  },\n\n  // Role not found (404)\n  [ERROR_CODES.ROLE_NOT_FOUND]: {\n    status: HTTP_STATUS.NOT_FOUND,\n    code: ERROR_CODES.ROLE_NOT_FOUND,\n    message:\n      \"Role not found. It may have been deleted or you may not have permission to update it.\",\n  },\n\n  // Role business logic errors (400)\n  [ERROR_CODES.ROLE_CONSTRAINT]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.ROLE_CONSTRAINT,\n    message:\n      \"Cannot delete role. It is currently in use by users. Please reassign users to another role first.\",\n  },\n\n  // Permission validation errors (400)\n  [ERROR_CODES.PERMISSION_NAME_EXISTS]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.PERMISSION_NAME_EXISTS,\n    message: \"A permission with this name already exists.\",\n  },\n\n  // Permission not found (404)\n  [ERROR_CODES.PERMISSION_NOT_FOUND]: {\n    status: HTTP_STATUS.NOT_FOUND,\n    code: ERROR_CODES.PERMISSION_NOT_FOUND,\n    message: \"Permission not found. It may have been deleted.\",\n  },\n\n  // Permission business logic errors (400)\n  [ERROR_CODES.PERMISSION_CONSTRAINT]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.PERMISSION_CONSTRAINT,\n    message:\n      \"Cannot delete permission. It is currently in use by roles. Please remove it from roles first.\",\n  },\n\n  // Subject validation errors (400)\n  [ERROR_CODES.SUBJECT_NAME_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SUBJECT_NAME_REQUIRED,\n    message: \"Subject name is required.\",\n  },\n  [ERROR_CODES.SUBJECT_CODE_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SUBJECT_CODE_REQUIRED,\n    message: \"Subject code is required.\",\n  },\n  [ERROR_CODES.SUBJECT_MAJOR_IDS_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SUBJECT_MAJOR_IDS_REQUIRED,\n    message: \"Major IDs are required.\",\n  },\n  [ERROR_CODES.SUBJECT_MAJOR_IDS_EMPTY]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SUBJECT_MAJOR_IDS_EMPTY,\n    message: \"At least one major must be specified.\",\n  },\n  [ERROR_CODES.SUBJECT_NAME_EXISTS]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SUBJECT_NAME_EXISTS,\n    message: \"A subject with this name already exists.\",\n  },\n  [ERROR_CODES.SUBJECT_CODE_EXISTS]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SUBJECT_CODE_EXISTS,\n    message: \"A subject with this code already exists.\",\n  },\n  [ERROR_CODES.INACTIVE_MAJOR_NOT_ALLOWED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INACTIVE_MAJOR_NOT_ALLOWED,\n    message: \"Cannot assign subject to inactive major.\",\n  },\n\n  // Subject not found (404)\n  [ERROR_CODES.SUBJECT_NOT_FOUND]: {\n    status: HTTP_STATUS.NOT_FOUND,\n    code: ERROR_CODES.SUBJECT_NOT_FOUND,\n    message: \"Subject not found. It may have been deleted.\",\n  },\n\n  // Subject business logic errors (409)\n  [ERROR_CODES.SUBJECT_HAS_ACTIVE_CLASSES]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.SUBJECT_HAS_ACTIVE_CLASSES,\n    message:\n      \"Cannot deactivate subject. Found active classes. Deactivate classes first.\",\n  },\n  [ERROR_CODES.SUBJECT_HAS_DEPENDENCIES]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.SUBJECT_HAS_DEPENDENCIES,\n    message: \"Cannot delete subject. Found classes. Please delete them first.\",\n  },\n\n  // Class validation errors (400)\n  [ERROR_CODES.CLASS_CODE_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.CLASS_CODE_REQUIRED,\n    message: \"Class code is required.\",\n  },\n  [ERROR_CODES.CLASS_SEMESTER_ID_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.CLASS_SEMESTER_ID_REQUIRED,\n    message: \"Semester is required.\",\n  },\n  [ERROR_CODES.CLASS_SUBJECT_ID_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.CLASS_SUBJECT_ID_REQUIRED,\n    message: \"Subject is required.\",\n  },\n  [ERROR_CODES.CLASS_EXISTS]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.CLASS_EXISTS,\n    message: \"Class already exists with subject, semester, and code\",\n  },\n  [ERROR_CODES.INACTIVE_REFERENCE_NOT_ALLOWED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INACTIVE_REFERENCE_NOT_ALLOWED,\n    message: \"Cannot create class with inactive subject or semester\",\n  },\n\n  // Class not found (404)\n  [ERROR_CODES.CLASS_NOT_FOUND]: {\n    status: HTTP_STATUS.NOT_FOUND,\n    code: ERROR_CODES.CLASS_NOT_FOUND,\n    message: \"Class not found. It may have been deleted.\",\n  },\n\n  // Class business logic errors (409)\n  [ERROR_CODES.CLASS_HAS_ACTIVE_DEPENDENCIES]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.CLASS_HAS_ACTIVE_DEPENDENCIES,\n    message:\n      \"Cannot deactivate class. It has active slots or enrolled students\",\n  },\n  [ERROR_CODES.CLASS_HAS_DEPENDENCIES]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.CLASS_HAS_DEPENDENCIES,\n    message:\n      \"Cannot delete class. Found slots and enrollments. Please delete them first\",\n  },\n\n  // Room validation errors (400)\n  [ERROR_CODES.ROOM_NAME_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.ROOM_NAME_REQUIRED,\n    message: \"Room name is required.\",\n  },\n  [ERROR_CODES.ROOM_NAME_EXISTS]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.ROOM_NAME_EXISTS,\n    message: \"A room with this name already exists.\",\n  },\n\n  // Room not found (404)\n  [ERROR_CODES.ROOM_NOT_FOUND]: {\n    status: HTTP_STATUS.NOT_FOUND,\n    code: ERROR_CODES.ROOM_NOT_FOUND,\n    message: \"Room not found. It may have been deleted.\",\n  },\n\n  // Room business logic errors (409)\n  [ERROR_CODES.ROOM_HAS_CAMERAS]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.ROOM_HAS_CAMERAS,\n    message: \"Cannot delete room with cameras. Remove cameras first.\",\n  },\n  [ERROR_CODES.ROOM_HAS_SCHEDULED_SLOTS]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.ROOM_HAS_SCHEDULED_SLOTS,\n    message: \"Cannot delete room with scheduled slots.\",\n  },\n  [ERROR_CODES.ROOM_HAS_ACTIVE_CAMERAS]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.ROOM_HAS_ACTIVE_CAMERAS,\n    message: \"Cannot deactivate room with active cameras.\",\n  },\n  [ERROR_CODES.ROOM_HAS_ACTIVE_SLOTS]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.ROOM_HAS_ACTIVE_SLOTS,\n    message: \"Cannot deactivate room with ongoing or future slots.\",\n  },\n\n  // Camera validation errors (400)\n  [ERROR_CODES.CAMERA_NAME_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.CAMERA_NAME_REQUIRED,\n    message: \"Camera name is required.\",\n  },\n  [ERROR_CODES.CAMERA_RTSP_URL_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.CAMERA_RTSP_URL_REQUIRED,\n    message: \"RTSP URL is required.\",\n  },\n  [ERROR_CODES.CAMERA_ROOM_ID_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.CAMERA_ROOM_ID_REQUIRED,\n    message: \"Room is required.\",\n  },\n  [ERROR_CODES.CAMERA_NAME_EXISTS]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.CAMERA_NAME_EXISTS,\n    message: \"A camera with this name already exists.\",\n  },\n  [ERROR_CODES.RTSP_URL_EXISTS]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.RTSP_URL_EXISTS,\n    message: \"This RTSP URL is already in use.\",\n  },\n\n  // Camera not found (404)\n  [ERROR_CODES.CAMERA_NOT_FOUND]: {\n    status: HTTP_STATUS.NOT_FOUND,\n    code: ERROR_CODES.CAMERA_NOT_FOUND,\n    message: \"Camera not found. It may have been deleted.\",\n  },\n\n  // Slot validation errors (400)\n  [ERROR_CODES.SLOT_START_TIME_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SLOT_START_TIME_REQUIRED,\n    message: \"Start time is required.\",\n  },\n  [ERROR_CODES.SLOT_END_TIME_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SLOT_END_TIME_REQUIRED,\n    message: \"End time is required.\",\n  },\n  [ERROR_CODES.SLOT_CLASS_ID_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SLOT_CLASS_ID_REQUIRED,\n    message: \"Class is required.\",\n  },\n  [ERROR_CODES.SLOT_ROOM_ID_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SLOT_ROOM_ID_REQUIRED,\n    message: \"Room is required.\",\n  },\n  [ERROR_CODES.SLOT_STAFF_USER_ID_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SLOT_STAFF_USER_ID_REQUIRED,\n    message: \"Staff user is required.\",\n  },\n  [ERROR_CODES.SLOT_CATEGORY_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SLOT_CATEGORY_REQUIRED,\n    message: \"Slot category is required.\",\n  },\n  [ERROR_CODES.SLOT_IS_ACTIVE_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SLOT_IS_ACTIVE_REQUIRED,\n    message: \"Active status is required.\",\n  },\n  [ERROR_CODES.INVALID_SLOT_CATEGORY]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_SLOT_CATEGORY,\n    message:\n      \"Invalid slot category. Must be LECTURE, LECTURE_WITH_PT, or FINAL_EXAM.\",\n  },\n  [ERROR_CODES.INVALID_SLOT_CATEGORY_TRANSITION]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_SLOT_CATEGORY_TRANSITION,\n    message:\n      \"Cannot change slot category. Only LECTURE â†” LECTURE_WITH_PT transitions are allowed for lecturers.\",\n  },\n  [ERROR_CODES.INVALID_TIME_RANGE]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_TIME_RANGE,\n    message: \"End time must be after start time.\",\n  },\n  [ERROR_CODES.INVALID_SLOT_DURATION]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_SLOT_DURATION,\n    message: \"Slot duration must be between 30 minutes and 4 hours.\",\n  },\n  [ERROR_CODES.ROOM_TIME_CONFLICT]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.ROOM_TIME_CONFLICT,\n    message: \"Room is already booked for this time period.\",\n  },\n  [ERROR_CODES.STAFF_TIME_CONFLICT]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.STAFF_TIME_CONFLICT,\n    message: \"Staff is already assigned to another slot at this time.\",\n  },\n  [ERROR_CODES.EXAM_ATTENDANCE_EXISTS]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.EXAM_ATTENDANCE_EXISTS,\n    message:\n      \"Cannot change from LECTURE_WITH_PT to LECTURE. Exam attendance records exist.\",\n  },\n  [ERROR_CODES.INVALID_STAFF_ROLE_FOR_SLOT]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_STAFF_ROLE_FOR_SLOT,\n    message:\n      \"Staff must have LECTURER or SUPERVISOR role to be assigned to a slot.\",\n  },\n  [ERROR_CODES.INVALID_STAFF_ROLE]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_STAFF_ROLE,\n    message: \"Staff must have LECTURER or SUPERVISOR role.\",\n  },\n  [ERROR_CODES.DELETE_TIME_RESTRICTION]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.DELETE_TIME_RESTRICTION,\n    message: \"Cannot delete slot within 30 minutes of start time.\",\n  },\n  [ERROR_CODES.INVALID_FINALIZATION_RULE]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_FINALIZATION_RULE,\n    message:\n      \"Invalid value for notYetStatusResolution. Must be MARK_AS_ABSENT or MARK_AS_PRESENT.\",\n  },\n\n  // Slot not found (404)\n  [ERROR_CODES.SLOT_NOT_FOUND]: {\n    status: HTTP_STATUS.NOT_FOUND,\n    code: ERROR_CODES.SLOT_NOT_FOUND,\n    message: \"Slot not found. It may have been deleted.\",\n  },\n\n  // Slot business logic errors (403/409)\n  [ERROR_CODES.NOT_ASSIGNED_TO_SLOT]: {\n    status: HTTP_STATUS.FORBIDDEN,\n    code: ERROR_CODES.NOT_ASSIGNED_TO_SLOT,\n    message: \"You are not assigned to this slot.\",\n  },\n  [ERROR_CODES.NOT_ASSIGNED_TO_CLASS]: {\n    status: HTTP_STATUS.FORBIDDEN,\n    code: ERROR_CODES.NOT_ASSIGNED_TO_CLASS,\n    message: \"You can only update slots for classes you are assigned to.\",\n  },\n  [ERROR_CODES.INSUFFICIENT_PERMISSIONS_FOR_FULL_UPDATE]: {\n    status: HTTP_STATUS.FORBIDDEN,\n    code: ERROR_CODES.INSUFFICIENT_PERMISSIONS_FOR_FULL_UPDATE,\n    message:\n      \"Lecturers can only update slotCategory field. Other fields require SLOT_UPDATE permission.\",\n  },\n  [ERROR_CODES.SLOT_HAS_DEPENDENCIES]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.SLOT_HAS_DEPENDENCIES,\n    message:\n      \"Cannot delete slot. Found attendance records. Please delete them first or contact administrator.\",\n  },\n  [ERROR_CODES.SESSION_NOT_STARTED]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.SESSION_NOT_STARTED,\n    message:\n      \"Cannot trigger re-scan because the attendance session has not been started.\",\n  },\n\n  // Exam session errors\n  [ERROR_CODES.EXAM_SESSION_RUNNING]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.EXAM_SESSION_RUNNING,\n    message:\n      \"Exam session is currently running. Stop it before starting regular session.\",\n  },\n  [ERROR_CODES.EXAM_SESSION_ALREADY_RUNNING]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.EXAM_SESSION_ALREADY_RUNNING,\n    message: \"Exam session is already running.\",\n  },\n  [ERROR_CODES.REGULAR_SESSION_RUNNING]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.REGULAR_SESSION_RUNNING,\n    message:\n      \"Regular session is currently running. Stop it before starting exam session.\",\n  },\n  [ERROR_CODES.EXAM_SESSION_NOT_STARTED]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.EXAM_SESSION_NOT_STARTED,\n    message: \"Exam session has not been started yet.\",\n  },\n  [ERROR_CODES.USE_EXAM_RESCAN_INSTEAD]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.USE_EXAM_RESCAN_INSTEAD,\n    message: \"This is a FINAL_EXAM slot. Use rescan-exam endpoint instead.\",\n  },\n  [ERROR_CODES.NO_INITIAL_EXAM_SCAN]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.NO_INITIAL_EXAM_SCAN,\n    message:\n      \"Cannot rescan exam. Initial exam session has not been started yet.\",\n  },\n  [ERROR_CODES.NO_STUDENTS_FOR_EXAM_SESSION]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.NO_STUDENTS_FOR_EXAM_SESSION,\n    message: \"Cannot start exam session: No enrolled students found for this slot.\",\n  },\n\n  // Attendance Record errors\n  [ERROR_CODES.ATTENDANCE_RECORD_NOT_FOUND]: {\n    status: HTTP_STATUS.NOT_FOUND,\n    code: ERROR_CODES.ATTENDANCE_RECORD_NOT_FOUND,\n    message: \"Attendance record not found.\",\n  },\n  [ERROR_CODES.STATUS_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.STATUS_REQUIRED,\n    message: \"Status is required.\",\n  },\n  [ERROR_CODES.REMARK_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.REMARK_REQUIRED,\n    message: \"Remark is required for manual status changes.\",\n  },\n  [ERROR_CODES.REMARK_CANNOT_BE_EMPTY]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.REMARK_CANNOT_BE_EMPTY,\n    message:\n      \"Remark must not be blank when manually changing attendance status.\",\n  },\n  [ERROR_CODES.INVALID_STATUS_VALUE]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_STATUS_VALUE,\n    message: \"Invalid status value. Must be: not_yet, present, absent.\",\n  },\n  [ERROR_CODES.EDIT_WINDOW_EXPIRED]: {\n    status: HTTP_STATUS.FORBIDDEN,\n    code: ERROR_CODES.EDIT_WINDOW_EXPIRED,\n    message:\n      \"Edit window has expired. Only Data Operator can edit attendance after slot date.\",\n  },\n\n  // Exam Attendance errors\n  [ERROR_CODES.EXAM_ATTENDANCE_NOT_FOUND]: {\n    status: HTTP_STATUS.NOT_FOUND,\n    code: ERROR_CODES.EXAM_ATTENDANCE_NOT_FOUND,\n    message: \"Exam attendance record not found.\",\n  },\n\n  // Exam slot subject errors\n  [ERROR_CODES.SUBJECT_ID_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SUBJECT_ID_REQUIRED,\n    message: \"Subject is required.\",\n  },\n  [ERROR_CODES.DUPLICATE_SUBJECTS_NOT_ALLOWED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.DUPLICATE_SUBJECTS_NOT_ALLOWED,\n    message: \"This subject is already assigned to this exam slot.\",\n  },\n  [ERROR_CODES.INVALID_EXAM_SLOT_TYPE]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_EXAM_SLOT_TYPE,\n    message: \"Only FINAL_EXAM slots can have subjects assigned.\",\n  },\n  [ERROR_CODES.EXAM_SLOT_SUBJECT_NOT_FOUND]: {\n    status: HTTP_STATUS.NOT_FOUND,\n    code: ERROR_CODES.EXAM_SLOT_SUBJECT_NOT_FOUND,\n    message: \"Subject assignment not found for this exam slot.\",\n  },\n  [ERROR_CODES.EXAM_SLOT_SUBJECT_HAS_PARTICIPANTS]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.EXAM_SLOT_SUBJECT_HAS_PARTICIPANTS,\n    message:\n      \"Cannot remove subject. There are participants assigned to this subject.\",\n  },\n\n  // Enrollment errors\n  [ERROR_CODES.CLASS_ID_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.CLASS_ID_REQUIRED,\n    message: \"Class ID is required.\",\n  },\n  [ERROR_CODES.ENROLLMENT_NOT_FOUND]: {\n    status: HTTP_STATUS.NOT_FOUND,\n    code: ERROR_CODES.ENROLLMENT_NOT_FOUND,\n    message: \"Enrollment not found.\",\n  },\n  [ERROR_CODES.ALREADY_ENROLLED]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.ALREADY_ENROLLED,\n    message: \"Student is already enrolled in this class.\",\n  },\n\n  // Time-based validation errors\n  [ERROR_CODES.CLASS_ALREADY_STARTED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.CLASS_ALREADY_STARTED,\n    message: \"Cannot delete enrollment after class has started.\",\n  },\n  [ERROR_CODES.SLOT_ALREADY_STARTED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.SLOT_ALREADY_STARTED,\n    message: \"Cannot modify participants after exam has started.\",\n  },\n\n  // Student Profile errors\n  [ERROR_CODES.STUDENT_PROFILE_NOT_FOUND]: {\n    status: HTTP_STATUS.NOT_FOUND,\n    code: ERROR_CODES.STUDENT_PROFILE_NOT_FOUND,\n    message: \"Student profile not found.\",\n  },\n  [ERROR_CODES.FULL_NAME_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.FULL_NAME_REQUIRED,\n    message: \"Full name is required.\",\n  },\n  [ERROR_CODES.EMAIL_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.EMAIL_REQUIRED,\n    message: \"Email is required.\",\n  },\n  [ERROR_CODES.USERNAME_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.USERNAME_REQUIRED,\n    message: \"Username is required.\",\n  },\n  [ERROR_CODES.ROLL_NUMBER_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.ROLL_NUMBER_REQUIRED,\n    message: \"Roll number is required.\",\n  },\n  [ERROR_CODES.MAJOR_ID_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.MAJOR_ID_REQUIRED,\n    message: \"Major is required.\",\n  },\n  [ERROR_CODES.INVALID_EMAIL_FORMAT]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_EMAIL_FORMAT,\n    message: \"Invalid email format.\",\n  },\n  [ERROR_CODES.INVALID_USERNAME_FORMAT]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_USERNAME_FORMAT,\n    message:\n      \"Invalid username format. Use only letters, numbers, and underscores.\",\n  },\n  [ERROR_CODES.INVALID_ROLL_NUMBER_FORMAT]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_ROLL_NUMBER_FORMAT,\n    message:\n      \"Invalid roll number format. Expected format: HE followed by 6 digits (e.g., HE180314).\",\n  },\n  [ERROR_CODES.EMAIL_EXISTS]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.EMAIL_EXISTS,\n    message: \"An account with this email already exists.\",\n  },\n  [ERROR_CODES.USERNAME_EXISTS]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.USERNAME_EXISTS,\n    message: \"An account with this username already exists.\",\n  },\n  [ERROR_CODES.ROLL_NUMBER_EXISTS]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.ROLL_NUMBER_EXISTS,\n    message: \"An account with this roll number already exists.\",\n  },\n\n  // Staff Profile errors\n  [ERROR_CODES.STAFF_PROFILE_NOT_FOUND]: {\n    status: HTTP_STATUS.NOT_FOUND,\n    code: ERROR_CODES.STAFF_PROFILE_NOT_FOUND,\n    message: \"Staff profile not found.\",\n  },\n  [ERROR_CODES.STAFF_CODE_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.STAFF_CODE_REQUIRED,\n    message: \"Staff code is required.\",\n  },\n  [ERROR_CODES.ROLES_REQUIRED]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.ROLES_REQUIRED,\n    message: \"At least one role is required.\",\n  },\n  [ERROR_CODES.INVALID_ROLE]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_ROLE,\n    message: \"Invalid role specified.\",\n  },\n  [ERROR_CODES.STAFF_CODE_EXISTS]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.STAFF_CODE_EXISTS,\n    message: \"An account with this staff code already exists.\",\n  },\n  [ERROR_CODES.ROLE_ASSIGNMENT_CONFLICT]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.ROLE_ASSIGNMENT_CONFLICT,\n    message:\n      \"Cannot assign SUPERVISOR/LECTURER roles to users with STUDENT role.\",\n  },\n\n  // Common errors\n  [ERROR_CODES.USER_NOT_FOUND]: {\n    status: HTTP_STATUS.NOT_FOUND,\n    code: ERROR_CODES.USER_NOT_FOUND,\n    message: \"User not found.\",\n  },\n  [ERROR_CODES.FORBIDDEN]: {\n    status: HTTP_STATUS.FORBIDDEN,\n    code: ERROR_CODES.FORBIDDEN,\n    message: \"You are not authorized to perform this action.\",\n  },\n  [ERROR_CODES.INVALID_PAGE]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_PAGE,\n    message: \"Page must be >= 1.\",\n  },\n  [ERROR_CODES.INVALID_PAGE_SIZE]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_PAGE_SIZE,\n    message: \"Page size must be between 1 and 50.\",\n  },\n  [ERROR_CODES.INVALID_SORT]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_SORT,\n    message: \"Invalid sort parameter. Must be 'asc' or 'desc'.\",\n  },\n  [ERROR_CODES.INVALID_SORT_BY]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_SORT_BY,\n    message: \"Invalid sortBy parameter.\",\n  },\n  [ERROR_CODES.INVALID_STATUS]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_STATUS,\n    message: \"Invalid status value.\",\n  },\n  [ERROR_CODES.INVALID_ATTENDANCE_STATUS]: {\n    status: HTTP_STATUS.BAD_REQUEST,\n    code: ERROR_CODES.INVALID_ATTENDANCE_STATUS,\n    message:\n      \"Invalid attendance status. Must be 'present', 'absent', or 'not_yet'.\",\n  },\n\n  [ERROR_CODES.FOREIGN_KEY_CONSTRAINT_VIOLATION]: {\n    status: HTTP_STATUS.CONFLICT,\n    code: ERROR_CODES.FOREIGN_KEY_CONSTRAINT_VIOLATION,\n    message:\n      \"Cannot delete this item because it has associated data. Please remove dependencies first.\",\n  },\n} as const;\n\n// Helper function to get error message by code (used internally by formatApiError)\nconst getErrorMessage = (errorCode: string): string => {\n  return (\n    API_ERRORS[errorCode as keyof typeof API_ERRORS]?.message ||\n    \"An unexpected error occurred.\"\n  );\n};\n\n/**\n * Format API error for user-friendly display\n * Handles both backend errors and Zod validation errors\n */\nexport const formatApiError = (error: any): string => {\n  // 1. Check for backend error structure (attached by interceptor)\n  const backendError = error.backendError || error.response?.data;\n\n  if (backendError) {\n    // If backend provides a message, use it\n    if (backendError.message) {\n      return backendError.message;\n    }\n\n    // If backend provides an error code, look up the message\n    if (backendError.code) {\n      return getErrorMessage(backendError.code);\n    }\n  }\n\n  // 2. Handle Zod validation errors (array of errors)\n  if (error.message && typeof error.message === \"string\") {\n    try {\n      const parsed = JSON.parse(error.message);\n      if (Array.isArray(parsed) && parsed.length > 0) {\n        // Format Zod errors into readable message\n        const firstError = parsed[0];\n        const field = firstError.path?.join(\".\") || \"field\";\n        return `Invalid ${field}: ${firstError.message}`;\n      }\n    } catch {\n      // Not a JSON string, continue\n    }\n  }\n\n  // 3. Fallback to original error message\n  return error.message || \"An unexpected error occurred\";\n};\n"
    },
    {
      "path": "D:\\Work\\do_an_fall25\\fuacs\\frontend-web\\lib\\excel-utils.ts",
      "relative_path": "lib/excel-utils.ts",
      "filename": "excel-utils.ts",
      "size_bytes": 12411,
      "lines": 365,
      "last_modified": "2025-11-20T14:00:32.288223",
      "encoding": "utf-8",
      "language": "typescript",
      "content": "import * as XLSX from 'xlsx';\nimport { format, parseISO } from 'date-fns';\n\ninterface ExamSlotExcelData {\n  slotId: number;\n  title: string;\n  description: string;\n  startTime: string;\n  endTime: string;\n  room: {\n    id: number;\n    name: string;\n    location: string;\n  };\n  staff: {\n    id: number;\n    username: string;\n    email: string;\n    fullName: string;\n  };\n  sessionStatus: string;\n  subjects: Array<{\n    id: number;\n    name: string;\n    code: string;\n  }>;\n  students: Array<{\n    studentId: number;\n    rollNumber: string;\n    fullName: string;\n    subjectCode: string;\n    subjectName: string;\n    attendanceId: number;\n    status: \"present\" | \"absent\" | \"late\";\n    method: string;\n    recordedAt: string;\n    checkInTime?: string;\n    remark?: string;\n  }>;\n  statistics: {\n    totalStudents: number;\n    presentCount: number;\n    absentCount: number;\n    lateCount: number;\n  };\n}\n\nexport function exportExamSlotToExcel(examData: ExamSlotExcelData) {\n  // Recalculate statistics based on actual students data (in case of filtered data)\n  const actualStats = {\n    totalStudents: examData.students.length,\n    presentCount: examData.students.filter(s => s.status === 'present').length,\n    absentCount: examData.students.filter(s => s.status === 'absent').length,\n    lateCount: examData.students.filter(s => s.status === 'late').length\n  };\n\n  // Use recalculated stats for accurate reporting\n  const statsToUse = actualStats.totalStudents > 0 ? actualStats : examData.statistics;\n\n  // Create a new workbook\n  const workbook = XLSX.utils.book_new();\n\n  // Sheet 1: Exam Information\n  const isFiltered = actualStats.totalStudents !== examData.statistics.totalStudents;\n  const examInfoData = [\n    ['EXAM SLOT INFORMATION', ''],\n    ['', ''],\n    ['Slot ID', examData.slotId],\n    ['Title', examData.title],\n    ['Description', examData.description],\n    ['Date', format(parseISO(examData.startTime), 'yyyy-MM-dd')],\n    ['Start Time', format(parseISO(examData.startTime), 'HH:mm')],\n    ['End Time', format(parseISO(examData.endTime), 'HH:mm')],\n    ['Duration', `${Math.round((new Date(examData.endTime).getTime() - new Date(examData.startTime).getTime()) / (1000 * 60))} minutes`],\n    ['Room', examData.room.name],\n    ['Room Location', examData.room.location],\n    ['Supervisor', examData.staff.fullName],\n    ['Supervisor Email', examData.staff.email],\n    ['Session Status', examData.sessionStatus],\n    ['', ''],\n    ['STATISTICS', ''],\n    ['', ''],\n    ['Total Students', statsToUse.totalStudents],\n    ['Present', statsToUse.presentCount],\n    ['Absent', statsToUse.absentCount],\n    ['Late', statsToUse.lateCount],\n    ['Attendance Rate', `${statsToUse.totalStudents > 0 ? ((statsToUse.presentCount / statsToUse.totalStudents) * 100).toFixed(1) : '0.0'}%`],\n    ['', ''],\n    ...(isFiltered ? [\n      ['DATA FILTER APPLIED', ''],\n      ['', ''],\n      ['Original Total Students', examData.statistics.totalStudents],\n      ['Filtered Students Shown', actualStats.totalStudents],\n      ['Filter Note', 'Statistics reflect filtered data only'],\n      ['', '']\n    ] : []),\n    ['SUBJECTS', ''],\n    ['', ''],\n    ...examData.subjects.map(subject => [subject.code, subject.name])\n  ];\n\n  const examInfoSheet = XLSX.utils.aoa_to_sheet(examInfoData);\n  \n  // Set column widths for exam info sheet\n  examInfoSheet['!cols'] = [\n    { width: 20 },\n    { width: 40 }\n  ];\n\n  // Add styling to headers\n  const examInfoRange = XLSX.utils.decode_range(examInfoSheet['!ref'] || 'A1');\n  for (let row = examInfoRange.s.r; row <= examInfoRange.e.r; row++) {\n    const cellA = XLSX.utils.encode_cell({ r: row, c: 0 });\n    if (examInfoSheet[cellA] && \n        (examInfoSheet[cellA].v === 'EXAM SLOT INFORMATION' || \n         examInfoSheet[cellA].v === 'STATISTICS' || \n         examInfoSheet[cellA].v === 'SUBJECTS')) {\n      examInfoSheet[cellA].s = {\n        font: { bold: true, sz: 14 },\n        fill: { fgColor: { rgb: \"E3F2FD\" } }\n      };\n    }\n  }\n\n  XLSX.utils.book_append_sheet(workbook, examInfoSheet, 'Exam Information');\n\n  // Sheet 2: Student Attendance\n  const studentHeaders = [\n    'Roll Number',\n    'Full Name',\n    'Subject Code',\n    'Subject Name',\n    'Attendance Status',\n    'Method',\n    'Recorded At',\n    'Check In Time',\n    'Remarks Count',\n    'Remarks'\n  ];\n\n  const studentData = examData.students.map(student => [\n    student.rollNumber,\n    student.fullName,\n    student.subjectCode,\n    student.subjectName,\n    student.status.charAt(0).toUpperCase() + student.status.slice(1),\n    student.method.charAt(0).toUpperCase() + student.method.slice(1),\n    format(parseISO(student.recordedAt), 'yyyy-MM-dd HH:mm:ss'),\n    student.checkInTime ? format(parseISO(student.checkInTime), 'yyyy-MM-dd HH:mm:ss') : 'Not recorded',\n    student.remark ? 1 : 0,\n    student.remark || ''\n  ]);\n\n  const studentSheet = XLSX.utils.aoa_to_sheet([studentHeaders, ...studentData]);\n  \n  // Set column widths for student sheet\n  studentSheet['!cols'] = [\n    { width: 12 }, // Roll Number\n    { width: 25 }, // Full Name\n    { width: 12 }, // Subject Code\n    { width: 30 }, // Subject Name\n    { width: 15 }, // Status\n    { width: 10 }, // Method\n    { width: 20 }, // Recorded At\n    { width: 20 }, // Check In Time\n    { width: 12 }, // Remarks Count\n    { width: 40 }  // Remarks\n  ];\n\n  // Style the header row\n  const studentRange = XLSX.utils.decode_range(studentSheet['!ref'] || 'A1');\n  for (let col = studentRange.s.c; col <= studentRange.e.c; col++) {\n    const headerCell = XLSX.utils.encode_cell({ r: 0, c: col });\n    if (studentSheet[headerCell]) {\n      studentSheet[headerCell].s = {\n        font: { bold: true },\n        fill: { fgColor: { rgb: \"E8F5E8\" } },\n        alignment: { horizontal: \"center\" }\n      };\n    }\n  }\n\n  // Color code attendance status\n  for (let row = 1; row <= studentData.length; row++) {\n    const statusCell = XLSX.utils.encode_cell({ r: row, c: 4 }); // Status column\n    if (studentSheet[statusCell]) {\n      const status = studentSheet[statusCell].v?.toString().toLowerCase();\n      if (status === 'present') {\n        studentSheet[statusCell].s = {\n          fill: { fgColor: { rgb: \"C8E6C9\" } }\n        };\n      } else if (status === 'absent') {\n        studentSheet[statusCell].s = {\n          fill: { fgColor: { rgb: \"FFCDD2\" } }\n        };\n      } else if (status === 'late') {\n        studentSheet[statusCell].s = {\n          fill: { fgColor: { rgb: \"FFE0B2\" } }\n        };\n      }\n    }\n  }\n\n  XLSX.utils.book_append_sheet(workbook, studentSheet, 'Student Attendance');\n\n  // Sheet 3: Statistics by Subject\n  const subjectStatsHeaders = [\n    'Subject Code',\n    'Subject Name',\n    'Total Students',\n    'Present',\n    'Absent',\n    'Late',\n    'Attendance Rate (%)'\n  ];\n\n  const subjectStatsData = examData.subjects.map(subject => {\n    const subjectStudents = examData.students.filter(s => s.subjectCode === subject.code);\n    const total = subjectStudents.length;\n    const present = subjectStudents.filter(s => s.status === 'present').length;\n    const absent = subjectStudents.filter(s => s.status === 'absent').length;\n    const late = subjectStudents.filter(s => s.status === 'late').length;\n    const attendanceRate = total > 0 ? ((present / total) * 100).toFixed(1) : '0.0';\n\n    return [\n      subject.code,\n      subject.name,\n      total,\n      present,\n      absent,\n      late,\n      attendanceRate\n    ];\n  });\n\n  const subjectStatsSheet = XLSX.utils.aoa_to_sheet([subjectStatsHeaders, ...subjectStatsData]);\n  \n  // Set column widths for subject stats sheet\n  subjectStatsSheet['!cols'] = [\n    { width: 12 }, // Subject Code\n    { width: 30 }, // Subject Name\n    { width: 15 }, // Total Students\n    { width: 10 }, // Present\n    { width: 10 }, // Absent\n    { width: 10 }, // Late\n    { width: 18 }  // Attendance Rate\n  ];\n\n  // Style the header row\n  const subjectStatsRange = XLSX.utils.decode_range(subjectStatsSheet['!ref'] || 'A1');\n  for (let col = subjectStatsRange.s.c; col <= subjectStatsRange.e.c; col++) {\n    const headerCell = XLSX.utils.encode_cell({ r: 0, c: col });\n    if (subjectStatsSheet[headerCell]) {\n      subjectStatsSheet[headerCell].s = {\n        font: { bold: true },\n        fill: { fgColor: { rgb: \"E1F5FE\" } },\n        alignment: { horizontal: \"center\" }\n      };\n    }\n  }\n\n  XLSX.utils.book_append_sheet(workbook, subjectStatsSheet, 'Subject Statistics');\n\n  // Sheet 4: Summary Report\n  const summaryData = [\n    ['EXAM ATTENDANCE SUMMARY REPORT', ''],\n    ['', ''],\n    ['Generated On', format(new Date(), 'yyyy-MM-dd HH:mm:ss')],\n    ['Exam Slot', `${examData.title} (ID: ${examData.slotId})`],\n    ['Date & Time', `${format(parseISO(examData.startTime), 'yyyy-MM-dd HH:mm')} - ${format(parseISO(examData.endTime), 'HH:mm')}`],\n    ['Supervisor', examData.staff.fullName],\n    ['', ''],\n    ['OVERALL STATISTICS', ''],\n    ['', ''],\n    ['Total Students', statsToUse.totalStudents],\n    ['Students Present', `${statsToUse.presentCount} (${statsToUse.totalStudents > 0 ? ((statsToUse.presentCount / statsToUse.totalStudents) * 100).toFixed(1) : '0.0'}%)`],\n    ['Students Absent', `${statsToUse.absentCount} (${statsToUse.totalStudents > 0 ? ((statsToUse.absentCount / statsToUse.totalStudents) * 100).toFixed(1) : '0.0'}%)`],\n    ['Students Late', `${statsToUse.lateCount} (${statsToUse.totalStudents > 0 ? ((statsToUse.lateCount / statsToUse.totalStudents) * 100).toFixed(1) : '0.0'}%)`],\n    ['', ''],\n    ['ATTENDANCE BY SUBJECT', ''],\n    ['', ''],\n    ['Subject', 'Total', 'Present', 'Absent', 'Late', 'Rate (%)'],\n    ...examData.subjects.map(subject => {\n      const subjectStudents = examData.students.filter(s => s.subjectCode === subject.code);\n      const total = subjectStudents.length;\n      const present = subjectStudents.filter(s => s.status === 'present').length;\n      const absent = subjectStudents.filter(s => s.status === 'absent').length;\n      const late = subjectStudents.filter(s => s.status === 'late').length;\n      const rate = total > 0 ? ((present / total) * 100).toFixed(1) : '0.0';\n      \n      return [`${subject.code} - ${subject.name}`, total, present, absent, late, rate];\n    })\n  ];\n\n  const summarySheet = XLSX.utils.aoa_to_sheet(summaryData);\n  \n  // Set column widths for summary sheet\n  summarySheet['!cols'] = [\n    { width: 35 },\n    { width: 15 },\n    { width: 15 },\n    { width: 15 },\n    { width: 15 },\n    { width: 15 }\n  ];\n\n  XLSX.utils.book_append_sheet(workbook, summarySheet, 'Summary Report');\n\n  // Generate filename\n  const filename = `ExamSlot_${examData.slotId}_${format(parseISO(examData.startTime), 'yyyy-MM-dd')}_AttendanceReport.xlsx`;\n\n  // Write and download the file\n  XLSX.writeFile(workbook, filename);\n}\n\nexport function exportStudentListToExcel(\n  students: ExamSlotExcelData['students'], \n  examInfo: { slotId: number; title: string; date: string }\n) {\n  const workbook = XLSX.utils.book_new();\n\n  const headers = [\n    'Roll Number',\n    'Full Name',\n    'Subject Code',\n    'Subject Name',\n    'Status',\n    'Method',\n    'Recorded At',\n    'Check In Time',\n    'Remarks'\n  ];\n\n  const data = students.map(student => [\n    student.rollNumber,\n    student.fullName,\n    student.subjectCode,\n    student.subjectName,\n    student.status.charAt(0).toUpperCase() + student.status.slice(1),\n    student.method.charAt(0).toUpperCase() + student.method.slice(1),\n    format(parseISO(student.recordedAt), 'yyyy-MM-dd HH:mm:ss'),\n    student.checkInTime ? format(parseISO(student.checkInTime), 'yyyy-MM-dd HH:mm:ss') : 'Not recorded',\n    student.remark || ''\n  ]);\n\n  const worksheet = XLSX.utils.aoa_to_sheet([headers, ...data]);\n  \n  // Set column widths\n  worksheet['!cols'] = [\n    { width: 12 },\n    { width: 25 },\n    { width: 12 },\n    { width: 30 },\n    { width: 12 },\n    { width: 10 },\n    { width: 20 },\n    { width: 20 },\n    { width: 40 }\n  ];\n\n  XLSX.utils.book_append_sheet(workbook, worksheet, 'Students');\n\n  const filename = `ExamSlot_${examInfo.slotId}_Students_${examInfo.date}.xlsx`;\n  XLSX.writeFile(workbook, filename);\n}"
    },
    {
      "path": "D:\\Work\\do_an_fall25\\fuacs\\frontend-web\\lib\\export-utils\\admin-export.ts",
      "relative_path": "lib/export-utils/admin-export.ts",
      "filename": "admin-export.ts",
      "size_bytes": 6783,
      "lines": 250,
      "last_modified": "2025-11-24T10:38:09.526187",
      "encoding": "utf-8",
      "language": "typescript",
      "content": "import * as XLSX from \"xlsx\";\nimport { format } from \"date-fns\";\nimport { parseVietnamTime } from \"@/lib/timezone-utils\";\n\ninterface SlotExportData {\n  slotId?: number;\n  id?: number;\n  title?: string;\n  description?: string;\n  startTime: string;\n  endTime: string;\n  room?: {\n    id?: number;\n    name?: string;\n    location?: string;\n  };\n  staff?: {\n    id?: number;\n    username?: string;\n    email?: string;\n    fullName?: string;\n  };\n  supervisor?: {\n    id?: number;\n    username?: string;\n    email?: string;\n    fullName?: string;\n  };\n  sessionStatus?: string;\n  subjects?: Array<{\n    id?: number;\n    name?: string;\n    code?: string;\n  }>;\n  students?: Array<{\n    studentId?: number;\n    rollNumber?: string;\n    fullName?: string;\n    subjectCode?: string;\n    subjectName?: string;\n    attendanceId?: number;\n    status?: string;\n    method?: string;\n    recordedAt?: string;\n    checkInTime?: string;\n    remark?: string;\n  }>;\n  statistics?: {\n    totalStudents?: number;\n    presentCount?: number;\n    absentCount?: number;\n    lateCount?: number;\n  };\n}\n\nexport function exportAdminSlotsToExcel(\n  slotsData: SlotExportData[],\n  type: \"exam-slots\" | \"class-slots\"\n) {\n  const workbook = XLSX.utils.book_new();\n  const reportTitle =\n    type === \"exam-slots\" ? \"EXAM SLOTS EXPORT REPORT\" : \"CLASS SLOTS EXPORT REPORT\";\n\n  // Sheet 1: Overview\n  const overviewData = [\n    [reportTitle, \"\"],\n    [\"Export Date\", format(new Date(), \"dd/MM/yyyy HH:mm\")],\n    [\"Exported By\", \"Data Operator\"],\n    [\"Total Slots\", slotsData.length.toString()],\n    [\"\", \"\"],\n    [\"SLOTS SUMMARY\", \"\"],\n    [\n      \"No.\",\n      \"Slot ID\",\n      \"Title\",\n      \"Date\",\n      \"Time\",\n      \"Room\",\n      \"Staff/Supervisor\",\n      \"Total\",\n      \"Present\",\n      \"Absent\",\n    ],\n    ...slotsData.map((slot, idx) => {\n      const stats = slot.statistics || {\n        totalStudents: 0,\n        presentCount: 0,\n        absentCount: 0,\n      };\n      const slotId = slot.slotId || slot.id || 0;\n      const staffName =\n        slot.supervisor?.fullName || slot.staff?.fullName || \"N/A\";\n\n      return [\n        (idx + 1).toString(),\n        slotId.toString(),\n        slot.title || \"N/A\",\n        format(parseVietnamTime(slot.startTime), \"dd/MM/yyyy\"),\n        `${format(parseVietnamTime(slot.startTime), \"HH:mm\")}-${format(\n          parseVietnamTime(slot.endTime),\n          \"HH:mm\"\n        )}`,\n        slot.room?.name || \"N/A\",\n        staffName,\n        (stats.totalStudents ?? 0).toString(),\n        (stats.presentCount ?? 0).toString(),\n        (stats.absentCount ?? 0).toString(),\n      ];\n    }),\n  ];\n\n  const overviewSheet = XLSX.utils.aoa_to_sheet(overviewData);\n  overviewSheet[\"!cols\"] = [\n    { width: 8 }, // No.\n    { width: 10 }, // Slot ID\n    { width: 30 }, // Title\n    { width: 12 }, // Date\n    { width: 15 }, // Time\n    { width: 15 }, // Room\n    { width: 20 }, // Staff\n    { width: 8 }, // Total\n    { width: 10 }, // Present\n    { width: 10 }, // Absent\n  ];\n  XLSX.utils.book_append_sheet(workbook, overviewSheet, \"Overview\");\n\n  // Detail sheets for each slot\n  slotsData.forEach((slot, idx) => {\n    const sheetData = createSlotDetailSheet(slot, type);\n    const slotNumber = (idx + 1).toString().padStart(2, \"0\");\n    const sheetName = `SLOT_${slotNumber}`;\n    XLSX.utils.book_append_sheet(workbook, sheetData, sheetName);\n  });\n\n  // Download\n  const prefix = type === \"exam-slots\" ? \"ExamSlots\" : \"ClassSlots\";\n  const filename = `Admin_${prefix}_Export_${format(\n    new Date(),\n    \"yyyy-MM-dd_HHmm\"\n  )}.xlsx`;\n  XLSX.writeFile(workbook, filename);\n}\n\nfunction createSlotDetailSheet(slot: SlotExportData, type: string) {\n  const stats = slot.statistics || {\n    totalStudents: 0,\n    presentCount: 0,\n    absentCount: 0,\n    lateCount: 0,\n  };\n  const students = slot.students || [];\n  const slotId = slot.slotId || slot.id || 0;\n  const staffName =\n    slot.supervisor?.fullName || slot.staff?.fullName || \"N/A\";\n  const staffEmail =\n    slot.supervisor?.email || slot.staff?.email || \"N/A\";\n\n  // Header section\n  const headerSection = [\n    [\"SLOT DETAILS\", \"\"],\n    [\"Slot ID\", slotId.toString()],\n    [\"Title\", slot.title || \"N/A\"],\n    [\"Date\", format(parseVietnamTime(slot.startTime), \"EEEE, dd/MM/yyyy\")],\n    [\n      \"Time\",\n      `${format(parseVietnamTime(slot.startTime), \"HH:mm\")} - ${format(\n        parseVietnamTime(slot.endTime),\n        \"HH:mm\"\n      )}`,\n    ],\n    [\"Room\", slot.room?.name || \"N/A\"],\n    [\"Location\", slot.room?.location || \"N/A\"],\n    [\"Staff/Supervisor\", staffName],\n    [\"Email\", staffEmail],\n    [\"\", \"\"],\n    [\"STATISTICS\", \"\"],\n    [\"Total Students\", stats.totalStudents?.toString() || \"0\"],\n    [\"Present\", stats.presentCount?.toString() || \"0\"],\n    [\"Absent\", stats.absentCount?.toString() || \"0\"],\n    [\"Late\", stats.lateCount?.toString() || \"0\"],\n    [\"\", \"\"],\n    [\"STUDENT ATTENDANCE DETAILS\", \"\"],\n  ];\n\n  // Student table\n  const studentHeaders =\n    type === \"exam-slots\"\n      ? [\n          \"No.\",\n          \"Roll Number\",\n          \"Full Name\",\n          \"Subject\",\n          \"Status\",\n          \"Check-in Time\",\n          \"Remark\",\n        ]\n      : [\"No.\", \"Roll Number\", \"Full Name\", \"Status\", \"Check-in Time\", \"Remark\"];\n\n  const studentRows = students.map((s, idx) => {\n    const baseRow: string[] = [\n      (idx + 1).toString(),\n      s.rollNumber || \"\",\n      s.fullName || \"\",\n    ];\n\n    if (type === \"exam-slots\") {\n      const subjectInfo =\n        s.subjectCode || s.subjectName\n          ? `${s.subjectName || \"\"} (${s.subjectCode || \"\"})`\n          : \"N/A\";\n      baseRow.push(subjectInfo);\n    }\n\n    baseRow.push(\n      (s.status || \"N/A\").toUpperCase(),\n      s.checkInTime\n        ? format(parseVietnamTime(s.checkInTime), \"HH:mm:ss\")\n        : \"-\",\n      s.remark || \"-\"\n    );\n\n    return baseRow;\n  });\n\n  const allData = [...headerSection, studentHeaders, ...studentRows];\n  const sheet = XLSX.utils.aoa_to_sheet(allData);\n\n  // Column widths\n  sheet[\"!cols\"] =\n    type === \"exam-slots\"\n      ? [\n          { width: 6 }, // No.\n          { width: 15 }, // Roll Number\n          { width: 25 }, // Full Name\n          { width: 35 }, // Subject\n          { width: 12 }, // Status\n          { width: 15 }, // Check-in Time\n          { width: 30 }, // Remark\n        ]\n      : [\n          { width: 6 }, // No.\n          { width: 15 }, // Roll Number\n          { width: 25 }, // Full Name\n          { width: 12 }, // Status\n          { width: 15 }, // Check-in Time\n          { width: 30 }, // Remark\n        ];\n\n  return sheet;\n}\n"
    },
    {
      "path": "D:\\Work\\do_an_fall25\\fuacs\\frontend-web\\lib\\export-utils\\multi-class-export.ts",
      "relative_path": "lib/export-utils/multi-class-export.ts",
      "filename": "multi-class-export.ts",
      "size_bytes": 5176,
      "lines": 170,
      "last_modified": "2025-11-20T15:52:49.539261",
      "encoding": "utf-8",
      "language": "typescript",
      "content": "import * as XLSX from 'xlsx';\nimport { format } from 'date-fns';\nimport { parseVietnamTime } from '@/lib/timezone-utils';\n\ninterface ClassExportData {\n  classInfo: {\n    id: number;\n    code: string;\n    subject: { name: string; code: string };\n    semester: { name: string };\n  };\n  slots: Array<{\n    slotId: number;\n    title: string;\n    startTime: string;\n    endTime: string;\n  }>;\n  students: Array<{\n    rollNumber: string;\n    fullName: string;\n    attendanceRecords: Record<number, \"PRESENT\" | \"ABSENT\" | \"present\" | \"absent\" | null>;\n  }>;\n}\n\nexport function exportMultiClassesToExcel(classesData: ClassExportData[]) {\n  const workbook = XLSX.utils.book_new();\n\n  // Sheet 1: Overview - Summary cá»§a táº¥t cáº£ classes\n  const overviewData = [\n    ['MULTI-CLASS EXPORT REPORT', ''],\n    ['Export Date', format(new Date(), 'dd/MM/yyyy HH:mm')],\n    ['Total Classes Exported', classesData.length.toString()],\n    ['', ''],\n    ['CLASS LIST', ''],\n    ['No.', 'Class Code', 'Subject', 'Students', 'Slots'],\n    ...classesData.map((cls, idx) => [\n      (idx + 1).toString(),\n      cls.classInfo.code,\n      `${cls.classInfo.subject.name} (${cls.classInfo.subject.code})`,\n      cls.students.length.toString(),\n      cls.slots.length.toString()\n    ])\n  ];\n\n  const overviewSheet = XLSX.utils.aoa_to_sheet(overviewData);\n  overviewSheet['!cols'] = [\n    { width: 8 },  // No.\n    { width: 15 }, // Class Code\n    { width: 40 }, // Subject\n    { width: 12 }, // Students\n    { width: 12 }  // Slots\n  ];\n\n  // Style header\n  if (overviewSheet['A1']) {\n    overviewSheet['A1'].s = {\n      font: { bold: true, sz: 14 },\n      fill: { fgColor: { rgb: \"E3F2FD\" } }\n    };\n  }\n\n  XLSX.utils.book_append_sheet(workbook, overviewSheet, 'Overview');\n\n  // Sheets 2-N: Má»—i class lÃ  1 sheet vá»›i matrix format\n  classesData.forEach((classData) => {\n    const sheetData = createClassMatrixSheet(classData);\n    const sheetName = `${classData.classInfo.code}`.substring(0, 31); // Excel limit: 31 chars\n    XLSX.utils.book_append_sheet(workbook, sheetData.sheet, sheetName);\n  });\n\n  // Generate filename\n  const semesterName = classesData[0]?.classInfo.semester.name || 'Unknown';\n  const filename = `MultiClass_Export_${semesterName.replace(/\\s+/g, '_')}_${format(new Date(), 'yyyy-MM-dd')}.xlsx`;\n\n  XLSX.writeFile(workbook, filename);\n}\n\nfunction createClassMatrixSheet(classData: ClassExportData) {\n  const { classInfo, slots, students } = classData;\n\n  // Header section\n  const headerSection = [\n    ['CLASS INFORMATION', ''],\n    ['Class Code', classInfo.code],\n    ['Subject', `${classInfo.subject.name} (${classInfo.subject.code})`],\n    ['Semester', classInfo.semester.name],\n    ['Total Students', students.length.toString()],\n    ['Total Slots', slots.length.toString()],\n    ['', ''],\n    ['ATTENDANCE MATRIX', '']\n  ];\n\n  // Matrix headers\n  const matrixHeaders = [\n    'Roll Number',\n    'Full Name',\n    ...slots.map((slot, idx) =>\n      `Slot ${idx + 1} (${format(parseVietnamTime(slot.startTime), 'dd/MM/yyyy')})`\n    )\n  ];\n\n  // Matrix data rows\n  const matrixRows = students.map(student => [\n    student.rollNumber,\n    student.fullName,\n    ...slots.map(slot => {\n      const status = student.attendanceRecords[slot.slotId] ?? null;\n      return status?.toString().toUpperCase() === 'PRESENT' ? 'P' :\n             status?.toString().toUpperCase() === 'ABSENT' ? 'A' : '-';\n    })\n  ]);\n\n  // Combine all data\n  const allData = [\n    ...headerSection,\n    matrixHeaders,\n    ...matrixRows,\n    [''],\n    ['LEGEND'],\n    ['P = Present', 'A = Absent', '- = Not Yet Recorded']\n  ];\n\n  const sheet = XLSX.utils.aoa_to_sheet(allData);\n\n  // Set column widths\n  const colWidths = [\n    { width: 15 }, // Roll Number\n    { width: 25 }, // Full Name\n    ...slots.map(() => ({ width: 20 })) // Slot columns with date\n  ];\n  sheet['!cols'] = colWidths;\n\n  // Apply styling\n  const headerRowIndex = headerSection.length;\n\n  // Style matrix headers\n  matrixHeaders.forEach((_, colIdx) => {\n    const cellRef = XLSX.utils.encode_cell({ r: headerRowIndex, c: colIdx });\n    if (!sheet[cellRef]) return;\n    sheet[cellRef].s = {\n      font: { bold: true },\n      fill: { fgColor: { rgb: \"E8F5E8\" } },\n      alignment: { horizontal: \"center\", vertical: \"center\" }\n    };\n  });\n\n  // Style status cells\n  students.forEach((student, rowIdx) => {\n    slots.forEach((slot, colIdx) => {\n      const status = student.attendanceRecords[slot.slotId] ?? null;\n      const cellRef = XLSX.utils.encode_cell({\n        r: headerRowIndex + 1 + rowIdx,\n        c: 2 + colIdx\n      });\n\n      if (!sheet[cellRef]) return;\n\n      const color = status?.toString().toUpperCase() === 'PRESENT' ? 'C8E6C9' : // Green\n                    status?.toString().toUpperCase() === 'ABSENT' ? 'FFCDD2' :  // Red\n                    'E0E0E0'; // Gray\n\n      sheet[cellRef].s = {\n        fill: { fgColor: { rgb: color } },\n        alignment: { horizontal: \"center\", vertical: \"center\" }\n      };\n    });\n  });\n\n  return { sheet };\n}\n"
    },
    {
      "path": "D:\\Work\\do_an_fall25\\fuacs\\frontend-web\\lib\\export-utils\\multi-slot-export.ts",
      "relative_path": "lib/export-utils/multi-slot-export.ts",
      "filename": "multi-slot-export.ts",
      "size_bytes": 5828,
      "lines": 191,
      "last_modified": "2025-11-20T15:50:33.834727",
      "encoding": "utf-8",
      "language": "typescript",
      "content": "import * as XLSX from 'xlsx';\nimport { format } from 'date-fns';\nimport { parseVietnamTime } from '@/lib/timezone-utils';\n\ninterface SlotExportData {\n  slotId: number;\n  title: string;\n  description?: string;\n  startTime: string;\n  endTime: string;\n  room?: {\n    id: number;\n    name: string;\n    location: string;\n  };\n  staff?: {\n    id: number;\n    username: string;\n    email: string;\n    fullName: string;\n  };\n  sessionStatus?: string;\n  subjects?: Array<{\n    id: number;\n    name: string;\n    code: string;\n  }>;\n  students: Array<{\n    studentId?: number;\n    rollNumber: string;\n    fullName: string;\n    subjectCode: string;\n    subjectName: string;\n    attendanceId?: number;\n    status: 'present' | 'absent' | 'late';\n    method?: string;\n    recordedAt?: string;\n    checkInTime?: string;\n    remark?: string;\n  }>;\n  statistics: {\n    totalStudents: number;\n    presentCount: number;\n    absentCount: number;\n    lateCount: number;\n  };\n}\n\nexport function exportMultiSlotsToExcel(slotsData: SlotExportData[]) {\n  const workbook = XLSX.utils.book_new();\n\n  // Sheet 1: Overview\n  const overviewData = [\n    ['MULTI-SLOT EXPORT REPORT', ''],\n    ['Export Date', format(new Date(), 'dd/MM/yyyy HH:mm')],\n    ['Total Exam Slots Exported', slotsData.length.toString()],\n    ['', ''],\n    ['SLOT LIST', ''],\n    ['No.', 'Slot ID', 'Title', 'Date', 'Time', 'Total Students', 'Present', 'Absent', 'Late'],\n    ...slotsData.map((slot, idx) => [\n      (idx + 1).toString(),\n      slot.slotId?.toString() || '',\n      slot.title || 'Final Exam',\n      format(parseVietnamTime(slot.startTime), 'dd/MM/yyyy'),\n      `${format(parseVietnamTime(slot.startTime), 'HH:mm')}-${format(parseVietnamTime(slot.endTime), 'HH:mm')}`,\n      (slot.statistics?.totalStudents ?? 0).toString(),\n      (slot.statistics?.presentCount ?? 0).toString(),\n      (slot.statistics?.absentCount ?? 0).toString(),\n      (slot.statistics?.lateCount ?? 0).toString()\n    ])\n  ];\n\n  const overviewSheet = XLSX.utils.aoa_to_sheet(overviewData);\n  overviewSheet['!cols'] = [\n    { width: 8 },  // No.\n    { width: 10 }, // Slot ID\n    { width: 25 }, // Title\n    { width: 12 }, // Date\n    { width: 15 }, // Time\n    { width: 12 }, // Total\n    { width: 10 }, // Present\n    { width: 10 }, // Absent\n    { width: 10 }  // Late\n  ];\n\n  XLSX.utils.book_append_sheet(workbook, overviewSheet, 'Overview');\n\n  // Sheets 2-N: Má»—i slot lÃ  1 sheet vá»›i tÃªn SLOT_01, SLOT_02, ...\n  slotsData.forEach((slotData, idx) => {\n    const sheetData = createSlotDetailSheet(slotData);\n    const slotNumber = (idx + 1).toString().padStart(2, '0');\n    const sheetName = `SLOT_${slotNumber}`;\n    XLSX.utils.book_append_sheet(workbook, sheetData.sheet, sheetName);\n  });\n\n  // Generate filename\n  const filename = `MultiSlot_Export_${format(new Date(), 'yyyy-MM-dd_HHmm')}.xlsx`;\n  XLSX.writeFile(workbook, filename);\n}\n\nfunction createSlotDetailSheet(slotData: SlotExportData) {\n  const { title, startTime, endTime, students = [], statistics } = slotData;\n\n  const safeStats = {\n    totalStudents: statistics?.totalStudents ?? 0,\n    presentCount: statistics?.presentCount ?? 0,\n    absentCount: statistics?.absentCount ?? 0,\n    lateCount: statistics?.lateCount ?? 0\n  };\n\n  // Header section\n  const headerSection = [\n    ['EXAM SLOT INFORMATION', ''],\n    ['Title', title || 'Final Exam'],\n    ['Date', format(parseVietnamTime(startTime), 'EEEE, dd/MM/yyyy')],\n    ['Time', `${format(parseVietnamTime(startTime), 'HH:mm')} - ${format(parseVietnamTime(endTime), 'HH:mm')}`],\n    ['', ''],\n    ['STATISTICS', ''],\n    ['Total Students', safeStats.totalStudents.toString()],\n    ['Present', safeStats.presentCount.toString()],\n    ['Absent', safeStats.absentCount.toString()],\n    ['Late', safeStats.lateCount.toString()],\n    ['', ''],\n    ['STUDENT ATTENDANCE DETAILS', '']\n  ];\n\n  // Student table\n  const studentHeaders = ['No.', 'Roll Number', 'Full Name', 'Subject', 'Status', 'Check-in Time', 'Remark'];\n  const studentRows = students.map((s, idx) => [\n    (idx + 1).toString(),\n    s.rollNumber || '',\n    s.fullName || '',\n    `${s.subjectName || ''} (${s.subjectCode || ''})`,\n    (s.status || 'N/A').toUpperCase(),\n    s.checkInTime ? format(parseVietnamTime(s.checkInTime), 'HH:mm:ss') : '-',\n    s.remark || '-'\n  ]);\n\n  const allData = [\n    ...headerSection,\n    studentHeaders,\n    ...studentRows\n  ];\n\n  const sheet = XLSX.utils.aoa_to_sheet(allData);\n\n  // Column widths\n  sheet['!cols'] = [\n    { width: 8 },  // No.\n    { width: 15 }, // Roll Number\n    { width: 25 }, // Full Name\n    { width: 35 }, // Subject\n    { width: 12 }, // Status\n    { width: 15 }, // Check-in Time\n    { width: 30 }  // Remark\n  ];\n\n  // Style headers\n  const headerRowIndex = headerSection.length;\n  studentHeaders.forEach((_, colIdx) => {\n    const cellRef = XLSX.utils.encode_cell({ r: headerRowIndex, c: colIdx });\n    if (!sheet[cellRef]) return;\n    sheet[cellRef].s = {\n      font: { bold: true },\n      fill: { fgColor: { rgb: \"E8F5E8\" } },\n      alignment: { horizontal: \"center\" }\n    };\n  });\n\n  // Style status cells\n  students.forEach((student, rowIdx) => {\n    const statusCellRef = XLSX.utils.encode_cell({\n      r: headerRowIndex + 1 + rowIdx,\n      c: 4\n    });\n\n    if (!sheet[statusCellRef]) return;\n\n    const color = student.status === 'present' ? 'C8E6C9' : // Green\n                  student.status === 'absent' ? 'FFCDD2' :  // Red\n                  'FFE0B2'; // Orange (late)\n\n    sheet[statusCellRef].s = {\n      fill: { fgColor: { rgb: color } },\n      alignment: { horizontal: \"center\" },\n      font: { bold: true }\n    };\n  });\n\n  return { sheet };\n}\n"
    },
    {
      "path": "D:\\Work\\do_an_fall25\\fuacs\\frontend-web\\lib\\image-utils.ts",
      "relative_path": "lib/image-utils.ts",
      "filename": "image-utils.ts",
      "size_bytes": 2600,
      "lines": 74,
      "last_modified": "2025-11-01T15:38:43.377128",
      "encoding": "utf-8",
      "language": "typescript",
      "content": "/**\n * Build full URL for evidence image\n * \n * @param relativePath - Relative path from backend (e.g., \"/evidence/9001/9001_SE123456.jpg\")\n * @returns Full URL to backend evidence endpoint\n */\nexport function getEvidenceImageUrl(relativePath: string | null | undefined): string | null {\n  if (!relativePath) {\n    return null;\n  }\n\n  const apiUrl = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:8080/api/v1\";\n  \n  // Remove /api/v1 suffix if present to avoid duplication\n  const baseUrl = apiUrl.replace(/\\/api\\/v1$/, \"\");\n  \n  let cleanPath = relativePath;\n  \n  // Handle legacy format: /evidence/regular/... or /evidence/exam/...\n  if (cleanPath.match(/^\\/evidence\\/(regular|exam)\\//)) {\n    // Convert to legacy endpoint: /api/v1/evidence/legacy/regular/...\n    cleanPath = cleanPath.replace(\"/evidence/\", \"/evidence/legacy/\");\n  }\n  // Handle uploads prefix (old format)\n  else if (cleanPath.startsWith(\"/uploads/evidence/\")) {\n    cleanPath = cleanPath.replace(\"/uploads/evidence/\", \"/evidence/\");\n  }\n  \n  // Ensure path starts with /\n  cleanPath = cleanPath.startsWith(\"/\") ? cleanPath : `/${cleanPath}`;\n  \n  // Build full URL: http://localhost:8080/api/v1/evidence/9001/9001_SE123456.jpg\n  return `${baseUrl}/api/v1${cleanPath}`;\n}\n\n/**\n * Build full URL for student profile photo\n * \n * @param photoUrl - Photo URL from backend (e.g., \"/api/v1/student-photos/123/123_profile.jpg\")\n * @returns Full URL to backend student photo endpoint\n */\nexport function getProfilePhotoUrl(photoUrl: string | null | undefined): string | null {\n  if (!photoUrl) {\n    return null;\n  }\n\n  const apiUrl = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:8080/api/v1\";\n  \n  // Remove /api/v1 suffix if present to avoid duplication\n  const baseUrl = apiUrl.replace(/\\/api\\/v1$/, \"\");\n  \n  // If photoUrl already starts with /api/v1, use it directly\n  if (photoUrl.startsWith(\"/api/v1/\")) {\n    return `${baseUrl}${photoUrl}`;\n  }\n  \n  // If photoUrl starts with /student-photos/, prepend /api/v1\n  if (photoUrl.startsWith(\"/student-photos/\")) {\n    return `${baseUrl}/api/v1${photoUrl}`;\n  }\n  \n  // Otherwise, ensure path starts with / and prepend base URL\n  const cleanPath = photoUrl.startsWith(\"/\") ? photoUrl : `/${photoUrl}`;\n  \n  // Build full URL: http://localhost:8080/api/v1/student-photos/123/123_profile.jpg\n  return `${baseUrl}/api/v1${cleanPath}`;\n}\n\n/**\n * Get placeholder image URL\n */\nexport function getPlaceholderImageUrl(): string {\n  return \"https://placehold.co/600x400/e2e8f0/64748b?text=No+Image\";\n}\n"
    },
    {
      "path": "D:\\Work\\do_an_fall25\\fuacs\\frontend-web\\lib\\menu-configs\\data-operator-menu.ts",
      "relative_path": "lib/menu-configs/data-operator-menu.ts",
      "filename": "data-operator-menu.ts",
      "size_bytes": 2596,
      "lines": 130,
      "last_modified": "2025-11-24T18:37:51.456830",
      "encoding": "utf-8",
      "language": "typescript",
      "content": "import {\n  LayoutDashboard,\n  Calendar,\n  BookOpen,\n  BookMarked,\n  Users,\n  Clock,\n  Building,\n  Camera,\n  UserCog,\n  FileText,\n  Download,\n  User,\n} from \"lucide-react\";\nimport { RoleMenuConfig } from \"@/types/navigation\";\n\nexport const dataOperatorMenu: RoleMenuConfig = {\n  role: \"data-operator\",\n  sections: [\n    {\n      id: \"overview\",\n      label: \"Overview\",\n      items: [\n        {\n          id: \"dashboard\",\n          label: \"Dashboard\",\n          href: \"/admin/dashboard\",\n          icon: LayoutDashboard,\n        },\n      ],\n    },\n    {\n      id: \"academic\",\n      label: \"Academic Management\",\n      items: [\n        {\n          id: \"semesters\",\n          label: \"Semesters\",\n          href: \"/admin/semesters\",\n          icon: Calendar,\n        },\n        {\n          id: \"majors\",\n          label: \"Majors\",\n          href: \"/admin/majors\",\n          icon: BookOpen,\n        },\n        {\n          id: \"subjects\",\n          label: \"Subjects\",\n          href: \"/admin/subjects\",\n          icon: BookMarked,\n        },\n        {\n          id: \"classes\",\n          label: \"Classes\",\n          href: \"/admin/classes\",\n          icon: Users,\n        },\n      ],\n    },\n    {\n      id: \"scheduling\",\n      label: \"Scheduling\",\n      items: [\n        {\n          id: \"slots\",\n          label: \"Slots\",\n          href: \"/admin/slots\",\n          icon: Clock,\n        },\n        {\n          id: \"exams\",\n          label: \"Exams\",\n          href: \"/admin/exams\",\n          icon: FileText,\n        },\n      ],\n    },\n    {\n      id: \"infrastructure\",\n      label: \"Infrastructure\",\n      items: [\n        {\n          id: \"rooms\",\n          label: \"Rooms\",\n          href: \"/admin/rooms\",\n          icon: Building,\n        },\n        {\n          id: \"cameras\",\n          label: \"Cameras\",\n          href: \"/admin/cameras\",\n          icon: Camera,\n        },\n      ],\n    },\n    {\n      id: \"people\",\n      label: \"People\",\n      items: [\n        {\n          id: \"users-roles\",\n          label: \"Users & Roles\",\n          href: \"/admin/users-roles\",\n          icon: UserCog,\n        },\n        {\n          id: \"profile\",\n          label: \"My Profile\",\n          href: \"/admin/profile\",\n          icon: User,\n        },\n      ],\n    },\n    {\n      id: \"reports\",\n      label: \"Reports\",\n      items: [\n        {\n          id: \"export\",\n          label: \"Export Data\",\n          href: \"/admin/export\",\n          icon: Download,\n        },\n      ],\n    },\n  ],\n};\n\n"
    },
    {
      "path": "D:\\Work\\do_an_fall25\\fuacs\\frontend-web\\lib\\menu-configs\\lecturer-menu.ts",
      "relative_path": "lib/menu-configs/lecturer-menu.ts",
      "filename": "lecturer-menu.ts",
      "size_bytes": 1355,
      "lines": 68,
      "last_modified": "2025-11-10T23:07:39.536420",
      "encoding": "utf-8",
      "language": "typescript",
      "content": "import {\n  LayoutDashboard,\n  Calendar,\n  Clock,\n  Users,\n  User,\n} from \"lucide-react\";\nimport { RoleMenuConfig } from \"@/types/navigation\";\n\nexport const lecturerMenu: RoleMenuConfig = {\n  role: \"lecturer\",\n  sections: [\n    {\n      id: \"overview\",\n      label: \"Overview\",\n      items: [\n        {\n          id: \"dashboard\",\n          label: \"Dashboard\",\n          href: \"/lecturer/dashboard\",\n          icon: LayoutDashboard,\n        },\n      ],\n    },\n    {\n      id: \"teaching\",\n      label: \"Teaching & Attendance\",\n      items: [\n        {\n          id: \"schedule\",\n          label: \"My Schedule\",\n          href: \"/lecturer/schedule\",\n          icon: Calendar,\n        },\n        {\n          id: \"slots\",\n          label: \"My Slots\",\n          href: \"/lecturer/slots\",\n          icon: Clock,\n        },\n      ],\n    },\n    {\n      id: \"reports\",\n      label: \"Reports\",\n      items: [\n        {\n          id: \"class-summary\",\n          label: \"Class Summary\",\n          href: \"/lecturer/reports/classes\",\n          icon: Users,\n        },\n      ],\n    },\n    {\n      id: \"account\",\n      label: \"Account\",\n      items: [\n        {\n          id: \"profile\",\n          label: \"Profile\",\n          href: \"/lecturer/profile\",\n          icon: User,\n        },\n      ],\n    },\n  ],\n};\n"
    },
    {
      "path": "D:\\Work\\do_an_fall25\\fuacs\\frontend-web\\lib\\menu-configs\\student-menu.ts",
      "relative_path": "lib/menu-configs/student-menu.ts",
      "filename": "student-menu.ts",
      "size_bytes": 1223,
      "lines": 61,
      "last_modified": "2025-11-10T23:07:39.537419",
      "encoding": "utf-8",
      "language": "typescript",
      "content": "import {\n  LayoutDashboard,\n  Calendar,\n  History,\n  User,\n} from \"lucide-react\";\nimport { RoleMenuConfig } from \"@/types/navigation\";\n\nexport const studentMenu: RoleMenuConfig = {\n  role: \"student\",\n  sections: [\n    {\n      id: \"overview\",\n      label: \"Overview\",\n      items: [\n        {\n          id: \"dashboard\",\n          label: \"Dashboard\",\n          href: \"/student/dashboard\",\n          icon: LayoutDashboard,\n        },\n      ],\n    },\n    {\n      id: \"schedule\",\n      label: \"Schedule & Classes\",\n      items: [\n        {\n          id: \"schedule\",\n          label: \"Class Schedule\",\n          href: \"/student/schedule\",\n          icon: Calendar,\n        },\n      ],\n    },\n    {\n      id: \"attendance\",\n      label: \"Attendance\",\n      items: [\n        {\n          id: \"attendance-history\",\n          label: \"Attendance History\",\n          href: \"/student/attendance/history\",\n          icon: History,\n        },\n      ],\n    },\n    {\n      id: \"account\",\n      label: \"Account\",\n      items: [\n        {\n          id: \"profile\",\n          label: \"Profile\",\n          href: \"/student/profile\",\n          icon: User,\n        },\n      ],\n    },\n  ],\n};"
    },
    {
      "path": "D:\\Work\\do_an_fall25\\fuacs\\frontend-web\\lib\\menu-configs\\supervisor-menu.ts",
      "relative_path": "lib/menu-configs/supervisor-menu.ts",
      "filename": "supervisor-menu.ts",
      "size_bytes": 1376,
      "lines": 68,
      "last_modified": "2025-11-01T15:38:43.379634",
      "encoding": "utf-8",
      "language": "typescript",
      "content": "import {\n  LayoutDashboard,\n  Calendar,\n  Clock,\n  BarChart3,\n  User,\n} from \"lucide-react\";\nimport { RoleMenuConfig } from \"@/types/navigation\";\n\nexport const supervisorMenu: RoleMenuConfig = {\n  role: \"supervisor\",\n  sections: [\n    {\n      id: \"overview\",\n      label: \"Overview\",\n      items: [\n        {\n          id: \"dashboard\",\n          label: \"Dashboard\",\n          href: \"/supervisor/dashboard\",\n          icon: LayoutDashboard,\n        },\n      ],\n    },\n    {\n      id: \"exam-supervision\",\n      label: \"Exam Supervision\",\n      items: [\n        {\n          id: \"schedule\",\n          label: \"My Schedule\",\n          href: \"/supervisor/schedule\",\n          icon: Calendar,\n        },\n        {\n          id: \"slots\",\n          label: \"My Slots\",\n          href: \"/supervisor/slots\",\n          icon: Clock,\n        },\n      ],\n    },\n    {\n      id: \"reports\",\n      label: \"Reports\",\n      items: [\n        {\n          id: \"slot-reports\",\n          label: \"Slot Reports\",\n          href: \"/supervisor/reports/slots\",\n          icon: BarChart3,\n        },\n      ],\n    },\n    {\n      id: \"account\",\n      label: \"Account\",\n      items: [\n        {\n          id: \"profile\",\n          label: \"Profile\",\n          href: \"/supervisor/profile\",\n          icon: User,\n        },\n      ],\n    },\n  ],\n};\n"
    },
    {
      "path": "D:\\Work\\do_an_fall25\\fuacs\\frontend-web\\lib\\navigation-state.ts",
      "relative_path": "lib/navigation-state.ts",
      "filename": "navigation-state.ts",
      "size_bytes": 6237,
      "lines": 229,
      "last_modified": "2025-11-01T15:38:43.379634",
      "encoding": "utf-8",
      "language": "typescript",
      "content": "/**\n * Utilities for persisting navigation state across pages\n * Used to restore filters/query params when navigating back\n */\n\nconst SLOTS_STATE_KEY = \"slots_page_state\";\nconst EXAMS_STATE_KEY = \"exams_page_state\";\nconst NAVIGATION_CONTEXT_KEY = \"navigation_context\";\n\nexport interface PageState {\n  searchParams: string; // URL search params as string\n  timestamp: number; // To expire old state\n}\n\nexport interface NavigationContext {\n  currentPath: string;\n  isTemporaryNavigation: boolean; // true for participants/roster, false for main navigation\n  timestamp: number;\n}\n\n/**\n * Save slots page state to sessionStorage\n */\nexport function saveSlotsPageState(searchParams: URLSearchParams) {\n  try {\n    const state: PageState = {\n      searchParams: searchParams.toString(),\n      timestamp: Date.now(),\n    };\n    sessionStorage.setItem(SLOTS_STATE_KEY, JSON.stringify(state));\n  } catch (error) {\n    console.error(\"Failed to save slots page state:\", error);\n  }\n}\n\n/**\n * Get saved slots page state from sessionStorage\n * Returns null if no state or state is too old (> 1 hour)\n */\nexport function getSlotsPageState(): PageState | null {\n  try {\n    const saved = sessionStorage.getItem(SLOTS_STATE_KEY);\n    if (!saved) return null;\n\n    const state: PageState = JSON.parse(saved);\n    const oneHour = 60 * 60 * 1000;\n\n    // Expire state after 1 hour\n    if (Date.now() - state.timestamp > oneHour) {\n      sessionStorage.removeItem(SLOTS_STATE_KEY);\n      return null;\n    }\n\n    return state;\n  } catch (error) {\n    console.error(\"Failed to get slots page state:\", error);\n    return null;\n  }\n}\n\n/**\n * Clear saved slots page state\n */\nexport function clearSlotsPageState() {\n  try {\n    sessionStorage.removeItem(SLOTS_STATE_KEY);\n  } catch (error) {\n    console.error(\"Failed to clear slots page state:\", error);\n  }\n}\n\n/**\n * Build slots page URL with saved state or default\n */\nexport function buildSlotsPageUrl(): string {\n  const savedState = getSlotsPageState();\n  if (savedState?.searchParams) {\n    return `/admin/slots?${savedState.searchParams}`;\n  }\n  return \"/admin/slots\";\n}\n\n/**\n * Save exams page state to sessionStorage\n */\nexport function saveExamsPageState(searchParams: URLSearchParams) {\n  try {\n    const state: PageState = {\n      searchParams: searchParams.toString(),\n      timestamp: Date.now(),\n    };\n    sessionStorage.setItem(EXAMS_STATE_KEY, JSON.stringify(state));\n  } catch (error) {\n    console.error(\"Failed to save exams page state:\", error);\n  }\n}\n\n/**\n * Get saved exams page state from sessionStorage\n * Returns null if no state or state is too old (> 1 hour)\n */\nexport function getExamsPageState(): PageState | null {\n  try {\n    const saved = sessionStorage.getItem(EXAMS_STATE_KEY);\n    if (!saved) return null;\n\n    const state: PageState = JSON.parse(saved);\n    const oneHour = 60 * 60 * 1000;\n\n    // Expire state after 1 hour\n    if (Date.now() - state.timestamp > oneHour) {\n      sessionStorage.removeItem(EXAMS_STATE_KEY);\n      return null;\n    }\n\n    return state;\n  } catch (error) {\n    console.error(\"Failed to get exams page state:\", error);\n    return null;\n  }\n}\n\n/**\n * Clear saved exams page state\n */\nexport function clearExamsPageState() {\n  try {\n    sessionStorage.removeItem(EXAMS_STATE_KEY);\n  } catch (error) {\n    console.error(\"Failed to clear exams page state:\", error);\n  }\n}\n\n/**\n * Save navigation context\n */\nexport function saveNavigationContext(\n  pathname: string,\n  isTemporaryNavigation = false\n) {\n  try {\n    const context: NavigationContext = {\n      currentPath: pathname,\n      isTemporaryNavigation,\n      timestamp: Date.now(),\n    };\n    sessionStorage.setItem(NAVIGATION_CONTEXT_KEY, JSON.stringify(context));\n  } catch (error) {\n    console.error(\"Failed to save navigation context:\", error);\n  }\n}\n\n/**\n * Get navigation context\n */\nexport function getNavigationContext(): NavigationContext | null {\n  try {\n    const saved = sessionStorage.getItem(NAVIGATION_CONTEXT_KEY);\n    if (!saved) return null;\n\n    const context: NavigationContext = JSON.parse(saved);\n    return context;\n  } catch (error) {\n    console.error(\"Failed to get navigation context:\", error);\n    return null;\n  }\n}\n\n/**\n * Clear navigation context\n */\nexport function clearNavigationContext() {\n  try {\n    sessionStorage.removeItem(NAVIGATION_CONTEXT_KEY);\n  } catch (error) {\n    console.error(\"Failed to clear navigation context:\", error);\n  }\n}\n\n/**\n * Check if current navigation is a temporary detour (participants/roster)\n */\nexport function isTemporaryNavigation(): boolean {\n  const context = getNavigationContext();\n  return context?.isTemporaryNavigation || false;\n}\n\n/**\n * Clear exams page state only if not in temporary navigation\n */\nexport function clearExamsPageStateIfNotTemporary() {\n  const context = getNavigationContext();\n  if (!context?.isTemporaryNavigation) {\n    clearExamsPageState();\n  }\n}\n\n/**\n * Build exams page URL with saved state or default\n */\nexport function buildExamsPageUrl(): string {\n  const savedState = getExamsPageState();\n  if (savedState?.searchParams) {\n    return `/admin/exams?${savedState.searchParams}`;\n  }\n  return \"/admin/exams\";\n}\n\n/**\n * Check if we should restore exams page state\n * Only restore if coming from temporary navigation (participants/roster)\n * Do NOT restore when navigating from other screens\n */\nexport function shouldRestoreExamsPageState(\n  currentParams: URLSearchParams,\n  pathname: string\n): boolean {\n  const context = getNavigationContext();\n\n  // Only restore if ALL conditions are met:\n  // 1. We're on the exact /admin/exams page (not sub-pages)\n  // 2. Navigation context exists and marks this as temporary navigation\n  // 3. Current URL has no params (meaning fresh load or back navigation)\n  const isExamsPage = pathname === \"/admin/exams\";\n  const isFromTemporaryNav = context?.isTemporaryNavigation === true;\n  const hasNoCurrentParams = currentParams.toString() === \"\";\n\n  return isExamsPage && isFromTemporaryNav && hasNoCurrentParams;\n}\n"
    },
    {
      "path": "D:\\Work\\do_an_fall25\\fuacs\\frontend-web\\lib\\permissions.ts",
      "relative_path": "lib/permissions.ts",
      "filename": "permissions.ts",
      "size_bytes": 15336,
      "lines": 487,
      "last_modified": "2025-11-21T02:00:10.704295",
      "encoding": "utf-8",
      "language": "typescript",
      "content": "'use client';\n\n/**\n * Permission System Utilities\n *\n * This module provides a centralized permission management system for the frontend.\n * It includes:\n * - All 114 permissions matching backend Permission.java enum\n * - Role-to-permission mappings synchronized with V7 SQL seed data\n * - Helper functions for permission checking\n * - React hooks for component-level permission checks\n *\n * @module permissions\n */\n\nimport { useMemo, useEffect, useState } from 'react';\nimport { getAuthUser } from '@/lib/auth';\n\n// ============================================================================\n// PERMISSION CONSTANTS (113 total - synced with backend Permission.java)\n// ============================================================================\n\nexport const PERMISSIONS = {\n  // User Management\n  USER_READ_LIST: 'USER_READ_LIST',\n  USER_WRITE_LIST: 'USER_WRITE_LIST',\n  USER_READ_DETAIL: 'USER_READ_DETAIL',\n  USER_CREATE: 'USER_CREATE',\n  USER_UPDATE_INFO: 'USER_UPDATE_INFO',\n  USER_DELETE_HARD: 'USER_DELETE_HARD',\n  USER_UPDATE_STATUS: 'USER_UPDATE_STATUS',\n  USER_ASSIGN_ROLES: 'USER_ASSIGN_ROLES',\n\n  // Import Operations\n  STUDENT_IMPORT: 'STUDENT_IMPORT',\n  STAFF_IMPORT: 'STAFF_IMPORT',\n\n  // Class Management\n  CLASS_READ: 'CLASS_READ',\n  CLASS_CREATE: 'CLASS_CREATE',\n  CLASS_UPDATE: 'CLASS_UPDATE',\n  CLASS_DELETE: 'CLASS_DELETE',\n  CLASS_DELETE_HARD: 'CLASS_DELETE_HARD',\n  CLASS_IMPORT: 'CLASS_IMPORT',\n\n  // Slot Management\n  SLOT_READ: 'SLOT_READ',\n  SLOT_CREATE: 'SLOT_CREATE',\n  SLOT_CREATE_FINAL_EXAM: 'SLOT_CREATE_FINAL_EXAM',\n  SLOT_UPDATE: 'SLOT_UPDATE',\n  SLOT_UPDATE_CATEGORY: 'SLOT_UPDATE_CATEGORY',\n  SLOT_UPDATE_FINAL_EXAM: 'SLOT_UPDATE_FINAL_EXAM',\n  SLOT_DELETE: 'SLOT_DELETE',\n  SLOT_DELETE_HARD: 'SLOT_DELETE_HARD',\n  SLOT_DELETE_HARD_FINAL_EXAM: 'SLOT_DELETE_HARD_FINAL_EXAM',\n  SLOT_IMPORT: 'SLOT_IMPORT',\n\n  // Slot Session Management\n  SLOT_SESSION_START: 'SLOT_SESSION_START',\n  SLOT_SESSION_FINALIZE: 'SLOT_SESSION_FINALIZE',\n  SLOT_SESSION_RESCAN: 'SLOT_SESSION_RESCAN',\n\n  // Semester Management\n  SEMESTER_READ: 'SEMESTER_READ',\n  SEMESTER_CREATE: 'SEMESTER_CREATE',\n  SEMESTER_UPDATE: 'SEMESTER_UPDATE',\n  SEMESTER_DELETE: 'SEMESTER_DELETE',\n  SEMESTER_DELETE_HARD: 'SEMESTER_DELETE_HARD',\n  SEMESTER_IMPORT: 'SEMESTER_IMPORT',\n\n  // Subject Management\n  SUBJECT_READ: 'SUBJECT_READ',\n  SUBJECT_CREATE: 'SUBJECT_CREATE',\n  SUBJECT_UPDATE: 'SUBJECT_UPDATE',\n  SUBJECT_DELETE: 'SUBJECT_DELETE',\n  SUBJECT_DELETE_HARD: 'SUBJECT_DELETE_HARD',\n  SUBJECT_IMPORT: 'SUBJECT_IMPORT',\n\n  // Major Management\n  MAJOR_READ: 'MAJOR_READ',\n  MAJOR_CREATE: 'MAJOR_CREATE',\n  MAJOR_UPDATE: 'MAJOR_UPDATE',\n  MAJOR_DELETE_HARD: 'MAJOR_DELETE_HARD',\n  MAJOR_IMPORT: 'MAJOR_IMPORT',\n\n  // Room Management\n  ROOM_READ: 'ROOM_READ',\n  ROOM_CREATE: 'ROOM_CREATE',\n  ROOM_UPDATE: 'ROOM_UPDATE',\n  ROOM_DELETE_HARD: 'ROOM_DELETE_HARD',\n  ROOM_IMPORT: 'ROOM_IMPORT',\n\n  // Camera Management\n  CAMERA_READ: 'CAMERA_READ',\n  CAMERA_CREATE: 'CAMERA_CREATE',\n  CAMERA_UPDATE: 'CAMERA_UPDATE',\n  CAMERA_DELETE: 'CAMERA_DELETE',\n  CAMERA_DELETE_HARD: 'CAMERA_DELETE_HARD',\n  CAMERA_IMPORT: 'CAMERA_IMPORT',\n\n  // Attendance Management\n  ATTENDANCE_ROSTER_READ: 'ATTENDANCE_ROSTER_READ',\n  ATTENDANCE_STATUS_UPDATE_MANUAL: 'ATTENDANCE_STATUS_UPDATE_MANUAL',\n  ATTENDANCE_REMARK_MANAGE: 'ATTENDANCE_REMARK_MANAGE',\n\n  // Enrollment Management\n  ENROLLMENT_MANAGE: 'ENROLLMENT_MANAGE',\n\n  // Reporting & Personal Access\n  OWN_SCHEDULE_READ: 'OWN_SCHEDULE_READ',\n  OWN_ATTENDANCE_HISTORY_READ: 'OWN_ATTENDANCE_HISTORY_READ',\n  OWN_SUBJECT_READ: 'OWN_SUBJECT_READ',\n  LECTURER_READ: 'LECTURER_READ',\n  REPORT_READ_OWN_SLOT: 'REPORT_READ_OWN_SLOT',\n  REPORT_EXPORT_OWN_SLOT: 'REPORT_EXPORT_OWN_SLOT',\n  REPORT_READ_CLASS_SUMMARY: 'REPORT_READ_CLASS_SUMMARY',\n  REPORT_READ_SYSTEM_WIDE: 'REPORT_READ_SYSTEM_WIDE',\n  REPORT_EXPORT_ACADEMIC_DATA: 'REPORT_EXPORT_ACADEMIC_DATA',\n  OWN_PROFILE_READ: 'OWN_PROFILE_READ',\n  OWN_PASSWORD_UPDATE: 'OWN_PASSWORD_UPDATE',\n\n  // Role & Permission Management\n  ROLE_READ: 'ROLE_READ',\n  ROLE_CREATE: 'ROLE_CREATE',\n  ROLE_UPDATE: 'ROLE_UPDATE',\n  ROLE_DELETE_HARD: 'ROLE_DELETE_HARD',\n  PERMISSION_READ: 'PERMISSION_READ',\n  PERMISSION_CREATE: 'PERMISSION_CREATE',\n  PERMISSION_UPDATE: 'PERMISSION_UPDATE',\n  PERMISSION_DELETE: 'PERMISSION_DELETE',\n\n  // Dashboard View Permissions\n  DASHBOARD_VIEW_STUDENT: 'DASHBOARD_VIEW_STUDENT',\n  DASHBOARD_VIEW_LECTURER: 'DASHBOARD_VIEW_LECTURER',\n  DASHBOARD_VIEW_SUPERVISOR: 'DASHBOARD_VIEW_SUPERVISOR',\n  DASHBOARD_VIEW_DATA_OPERATOR: 'DASHBOARD_VIEW_DATA_OPERATOR',\n} as const;\n\nexport type Permission = typeof PERMISSIONS[keyof typeof PERMISSIONS];\n\n// ============================================================================\n// ROLE-PERMISSION MAPPINGS (synced with V7__Seed_roles_and_permissions.sql)\n// ============================================================================\n\nexport const ROLE_PERMISSIONS: Record<string, readonly Permission[]> = {\n  DATA_OPERATOR: [\n    // User Management\n    PERMISSIONS.USER_CREATE,\n    PERMISSIONS.USER_READ_LIST,\n    PERMISSIONS.USER_READ_DETAIL,\n    PERMISSIONS.USER_UPDATE_INFO,\n    PERMISSIONS.USER_UPDATE_STATUS,\n    PERMISSIONS.USER_ASSIGN_ROLES,\n    PERMISSIONS.USER_DELETE_HARD,\n    PERMISSIONS.STUDENT_IMPORT,\n    PERMISSIONS.STAFF_IMPORT,\n    // Academic Catalog\n    PERMISSIONS.SEMESTER_CREATE,\n    PERMISSIONS.SEMESTER_READ,\n    PERMISSIONS.SEMESTER_UPDATE,\n    PERMISSIONS.SEMESTER_DELETE_HARD,\n    PERMISSIONS.SEMESTER_IMPORT,\n    PERMISSIONS.MAJOR_CREATE,\n    PERMISSIONS.MAJOR_READ,\n    PERMISSIONS.MAJOR_UPDATE,\n    PERMISSIONS.MAJOR_DELETE_HARD,\n    PERMISSIONS.MAJOR_IMPORT,\n    PERMISSIONS.SUBJECT_CREATE,\n    PERMISSIONS.SUBJECT_READ,\n    PERMISSIONS.SUBJECT_UPDATE,\n    PERMISSIONS.SUBJECT_DELETE_HARD,\n    PERMISSIONS.SUBJECT_IMPORT,\n    PERMISSIONS.CLASS_CREATE,\n    PERMISSIONS.CLASS_READ,\n    PERMISSIONS.CLASS_UPDATE,\n    PERMISSIONS.CLASS_DELETE_HARD,\n    PERMISSIONS.CLASS_IMPORT,\n    PERMISSIONS.SLOT_CREATE,\n    PERMISSIONS.SLOT_READ,\n    PERMISSIONS.SLOT_UPDATE,\n    PERMISSIONS.SLOT_DELETE_HARD,\n    PERMISSIONS.SLOT_IMPORT,\n    PERMISSIONS.SLOT_UPDATE_CATEGORY,\n    PERMISSIONS.SLOT_CREATE_FINAL_EXAM,\n    PERMISSIONS.SLOT_UPDATE_FINAL_EXAM,\n    PERMISSIONS.SLOT_DELETE_HARD_FINAL_EXAM,\n    PERMISSIONS.ENROLLMENT_MANAGE,\n    // Attendance\n    PERMISSIONS.SLOT_SESSION_START,\n    PERMISSIONS.SLOT_SESSION_FINALIZE,\n    PERMISSIONS.SLOT_SESSION_RESCAN,\n    PERMISSIONS.ATTENDANCE_ROSTER_READ,\n    PERMISSIONS.ATTENDANCE_STATUS_UPDATE_MANUAL,\n    PERMISSIONS.ATTENDANCE_REMARK_MANAGE,\n    // Infrastructure\n    PERMISSIONS.ROOM_CREATE,\n    PERMISSIONS.ROOM_READ,\n    PERMISSIONS.ROOM_UPDATE,\n    PERMISSIONS.ROOM_DELETE_HARD,\n    PERMISSIONS.ROOM_IMPORT,\n    PERMISSIONS.CAMERA_CREATE,\n    PERMISSIONS.CAMERA_READ,\n    PERMISSIONS.CAMERA_UPDATE,\n    PERMISSIONS.CAMERA_DELETE_HARD,\n    PERMISSIONS.CAMERA_IMPORT,\n    // Reporting\n    PERMISSIONS.REPORT_READ_SYSTEM_WIDE,\n    PERMISSIONS.REPORT_EXPORT_ACADEMIC_DATA,\n    // System Administration\n    PERMISSIONS.ROLE_READ,\n    PERMISSIONS.ROLE_CREATE,\n    PERMISSIONS.ROLE_UPDATE,\n    PERMISSIONS.ROLE_DELETE_HARD,\n    PERMISSIONS.PERMISSION_READ,\n    PERMISSIONS.PERMISSION_CREATE,\n    PERMISSIONS.PERMISSION_UPDATE,\n    PERMISSIONS.PERMISSION_DELETE,\n    // General\n    PERMISSIONS.OWN_PROFILE_READ,\n    PERMISSIONS.OWN_PASSWORD_UPDATE,\n    // Dashboard\n    PERMISSIONS.DASHBOARD_VIEW_DATA_OPERATOR,\n  ],\n\n  LECTURER: [\n    // Attendance & Session Management\n    PERMISSIONS.OWN_SCHEDULE_READ,\n    PERMISSIONS.SLOT_SESSION_START,\n    PERMISSIONS.SLOT_SESSION_FINALIZE,\n    PERMISSIONS.SLOT_SESSION_RESCAN,\n    PERMISSIONS.ATTENDANCE_ROSTER_READ,\n    PERMISSIONS.ATTENDANCE_STATUS_UPDATE_MANUAL,\n    PERMISSIONS.ATTENDANCE_REMARK_MANAGE,\n    PERMISSIONS.SLOT_UPDATE_CATEGORY,\n    // Lecturer Data Access\n    PERMISSIONS.LECTURER_READ,\n    // Reporting\n    PERMISSIONS.REPORT_READ_OWN_SLOT,\n    PERMISSIONS.REPORT_EXPORT_OWN_SLOT,\n    PERMISSIONS.REPORT_READ_CLASS_SUMMARY,\n    // Read Access\n    PERMISSIONS.ROOM_READ,\n    PERMISSIONS.CAMERA_READ,\n    PERMISSIONS.SEMESTER_READ,\n    PERMISSIONS.CLASS_READ,\n    PERMISSIONS.MAJOR_READ,\n    PERMISSIONS.SLOT_READ,\n    PERMISSIONS.SUBJECT_READ,\n    // General\n    PERMISSIONS.OWN_PROFILE_READ,\n    PERMISSIONS.OWN_PASSWORD_UPDATE,\n    // Dashboard\n    PERMISSIONS.DASHBOARD_VIEW_LECTURER,\n  ],\n\n  SUPERVISOR: [\n    // Exam Attendance & Session Management\n    PERMISSIONS.OWN_SCHEDULE_READ,\n    PERMISSIONS.SLOT_SESSION_START,\n    PERMISSIONS.SLOT_SESSION_FINALIZE,\n    PERMISSIONS.SLOT_SESSION_RESCAN,\n    PERMISSIONS.ATTENDANCE_ROSTER_READ,\n    PERMISSIONS.ATTENDANCE_STATUS_UPDATE_MANUAL,\n    PERMISSIONS.ATTENDANCE_REMARK_MANAGE,\n    // Reporting\n    PERMISSIONS.REPORT_READ_OWN_SLOT,\n    PERMISSIONS.REPORT_EXPORT_OWN_SLOT,\n    // Read Access\n    PERMISSIONS.ROOM_READ,\n    PERMISSIONS.CAMERA_READ,\n    PERMISSIONS.SEMESTER_READ,\n    PERMISSIONS.CLASS_READ,\n    PERMISSIONS.MAJOR_READ,\n    PERMISSIONS.SLOT_READ,\n    PERMISSIONS.SUBJECT_READ,\n    // General\n    PERMISSIONS.OWN_PROFILE_READ,\n    PERMISSIONS.OWN_PASSWORD_UPDATE,\n    // Dashboard\n    PERMISSIONS.DASHBOARD_VIEW_SUPERVISOR,\n  ],\n\n  STUDENT: [\n    // Personal Data Access\n    PERMISSIONS.OWN_SCHEDULE_READ,\n    PERMISSIONS.OWN_ATTENDANCE_HISTORY_READ,\n    PERMISSIONS.OWN_SUBJECT_READ,\n    PERMISSIONS.OWN_PROFILE_READ,\n    PERMISSIONS.OWN_PASSWORD_UPDATE,\n    // Read Access\n    PERMISSIONS.ROOM_READ,\n    PERMISSIONS.SEMESTER_READ,\n    PERMISSIONS.CLASS_READ,\n    PERMISSIONS.MAJOR_READ,\n    PERMISSIONS.SLOT_READ,\n    PERMISSIONS.SUBJECT_READ,\n    // Dashboard\n    PERMISSIONS.DASHBOARD_VIEW_STUDENT,\n  ],\n} as const;\n\n// ============================================================================\n// HELPER FUNCTIONS\n// ============================================================================\n\n/**\n * Get all permissions for a list of roles.\n *\n * @param roles - Array of role names (e.g., ['LECTURER', 'DATA_OPERATOR'])\n * @returns Array of unique permissions\n *\n * @example\n * const permissions = getUserPermissions(['LECTURER']);\n * // Returns: ['OWN_SCHEDULE_READ', 'SLOT_SESSION_START', ...]\n */\nexport function getUserPermissions(roles: string[]): Permission[] {\n  const permissionSet = new Set<Permission>();\n\n  roles.forEach(role => {\n    const rolePerms = ROLE_PERMISSIONS[role];\n    if (rolePerms) {\n      rolePerms.forEach(perm => permissionSet.add(perm));\n    }\n  });\n\n  return Array.from(permissionSet);\n}\n\n/**\n * Check if user has a specific permission based on their roles.\n *\n * @param roles - Array of role names\n * @param permission - Permission to check\n * @returns True if user has the permission\n *\n * @example\n * hasPermission(['LECTURER'], 'SLOT_SESSION_START') // true\n * hasPermission(['STUDENT'], 'SLOT_SESSION_START') // false\n */\nexport function hasPermission(roles: string[], permission: Permission): boolean {\n  return roles.some(role => {\n    const rolePerms = ROLE_PERMISSIONS[role];\n    return rolePerms?.includes(permission) ?? false;\n  });\n}\n\n/**\n * Check if user has ANY of the specified permissions.\n *\n * @param roles - Array of role names\n * @param permissions - Array of permissions to check\n * @returns True if user has at least one of the permissions\n *\n * @example\n * hasAnyPermission(['LECTURER'], ['SLOT_SESSION_START', 'USER_CREATE'])\n * // Returns: true (has SLOT_SESSION_START)\n */\nexport function hasAnyPermission(roles: string[], permissions: Permission[]): boolean {\n  return permissions.some(permission => hasPermission(roles, permission));\n}\n\n/**\n * Check if user has ALL of the specified permissions.\n *\n * @param roles - Array of role names\n * @param permissions - Array of permissions to check\n * @returns True if user has all of the permissions\n *\n * @example\n * hasAllPermissions(['DATA_OPERATOR'], ['USER_CREATE', 'USER_READ_LIST'])\n * // Returns: true\n */\nexport function hasAllPermissions(roles: string[], permissions: Permission[]): boolean {\n  return permissions.every(permission => hasPermission(roles, permission));\n}\n\n// ============================================================================\n// REACT HOOKS (Client-side only)\n// ============================================================================\n\n/**\n * React hook to check if current user has a specific permission.\n *\n * @param permission - Permission to check\n * @returns True if user has the permission, false otherwise\n *\n * @example\n * function CreateUserButton() {\n *   const canCreate = useHasPermission('USER_CREATE');\n *\n *   if (!canCreate) return null;\n *\n *   return <button>Create User</button>;\n * }\n */\nexport function useHasPermission(permission: Permission): boolean {\n  const [roles, setRoles] = useState<string[]>([]);\n\n  useEffect(() => {\n    const user = getAuthUser();\n    setRoles(user?.roles ?? []);\n  }, []);\n\n  return useMemo(() => {\n    return hasPermission(roles, permission);\n  }, [roles, permission]);\n}\n\n/**\n * React hook to get all permissions for the current user.\n *\n * @returns Array of user's permissions\n *\n * @example\n * function UserPermissionsList() {\n *   const permissions = useUserPermissions();\n *\n *   return (\n *     <ul>\n *       {permissions.map(perm => <li key={perm}>{perm}</li>)}\n *     </ul>\n *   );\n * }\n */\nexport function useUserPermissions(): Permission[] {\n  const [roles, setRoles] = useState<string[]>([]);\n\n  useEffect(() => {\n    const user = getAuthUser();\n    setRoles(user?.roles ?? []);\n  }, []);\n\n  return useMemo(() => {\n    return getUserPermissions(roles);\n  }, [roles]);\n}\n\n/**\n * React hook that returns permission checking functions.\n *\n * @returns Object with permission checking functions\n *\n * @example\n * function ActionButtons() {\n *   const { can, canAny, canAll } = usePermissionChecker();\n *\n *   return (\n *     <div>\n *       {can('USER_CREATE') && <CreateButton />}\n *       {canAny(['USER_UPDATE_INFO', 'USER_UPDATE_STATUS']) && <EditButton />}\n *       {canAll(['USER_READ_LIST', 'USER_READ_DETAIL']) && <ViewButton />}\n *     </div>\n *   );\n * }\n */\nexport function usePermissionChecker() {\n  const [roles, setRoles] = useState<string[]>([]);\n\n  useEffect(() => {\n    const user = getAuthUser();\n    setRoles(user?.roles ?? []);\n  }, []);\n\n  return useMemo(() => {\n    return {\n      /**\n       * Check if user has a specific permission\n       */\n      can: (permission: Permission) => hasPermission(roles, permission),\n\n      /**\n       * Check if user has any of the specified permissions\n       */\n      canAny: (permissions: Permission[]) => hasAnyPermission(roles, permissions),\n\n      /**\n       * Check if user has all of the specified permissions\n       */\n      canAll: (permissions: Permission[]) => hasAllPermissions(roles, permissions),\n\n      /**\n       * Get all user permissions\n       */\n      getPermissions: () => getUserPermissions(roles),\n    };\n  }, [roles]);\n}\n"
    },
    {
      "path": "D:\\Work\\do_an_fall25\\fuacs\\frontend-web\\lib\\role-permissions.ts",
      "relative_path": "lib/role-permissions.ts",
      "filename": "role-permissions.ts",
      "size_bytes": 3242,
      "lines": 127,
      "last_modified": "2025-11-01T16:30:11.779238",
      "encoding": "utf-8",
      "language": "typescript",
      "content": "import { getAuthUser } from \"./auth\";\n\n/**\n * Role-based permission utilities\n */\n\n// Define role hierarchies and permissions\nexport const ROLE_PERMISSIONS = {\n  // Admin roles have access to admin portal\n  ADMIN: [\"DATA_OPERATOR\"],\n  \n  // Teaching staff roles\n  LECTURER: [\"LECTURER\"],\n  SUPERVISOR: [\"SUPERVISOR\"],\n  \n  // Student role\n  STUDENT: [\"STUDENT\"],\n} as const;\n\n// Route patterns for each role group\nexport const ROLE_ROUTES = {\n  admin: [\"/admin\"],\n  lecturer: [\"/lecturer\"],\n  supervisor: [\"/supervisor\"],\n  student: [\"/student\"],\n} as const;\n\n/**\n * Check if user has any of the specified roles\n */\nexport function hasAnyRole(requiredRoles: string[]): boolean {\n  const user = getAuthUser();\n  if (!user) return false;\n  \n  return requiredRoles.some(role => user.roles.includes(role));\n}\n\n/**\n * Check if user has specific role\n */\nexport function hasRole(role: string): boolean {\n  const user = getAuthUser();\n  if (!user) return false;\n  \n  return user.roles.includes(role);\n}\n\n/**\n * Check if user can access a specific route pattern\n */\nexport function canAccessRoute(routePattern: string): boolean {\n  const user = getAuthUser();\n  if (!user) return false;\n\n  // Check admin routes\n  if (routePattern.startsWith(\"/admin\")) {\n    return hasAnyRole([...ROLE_PERMISSIONS.ADMIN]);\n  }\n\n  // Check lecturer routes\n  if (routePattern.startsWith(\"/lecturer\")) {\n    return hasAnyRole([...ROLE_PERMISSIONS.LECTURER]);\n  }\n\n  // Check supervisor routes\n  if (routePattern.startsWith(\"/supervisor\")) {\n    return hasAnyRole([...ROLE_PERMISSIONS.SUPERVISOR]);\n  }\n\n  // Check student routes\n  if (routePattern.startsWith(\"/student\")) {\n    return hasAnyRole([...ROLE_PERMISSIONS.STUDENT]);\n  }\n\n  // Default: allow access to public routes\n  return true;\n}\n\n/**\n * Get user's primary role (for display purposes)\n */\nexport function getPrimaryRole(): string | null {\n  const user = getAuthUser();\n  if (!user) return null;\n\n  // Priority order: LECTURER > SUPERVISOR > STUDENT > ADMIN\n  if (user.roles.includes(\"LECTURER\")) return \"LECTURER\";\n  if (user.roles.includes(\"SUPERVISOR\")) return \"SUPERVISOR\";\n  if (user.roles.includes(\"STUDENT\")) return \"STUDENT\";\n  if (user.roles.includes(\"DATA_OPERATOR\")) return \"DATA_OPERATOR\";\n\n  return user.roles[0] || null;\n}\n\n/**\n * Get all accessible routes for current user\n */\nexport function getAccessibleRoutes(): string[] {\n  const user = getAuthUser();\n  if (!user) return [];\n\n  const accessibleRoutes: string[] = [];\n\n  // Check each route type\n  if (hasAnyRole([...ROLE_PERMISSIONS.ADMIN])) {\n    accessibleRoutes.push(\"/admin\");\n  }\n  if (hasAnyRole([...ROLE_PERMISSIONS.LECTURER])) {\n    accessibleRoutes.push(\"/lecturer\");\n  }\n  if (hasAnyRole([...ROLE_PERMISSIONS.SUPERVISOR])) {\n    accessibleRoutes.push(\"/supervisor\");\n  }\n  if (hasAnyRole([...ROLE_PERMISSIONS.STUDENT])) {\n    accessibleRoutes.push(\"/student\");\n  }\n\n  return accessibleRoutes;\n}\n\n/**\n * Check if user has multiple roles (for role switching UI)\n */\nexport function hasMultipleRoles(): boolean {\n  const accessibleRoutes = getAccessibleRoutes();\n  return accessibleRoutes.length > 1;\n}"
    },
    {
      "path": "D:\\Work\\do_an_fall25\\fuacs\\frontend-web\\lib\\slot-utils.ts",
      "relative_path": "lib/slot-utils.ts",
      "filename": "slot-utils.ts",
      "size_bytes": 2388,
      "lines": 77,
      "last_modified": "2025-11-14T23:40:52.550795",
      "encoding": "utf-8",
      "language": "typescript",
      "content": "import { Slot } from \"@/types\";\n\n/**\n * Display data extracted from a Slot for UI rendering\n */\nexport interface SlotDisplayData {\n  subjectCode: string;\n  subjectName: string;\n  roomName: string;\n  staffName: string;\n  categoryLabel: \"Lecture\" | \"Lecture with PT\" | \"Exam\";\n  slotCategory: \"LECTURE\" | \"LECTURE_WITH_PT\" | \"FINAL_EXAM\";\n}\n\n/**\n * Extract display data from a Slot object\n * Handles different slot types (LECTURE with class, FINAL_EXAM with subjects)\n *\n * @param slot - The slot object to extract data from\n * @returns SlotDisplayData with normalized display values\n */\nexport function getSlotDisplayData(slot: Slot): SlotDisplayData {\n  // For LECTURE/LECTURE_WITH_PT: Use class.subject\n  // For FINAL_EXAM: Use subjects array (no class)\n  // Fallback: Use slot title or \"N/A\" / \"Untitled Slot\"\n  const subjectCode =\n    slot.class?.subject.code ||\n    slot.subjects?.[0]?.code ||\n    (slot.slotCategory === \"FINAL_EXAM\" ? \"EXAM\" : \"N/A\");\n\n  const subjectName =\n    slot.class?.subject.name ||\n    slot.subjects?.[0]?.name ||\n    slot.title ||\n    (slot.slotCategory === \"FINAL_EXAM\" ? \"Final Exam\" : \"Untitled Slot\");\n\n  // Category label mapping\n  const categoryLabel =\n    slot.slotCategory === \"LECTURE\" ? \"Lecture\" as const :\n    slot.slotCategory === \"LECTURE_WITH_PT\" ? \"Lecture with PT\" as const :\n    \"Exam\" as const;\n\n  return {\n    subjectCode,\n    subjectName,\n    roomName: slot.room.name,\n    staffName: slot.staffUser?.fullName || \"Unknown\",\n    categoryLabel,\n    slotCategory: slot.slotCategory,\n  };\n}\n\n/**\n * Get CSS class names for slot category styling\n * Uses consistent colors across the app\n */\nexport function getSlotCategoryStyles(category: \"LECTURE\" | \"LECTURE_WITH_PT\" | \"FINAL_EXAM\") {\n  const styles = {\n    LECTURE: {\n      border: \"border-l-blue-500 dark:border-l-blue-400\",\n      bg: \"bg-blue-50 dark:bg-blue-950\",\n      text: \"text-blue-800 dark:text-blue-200\",\n    },\n    LECTURE_WITH_PT: {\n      border: \"border-l-purple-500 dark:border-l-purple-400\",\n      bg: \"bg-purple-50 dark:bg-purple-950\",\n      text: \"text-purple-800 dark:text-purple-200\",\n    },\n    FINAL_EXAM: {\n      border: \"border-l-red-500 dark:border-l-red-400\",\n      bg: \"bg-red-50 dark:bg-red-950\",\n      text: \"text-red-800 dark:text-red-200\",\n    },\n  };\n\n  return styles[category];\n}\n"
    },
    {
      "path": "D:\\Work\\do_an_fall25\\fuacs\\frontend-web\\lib\\timezone-utils.ts",
      "relative_path": "lib/timezone-utils.ts",
      "filename": "timezone-utils.ts",
      "size_bytes": 7166,
      "lines": 214,
      "last_modified": "2025-11-09T20:23:57.412912",
      "encoding": "utf-8",
      "language": "typescript",
      "content": "/**\n * Timezone Utilities for FUACS Frontend\n *\n * FUACS uses Asia/Ho_Chi_Minh timezone throughout the entire system:\n * - Backend (Java Spring Boot) sends timestamps in Vietnam time (no Z suffix)\n * - Recognition Service (Python FastAPI) uses Vietnam time\n * - Database stores timestamps as Vietnam local time\n *\n * This utility ensures frontend correctly interprets and sends timestamps\n * regardless of the user's browser timezone.\n */\n\nimport { toZonedTime, fromZonedTime, formatInTimeZone } from 'date-fns-tz';\n\n/**\n * Vietnam timezone constant\n */\nexport const VN_TIMEZONE = 'Asia/Ho_Chi_Minh';\n\n/**\n * Parse a timestamp from backend as Vietnam time\n *\n * Backend sends timestamps like \"2024-12-31T14:30:00\" (no Z suffix)\n * without explicit timezone info. We must interpret these AS Vietnam time,\n * not as browser's local time.\n *\n * @param isoString - ISO timestamp without timezone (e.g., \"2024-12-31T14:30:00\")\n * @returns Date object representing that time in Vietnam timezone\n *\n * @example\n * // Backend sends: \"2024-12-31T14:30:00\"\n * const date = parseVietnamTime(\"2024-12-31T14:30:00\");\n * // date now represents 2:30 PM Vietnam time, correctly converted to user's browser\n */\nexport function parseVietnamTime(isoString: string): Date {\n  // Remove any existing 'Z' suffix if present (shouldn't be there from backend)\n  const cleanString = isoString.replace(/Z$/, '');\n\n  // fromZonedTime interprets the string AS Vietnam time and converts to Date\n  return fromZonedTime(cleanString, VN_TIMEZONE);\n}\n\n/**\n * Format a Date object as Vietnam time ISO string for backend submission\n *\n * Converts browser's Date object to Vietnam timezone and formats it\n * without timezone suffix (format backend expects).\n *\n * @param date - Date object (from user input, form, etc.)\n * @returns ISO string in Vietnam time (e.g., \"2024-12-31T14:30:00\")\n *\n * @example\n * // User in US (UTC-5) selects 2:30 PM in date picker\n * const userDate = new Date(2024, 11, 31, 14, 30);\n * const vnTimeString = formatAsVietnamTime(userDate);\n * // vnTimeString = \"2024-12-31T14:30:00\" (converted to Vietnam time)\n */\nexport function formatAsVietnamTime(date: Date): string {\n  return formatInTimeZone(date, VN_TIMEZONE, \"yyyy-MM-dd'T'HH:mm:ss\");\n}\n\n/**\n * Get current time in Vietnam timezone\n *\n * @returns Date object representing current Vietnam time\n *\n * @example\n * const nowInVietnam = getVietnamNow();\n */\nexport function getVietnamNow(): Date {\n  return toZonedTime(new Date(), VN_TIMEZONE);\n}\n\n/**\n * Get end-of-day (23:59:59) for a given date in Vietnam timezone\n *\n * Used for permission window calculations where edit rights expire\n * at 23:59:59 Vietnam time of the slot date.\n *\n * @param date - Date object to calculate end-of-day for\n * @returns Date object representing 23:59:59 of that date in Vietnam timezone\n *\n * @example\n * // Slot starts: \"2024-12-31T14:30:00\" (Vietnam time)\n * const slotDate = parseVietnamTime(\"2024-12-31T14:30:00\");\n * const cutoff = getVietnamEndOfDay(slotDate);\n * // cutoff = 2024-12-31 23:59:59 in Vietnam timezone\n * const canEdit = getVietnamNow() < cutoff;\n */\nexport function getVietnamEndOfDay(date: Date): Date {\n  // Convert date to Vietnam timezone\n  const vnDate = toZonedTime(date, VN_TIMEZONE);\n\n  // Get date string in Vietnam timezone (YYYY-MM-DD)\n  const dateString = formatInTimeZone(vnDate, VN_TIMEZONE, 'yyyy-MM-dd');\n\n  // Create end-of-day timestamp (23:59:59)\n  const endOfDayString = `${dateString}T23:59:59`;\n\n  // Parse as Vietnam time\n  return fromZonedTime(endOfDayString, VN_TIMEZONE);\n}\n\n/**\n * Get start-of-day (00:00:00) for a given date in Vietnam timezone\n *\n * @param date - Date object to calculate start-of-day for\n * @returns Date object representing 00:00:00 of that date in Vietnam timezone\n *\n * @example\n * const vnDate = parseVietnamTime(\"2024-12-31T14:30:00\");\n * const startOfDay = getVietnamStartOfDay(vnDate);\n * // startOfDay = 2024-12-31 00:00:00 in Vietnam timezone\n */\nexport function getVietnamStartOfDay(date: Date): Date {\n  // Convert date to Vietnam timezone\n  const vnDate = toZonedTime(date, VN_TIMEZONE);\n\n  // Get date string in Vietnam timezone (YYYY-MM-DD)\n  const dateString = formatInTimeZone(vnDate, VN_TIMEZONE, 'yyyy-MM-dd');\n\n  // Create start-of-day timestamp (00:00:00)\n  const startOfDayString = `${dateString}T00:00:00`;\n\n  // Parse as Vietnam time\n  return fromZonedTime(startOfDayString, VN_TIMEZONE);\n}\n\n/**\n * Format a date for display to users in Vietnam timezone\n *\n * @param date - Date object to format\n * @param formatString - date-fns format string (default: \"PPpp\")\n * @returns Formatted string in Vietnam timezone\n *\n * @example\n * const date = parseVietnamTime(\"2024-12-31T14:30:00\");\n * const display = formatVietnamTime(date, \"HH:mm\");\n * // display = \"14:30\"\n */\nexport function formatVietnamTime(date: Date, formatString: string = 'PPpp'): string {\n  return formatInTimeZone(date, VN_TIMEZONE, formatString);\n}\n\n/**\n * Get hours (0-23) in Vietnam timezone\n *\n * Used for calendar positioning calculations where we need to know\n * what hour it is in Vietnam time regardless of browser timezone.\n *\n * @param date - Date object\n * @returns Hour in Vietnam timezone (0-23)\n *\n * @example\n * const slotTime = parseVietnamTime(\"2024-12-31T14:30:00\");\n * const vnHour = getVietnamHours(slotTime);\n * // vnHour = 14 (always 14, regardless of user's browser timezone)\n */\nexport function getVietnamHours(date: Date): number {\n  const vnDate = toZonedTime(date, VN_TIMEZONE);\n  return vnDate.getHours();\n}\n\n/**\n * Get minutes (0-59) in Vietnam timezone\n *\n * @param date - Date object\n * @returns Minutes in Vietnam timezone (0-59)\n */\nexport function getVietnamMinutes(date: Date): number {\n  const vnDate = toZonedTime(date, VN_TIMEZONE);\n  return vnDate.getMinutes();\n}\n\n/**\n * Get the Vietnam date (YYYY-MM-DD) from a Date object\n *\n * Important: The same instant in time can have different dates\n * depending on timezone. For example:\n * - 2024-12-31 23:00 UTC = 2025-01-01 06:00 Vietnam time\n *\n * @param date - Date object\n * @returns Date string in Vietnam timezone (YYYY-MM-DD)\n *\n * @example\n * const date = new Date(\"2024-12-31T23:00:00Z\"); // UTC time\n * const vnDate = getVietnamDate(date);\n * // vnDate = \"2025-01-01\" (next day in Vietnam)\n */\nexport function getVietnamDate(date: Date): string {\n  return formatInTimeZone(date, VN_TIMEZONE, 'yyyy-MM-dd');\n}\n\n/**\n * Check if a date is in the past (compared to current Vietnam time)\n *\n * @param date - Date to check\n * @returns true if date is before current Vietnam time\n */\nexport function isBeforeNowInVietnam(date: Date): boolean {\n  const now = getVietnamNow();\n  return date < now;\n}\n\n/**\n * Check if a date is in the future (compared to current Vietnam time)\n *\n * @param date - Date to check\n * @returns true if date is after current Vietnam time\n */\nexport function isAfterNowInVietnam(date: Date): boolean {\n  const now = getVietnamNow();\n  return date > now;\n}\n"
    },
    {
      "path": "D:\\Work\\do_an_fall25\\fuacs\\frontend-web\\lib\\utils.ts",
      "relative_path": "lib/utils.ts",
      "filename": "utils.ts",
      "size_bytes": 6314,
      "lines": 194,
      "last_modified": "2025-11-20T23:58:46.304717",
      "encoding": "utf-8",
      "language": "typescript",
      "content": "import { clsx, type ClassValue } from \"clsx\";\nimport { twMerge } from \"tailwind-merge\";\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n\nimport type { Slot } from \"@/types\";\nimport {\n  parseVietnamTime,\n  formatVietnamTime,\n  getVietnamNow,\n  getVietnamEndOfDay,\n} from \"./timezone-utils\";\n\nexport const formatSlotTime = (startTime: string, endTime: string) => {\n  const start = parseVietnamTime(startTime);\n  const end = parseVietnamTime(endTime);\n  // Backend sends Vietnam time (no Z suffix), parse and display as Vietnam time\n  return `${formatVietnamTime(start, \"MMM d, h:mm a\")} - ${formatVietnamTime(end, \"h:mm a\")}`;\n};\n\nexport const canDeleteSlot = (slot: Slot) => {\n  const now = getVietnamNow();\n  const slotStart = parseVietnamTime(slot.startTime);\n  // Can delete if slot has not started yet (Vietnam timezone)\n  return now.getTime() < slotStart.getTime();\n};\n\nexport const getSlotCategoryColor = (category: string) => {\n  const colors = {\n    LECTURE: \"default\",\n    LECTURE_WITH_PT: \"secondary\",\n    FINAL_EXAM: \"destructive\",\n  };\n  return colors[category as keyof typeof colors] || \"default\";\n};\n\n/**\n * Get time range status for slot attendance operations.\n *\n * CRITICAL: Uses Vietnam timezone for all calculations to match backend logic.\n * Edit window expires at 23:59:59 Vietnam time of the slot date.\n *\n * - \"before_start\": Current time is before slot start time\n * - \"active\": Current time is within slot time (start -> end)\n * - \"edit_window\": After slot end but before 23:59:59 of slot date (Vietnam time)\n * - \"expired\": After 23:59:59 of slot date (Vietnam time)\n */\nexport const getSlotTimeRangeStatus = (\n  slot: Slot\n): \"before_start\" | \"active\" | \"edit_window\" | \"expired\" => {\n  const now = getVietnamNow();\n  const slotStart = parseVietnamTime(slot.startTime);\n  const slotEnd = parseVietnamTime(slot.endTime);\n\n  // Compare using timestamps (milliseconds since epoch)\n  const nowTime = now.getTime();\n  const startTime = slotStart.getTime();\n  const endTime = slotEnd.getTime();\n\n  // CRITICAL: Get end of day (23:59:59) in VIETNAM timezone for slot date\n  // This ensures edit window cutoff matches backend permission logic\n  const endOfDay = getVietnamEndOfDay(slotStart);\n  const endOfDayTime = endOfDay.getTime();\n\n  if (nowTime < startTime) {\n    return \"before_start\";\n  }\n\n  if (nowTime >= startTime && nowTime <= endTime) {\n    return \"active\";\n  }\n\n  if (nowTime > endTime && nowTime <= endOfDayTime) {\n    return \"edit_window\";\n  }\n\n  return \"expired\";\n};\n\n/**\n * Check if can start face recognition session.\n * Only allowed during active slot time (startTime -> endTime).\n */\nexport const canStartSession = (slot: Slot): boolean => {\n  return getSlotTimeRangeStatus(slot) === \"active\";\n};\n\n/**\n * Check if can edit attendance manually.\n * Allowed from startTime until 23:59:59 of slot date.\n */\nexport const canEditAttendance = (slot: Slot): boolean => {\n  const status = getSlotTimeRangeStatus(slot);\n  return status === \"active\" || status === \"edit_window\";\n};\n\n/**\n * Check if can edit attendance based on user role.\n * - DATA_OPERATOR: Can only edit after 23:59:59 (expired status)\n * - LECTURER/SUPERVISOR: Can edit during active and edit_window (startTime to 23:59:59)\n */\nexport const canEditAttendanceForRole = (\n  slot: Slot,\n  userRole?: string\n): boolean => {\n  const status = getSlotTimeRangeStatus(slot);\n\n  // Data Operator: only after 23:59:59\n  if (userRole === \"DATA_OPERATOR\") {\n    return status === \"expired\";\n  }\n\n  // Lecturer/Supervisor: during active and edit_window\n  return status === \"active\" || status === \"edit_window\";\n};\n\n/**\n * Check if current date is within semester enrollment period.\n * Enrollment allowed when: currentDate < semester.endDate (end of day in Vietnam timezone)\n *\n * @param semester Semester object with startDate and endDate (ISO 8601 strings)\n * @returns true if enrollments can be modified, false otherwise\n */\nexport const canModifyEnrollments = (semester?: {\n  startDate?: string | null;\n  endDate?: string | null;\n}): boolean => {\n  if (!semester || !semester.endDate) {\n    return false;\n  }\n\n  const now = getVietnamNow();\n  const endDate = parseVietnamTime(semester.endDate);\n  const endOfDay = getVietnamEndOfDay(endDate); // 23:59:59 on endDate\n\n  return now < endOfDay;\n};\n\n/**\n * Convert evidence or photo URL to absolute URL.\n * Handles both evidence URLs and photo URLs.\n *\n * @param url - Relative or absolute URL (e.g., \"/evidence/123.jpg\" or \"/student-photos/456.jpg\")\n * @returns Full absolute URL or null if input is invalid\n */\nexport function evidenceToAbsoluteUrl(url: string | null | undefined): string | null {\n  if (!url) {\n    return null;\n  }\n\n  // If already absolute URL, return as-is\n  if (url.startsWith(\"http://\") || url.startsWith(\"https://\")) {\n    return url;\n  }\n\n  const apiUrl = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:8080/api/v1\";\n  const baseUrl = apiUrl.replace(/\\/api\\/v1$/, \"\");\n\n  let cleanPath = url;\n\n  // Handle evidence paths\n  if (cleanPath.match(/^\\/evidence\\/(regular|exam)\\//)) {\n    cleanPath = cleanPath.replace(\"/evidence/\", \"/evidence/legacy/\");\n  } else if (cleanPath.startsWith(\"/uploads/evidence/\")) {\n    cleanPath = cleanPath.replace(\"/uploads/evidence/\", \"/evidence/\");\n  }\n  // Handle student photo paths\n  else if (cleanPath.startsWith(\"/student-photos/\")) {\n    // Keep as-is\n  }\n  // Handle /api/v1 prefix\n  else if (cleanPath.startsWith(\"/api/v1/\")) {\n    return `${baseUrl}${cleanPath}`;\n  }\n\n  // Ensure path starts with /\n  cleanPath = cleanPath.startsWith(\"/\") ? cleanPath : `/${cleanPath}`;\n\n  return `${baseUrl}/api/v1${cleanPath}`;\n}\n\n/**\n * Convert media or evidence URL to absolute URL (generic handler).\n * Handles regularImageUrl, examImageUrl, or any evidence/media path.\n *\n * @param url - Relative or absolute URL from SSE events or API responses\n * @returns Full absolute URL or null if input is invalid\n */\nexport function toAbsoluteMediaOrEvidenceUrl(url: string | null | undefined): string | null {\n  // Reuse the same logic as evidenceToAbsoluteUrl\n  return evidenceToAbsoluteUrl(url);\n}\n"
    },
    {
      "path": "D:\\Work\\do_an_fall25\\fuacs\\frontend-web\\lib\\zod-schemas.ts",
      "relative_path": "lib/zod-schemas.ts",
      "filename": "zod-schemas.ts",
      "size_bytes": 60332,
      "lines": 2117,
      "last_modified": "2025-11-21T20:36:28.336508",
      "encoding": "utf-8",
      "language": "typescript",
      "content": "import { z } from \"zod\";\n\nconst usernameSchema = z\n  .string()\n  .min(1, \"Username is required\")\n  .max(50, \"Username must be at most 50 characters\")\n  .regex(/^[a-zA-Z0-9]+$/, \"Username must be alphanumeric\");\n\nconst passwordSchema = z\n  .string()\n  .min(1, \"Password is required\")\n  .max(100, \"Password must be at most 100 characters\");\n\n// Permission schemas\nexport const permissionSchema = z.object({\n  id: z.number(),\n  name: z.string(),\n  isActive: z.boolean(),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n});\n\nexport const permissionsResponseSchema = z.array(permissionSchema);\n\nexport const paginatedPermissionResponseSchema = z.object({\n  items: z.array(permissionSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\nexport const createPermissionPayloadSchema = z.object({\n  name: z\n    .string()\n    .min(1, \"Name is required\")\n    .max(255, \"Name must be at most 255 characters\"),\n});\n\nexport const updatePermissionPayloadSchema = z.object({\n  name: z\n    .string()\n    .min(1, \"Name is required\")\n    .max(255, \"Name must be at most 255 characters\"),\n  isActive: z.boolean(),\n});\n\nconst roleCoreSchema = z.object({\n  id: z.number(),\n  name: z.string(),\n  isActive: z.boolean(),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n  permissions: permissionsResponseSchema.optional(),\n});\n\nexport const roleSchema = roleCoreSchema;\nexport const rolesResponseSchema = z.array(roleSchema);\n\nconst tokenResponseBaseSchema = z.object({\n  accessToken: z.string().min(1, \"accessToken is required\"),\n  tokenType: z.string().min(1, \"tokenType is required\"),\n  fullName: z.string().min(1, \"fullName is required\"),\n  username: usernameSchema,\n  roles: z.array(z.string()).nonempty(),\n  userId: z.number().int().positive(),\n  refreshToken: z.string().min(1, \"refreshToken is required\").optional(),\n});\n\nexport const loginRequestSchema = z.object({\n  username: usernameSchema,\n  password: passwordSchema,\n});\n\nexport const loginResponseSchema = tokenResponseBaseSchema;\n\nexport const refreshTokenRequestSchema = z.object({\n  refreshToken: z.string().min(1, \"refreshToken is required\"),\n});\n\nexport const refreshTokenResponseSchema = tokenResponseBaseSchema;\n\nexport const logoutResponseSchema = z.object({\n  success: z.boolean().optional(),\n  message: z.string().optional(),\n});\n\nexport const googleLoginRequestSchema = z.object({\n  token: z.string().min(1, \"token is required\"),\n});\n\nexport const semesterSchema = z.object({\n  id: z.number(),\n  name: z.string(),\n  code: z.string(),\n  startDate: z.string(),\n  endDate: z.string(),\n  isActive: z.boolean(),\n  // Tolerate missing/null and coerce to 0 for resilience on create responses\n  totalClass: z\n    .number()\n    .nullish()\n    .transform((v) => v ?? 0),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n});\n\nexport const semestersResponseSchema = z.array(semesterSchema);\n\nexport const paginatedSemesterResponseSchema = z.object({\n  items: z.array(semesterSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\nexport const createSemesterPayloadSchema = z.object({\n  name: z\n    .string()\n    .min(1, \"Name is required\")\n    .max(20, \"Name must be at most 20 characters\")\n    .regex(\n      /^[A-Za-z0-9]+( [A-Za-z0-9]+)*$/,\n      \"Name must contain only letters, digits, and single spaces between words (no leading/trailing spaces)\"\n    ),\n  code: z\n    .string()\n    .min(1, \"Code is required\")\n    .max(10, \"Code must be at most 10 characters\")\n    .regex(\n      /^[A-Za-z0-9]+$/,\n      \"Code must contain only letters and digits (no spaces)\"\n    ),\n  startDate: z.string().min(1, \"Start date is required\"),\n  endDate: z.string().min(1, \"End date is required\"),\n});\n\nexport const updateSemesterPayloadSchema = z.object({\n  name: z\n    .string()\n    .min(1, \"Name cannot be empty\")\n    .max(20, \"Name must be at most 20 characters\")\n    .regex(\n      /^[A-Za-z0-9]+( [A-Za-z0-9]+)*$/,\n      \"Name must contain only letters, digits, and single spaces between words (no leading/trailing spaces)\"\n    ),\n  code: z\n    .string()\n    .min(1, \"Code cannot be empty\")\n    .max(10, \"Code must be at most 10 characters\")\n    .regex(\n      /^[A-Za-z0-9]+$/,\n      \"Code must contain only letters and digits (no spaces)\"\n    ),\n  startDate: z.string(),\n  endDate: z.string(),\n  isActive: z.boolean(),\n});\n\n// Semester Import Schemas\nexport const importSemesterErrorSchema = z.object({\n  rowNumber: z.number(),\n  errorCode: z.string(),\n  message: z.string(),\n});\n\nexport const importSemestersResponseSchema = z.object({\n  errors: z.array(importSemesterErrorSchema),\n});\n\n// Semester Subjects Response Schema\nexport const semesterSubjectSchema = z.object({\n  id: z.number(),\n  name: z.string(),\n  code: z.string(),\n  majors: z.array(\n    z.object({\n      id: z.number(),\n      name: z.string(),\n      code: z.string(),\n      isActive: z.boolean(),\n    })\n  ),\n  totalClassInSemester: z.number(),\n  totalActiveClassInSemester: z.number(),\n  isActive: z.boolean(),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n});\n\nexport const paginatedSemesterSubjectResponseSchema = z.object({\n  items: z.array(semesterSubjectSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\n// Semester Students Response Schema\nexport const semesterStudentEnrolledSubjectSchema = z.object({\n  subjectId: z.number(),\n  subjectCode: z.string(),\n  subjectName: z.string(),\n});\n\nexport const semesterStudentSchema = z.object({\n  userId: z.number(),\n  fullName: z.string(),\n  email: z.string(),\n  rollNumber: z.string(),\n  major: z.object({\n    id: z.number(),\n    name: z.string(),\n    code: z.string(),\n    isActive: z.boolean(),\n  }),\n  isActive: z.boolean(),\n  totalEnrollmentsInSemester: z.number(),\n  activeEnrollmentsInSemester: z.number(),\n  enrolledSubjects: z.array(semesterStudentEnrolledSubjectSchema),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n});\n\nexport const paginatedSemesterStudentResponseSchema = z.object({\n  semester: z.object({\n    id: z.number(),\n    name: z.string(),\n    code: z.string(),\n  }),\n  items: z.array(semesterStudentSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\n// Semester Classes Response Schema\nexport const semesterClassSchema = z.object({\n  id: z.number(),\n  code: z.string(),\n  subject: z.object({\n    id: z.number(),\n    name: z.string(),\n    code: z.string(),\n  }),\n  isActive: z.boolean(),\n  totalStudents: z.number(),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n});\n\nexport const paginatedSemesterClassResponseSchema = z.object({\n  items: z.array(semesterClassSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\n// Major Schemas\nexport const majorSchema = z.object({\n  id: z.number(),\n  name: z.string(),\n  code: z.string(),\n  isActive: z.boolean(),\n  // Tolerate missing/null and coerce to 0 for resilience on create responses\n  totalSubject: z\n    .number()\n    .nullish()\n    .transform((v) => v ?? 0),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n});\n\nexport const majorsResponseSchema = z.array(majorSchema);\n\nexport const paginatedMajorResponseSchema = z.object({\n  items: z.array(majorSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\nexport const createMajorPayloadSchema = z.object({\n  name: z\n    .string()\n    .min(1, \"Name is required\")\n    .max(150, \"Name must be at most 150 characters\")\n    .regex(\n      /^[A-Za-z0-9&-]+( [A-Za-z0-9&-]+)*$/,\n      \"Name must contain only letters, digits, spaces, & and - (no leading/trailing/multiple spaces)\"\n    ),\n  code: z\n    .string()\n    .min(1, \"Code is required\")\n    .max(20, \"Code must be at most 20 characters\")\n    .regex(\n      /^[A-Za-z0-9]+$/,\n      \"Code must contain only letters and digits (no spaces)\"\n    ),\n});\n\nexport const updateMajorPayloadSchema = z.object({\n  name: z\n    .string()\n    .min(1, \"Name cannot be empty\")\n    .max(150, \"Name must be at most 150 characters\")\n    .regex(\n      /^[A-Za-z0-9&-]+( [A-Za-z0-9&-]+)*$/,\n      \"Name must contain only letters, digits, spaces, & and - (no leading/trailing/multiple spaces)\"\n    ),\n  code: z\n    .string()\n    .min(1, \"Code cannot be empty\")\n    .max(20, \"Code must be at most 20 characters\")\n    .regex(\n      /^[A-Za-z0-9]+$/,\n      \"Code must contain only letters and digits (no spaces)\"\n    ),\n  isActive: z.boolean(),\n});\n\n// Major Import Schemas\nexport const importMajorErrorSchema = z.object({\n  rowNumber: z.number(),\n  errorCode: z.string(),\n  message: z.string(),\n});\n\nexport const importMajorsResponseSchema = z.object({\n  errors: z.array(importMajorErrorSchema),\n});\n\n// TODO: Nested GET /majors/{id}/subjects\n// Removed dedicated nested response schema because UI navigates to the generic\n// Subjects page filtered by majorId. Reintroduce a paginated schema if we add\n// an inline subjects-by-major view in the future.\n\n// Role Management Schemas (for CRUD operations)\nexport const paginatedRoleResponseSchema = z.object({\n  items: z.array(roleSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\nexport const createRolePayloadSchema = z.object({\n  name: z\n    .string()\n    .min(1, \"Name is required\")\n    .max(100, \"Name must be at most 100 characters\"),\n  permissionIds: z.array(z.number()).optional().default([]),\n});\n\nexport const updateRolePayloadSchema = z.object({\n  name: z\n    .string()\n    .min(1, \"Name is required\")\n    .max(100, \"Name must be at most 100 characters\"),\n  permissionIds: z.array(z.number()).optional().default([]),\n  isActive: z.boolean(),\n});\n\n// Subject Schemas\nexport const subjectSchema = z.object({\n  id: z.number(),\n  name: z.string(),\n  code: z.string(),\n  majors: z.array(\n    z.object({\n      id: z.number(),\n      name: z.string(),\n      code: z.string(),\n      isActive: z.boolean(),\n    })\n  ),\n  // Tolerate missing/null and coerce to 0 for resilience\n  totalClass: z\n    .number()\n    .nullish()\n    .transform((v) => v ?? 0),\n  totalActiveClass: z\n    .number()\n    .nullish()\n    .transform((v) => v ?? 0),\n  isActive: z.boolean(),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n});\n\nexport const subjectsResponseSchema = z.array(subjectSchema);\n\nexport const paginatedSubjectResponseSchema = z.object({\n  items: z.array(subjectSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\nexport const createSubjectPayloadSchema = z.object({\n  name: z\n    .string()\n    .min(1, \"Name is required\")\n    .max(150, \"Name must be at most 150 characters\")\n    .regex(\n      /^[A-Za-z0-9]+( [A-Za-z0-9]+)*$/,\n      \"Name must contain only letters, digits, and single spaces between words (no leading/trailing spaces)\"\n    ),\n  code: z\n    .string()\n    .min(1, \"Code is required\")\n    .max(20, \"Code must be at most 20 characters\")\n    .regex(\n      /^[A-Z0-9]+$/,\n      \"Code must contain only UPPERCASE letters and digits\"\n    ),\n  majorIds: z.array(z.number()).min(1, \"At least one major must be selected\"),\n});\n\nexport const updateSubjectPayloadSchema = z.object({\n  name: z\n    .string()\n    .min(1, \"Name cannot be empty\")\n    .max(150, \"Name must be at most 150 characters\")\n    .regex(\n      /^[A-Za-z0-9]+( [A-Za-z0-9]+)*$/,\n      \"Name must contain only letters, digits, and single spaces between words (no leading/trailing spaces)\"\n    ),\n  code: z\n    .string()\n    .min(1, \"Code cannot be empty\")\n    .max(20, \"Code must be at most 20 characters\")\n    .regex(\n      /^[A-Z0-9]+$/,\n      \"Code must contain only UPPERCASE letters and digits\"\n    ),\n  majorIds: z.array(z.number()).min(1, \"At least one major must be selected\"),\n  isActive: z.boolean(),\n});\n\n// Subject Import Schemas\nexport const importSubjectErrorSchema = z.object({\n  rowNumber: z.number(),\n  errorCode: z.string(),\n  message: z.string(),\n});\n\nexport const importSubjectsResponseSchema = z.object({\n  errors: z.array(importSubjectErrorSchema),\n});\n\n// Subject Classes Response (reuses class schema)\n// TODO: Nested GET /subjects/{id}/classes\n// Removed dedicated nested response schema because UI uses the generic Classes\n// page with subjectId filter. Add a paginated schema later if we implement an\n// inline classes-by-subject view.\n\n// Class Schemas\nexport const classSchema = z.object({\n  id: z.number(),\n  code: z.string(),\n  semester: z.object({\n    id: z.number(),\n    name: z.string(),\n    code: z.string(),\n    startDate: z.string().nullish(),\n    endDate: z.string().nullish(),\n    isActive: z.boolean(),\n  }),\n  subject: z.object({\n    id: z.number(),\n    name: z.string(),\n    code: z.string(),\n    isActive: z.boolean(),\n    // Optional majors array - returned by GET /classes/{id} for enrollment filtering\n    majors: z.array(z.object({\n      id: z.number(),\n      name: z.string(),\n      code: z.string(),\n      isActive: z.boolean(),\n    })).optional(),\n  }),\n  // Coerce missing/null counts to 0 for resilience\n  totalStudent: z\n    .number()\n    .nullish()\n    .transform((v) => v ?? 0),\n  totalEnrolledStudent: z\n    .number()\n    .nullish()\n    .transform((v) => v ?? 0),\n  totalSlot: z\n    .number()\n    .nullish()\n    .transform((v) => v ?? 0),\n  totalActiveSlot: z\n    .number()\n    .nullish()\n    .transform((v) => v ?? 0),\n  isActive: z.boolean(),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n});\n\nexport const classesResponseSchema = z.array(classSchema);\n\nexport const paginatedClassResponseSchema = z.object({\n  items: z.array(classSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\nexport const createClassPayloadSchema = z.object({\n  code: z\n    .string()\n    .min(1, \"Code is required\")\n    .max(20, \"Code must be at most 20 characters\")\n    .regex(\n      /^[A-Z0-9]+$/,\n      \"Code must contain only UPPERCASE letters and digits\"\n    ),\n  semesterId: z.number().min(1, \"Semester is required\"),\n  subjectId: z.number().min(1, \"Subject is required\"),\n});\n\nexport const updateClassPayloadSchema = z.object({\n  code: z\n    .string()\n    .min(1, \"Code cannot be empty\")\n    .max(20, \"Code must be at most 20 characters\")\n    .regex(\n      /^[A-Z0-9]+$/,\n      \"Code must contain only UPPERCASE letters and digits\"\n    ),\n  semesterId: z.number().min(1, \"Semester is required\"),\n  subjectId: z.number().min(1, \"Subject is required\"),\n  isActive: z.boolean(),\n});\n\n// Class Import Schemas\nexport const importClassErrorSchema = z.object({\n  rowNumber: z.number(),\n  errorCode: z.string(),\n  message: z.string(),\n});\n\nexport const importClassesResponseSchema = z.object({\n  errors: z.array(importClassErrorSchema),\n});\n\n// Room Schemas\nexport const roomSchema = z.object({\n  id: z.number(),\n  name: z.string(),\n  location: z.string().nullish().transform((v) => (v === \"\" || !v ? null : v)),\n  // Coerce missing/null counts to 0 for resilience\n  totalCameras: z\n    .number()\n    .nullish()\n    .transform((v) => v ?? 0),\n  activeCameras: z\n    .number()\n    .nullish()\n    .transform((v) => v ?? 0),\n  isActive: z.boolean(),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n});\n\nexport const roomsResponseSchema = z.array(roomSchema);\n\nexport const paginatedRoomResponseSchema = z.object({\n  items: z.array(roomSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\nexport const createRoomPayloadSchema = z.object({\n  name: z\n    .string()\n    .min(1, \"Room name is required\")\n    .max(150, \"Room name must not exceed 150 characters\")\n    .regex(\n      /^[A-Za-z0-9-]+( [A-Za-z0-9-]+)*$/,\n      \"Only letters, numbers, and hyphens with single spaces between words\"\n    ),\n  location: z.union([\n    z.string().max(255, \"Location must not exceed 255 characters\"),\n    z.literal(\"\")\n  ]).optional(),\n});\n\nexport const updateRoomPayloadSchema = z.object({\n  name: z\n    .string()\n    .min(1, \"Room name cannot be empty\")\n    .max(150, \"Room name must not exceed 150 characters\")\n    .regex(\n      /^[A-Za-z0-9-]+( [A-Za-z0-9-]+)*$/,\n      \"Only letters, numbers, and hyphens with single spaces between words\"\n    ),\n  location: z.union([\n    z.string().max(255, \"Location must not exceed 255 characters\"),\n    z.literal(\"\")\n  ]).optional(),\n  isActive: z.boolean(),\n});\n\n// Room Import Schemas\nexport const importRoomErrorSchema = z.object({\n  rowNumber: z.number(),\n  errorCode: z.string(),\n  message: z.string(),\n});\n\nexport const importRoomsResponseSchema = z.object({\n  errors: z.array(importRoomErrorSchema),\n});\n\nexport const roomCamerasResponseSchema = z.object({\n  room: z.object({\n    id: z.number(),\n    name: z.string(),\n    location: z.string().nullable(),\n  }),\n  items: z.array(z.any()), // Will be validated by cameraSchema if needed\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\nexport const roomSlotsResponseSchema = z.object({\n  room: z.object({\n    id: z.number(),\n    name: z.string(),\n    location: z.string().nullable(),\n  }),\n  items: z.array(z.any()), // Will be validated by slotSchema if needed\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\n// Camera Schemas\nexport const cameraSchema = z.object({\n  id: z.number(),\n  name: z.string(),\n  rtspUrl: z.string(),\n  room: z.object({\n    id: z.number(),\n    name: z.string(),\n    location: z.string().nullable(),\n    isActive: z.boolean().optional(),\n    createdAt: z.string().optional(),\n    updatedAt: z.string().optional(),\n  }),\n  isActive: z.boolean(),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n});\n\nexport const camerasResponseSchema = z.array(cameraSchema);\n\nexport const paginatedCameraResponseSchema = z.object({\n  items: z.array(cameraSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\nexport const createCameraPayloadSchema = z.object({\n  name: z\n    .string()\n    .min(1, \"Camera name is required\")\n    .max(150, \"Camera name must not exceed 150 characters\")\n    .regex(\n      /^[A-Za-z0-9-]+( [A-Za-z0-9-]+)*$/,\n      \"Only letters, numbers, and hyphens with single spaces between words\"\n    ),\n  rtspUrl: z\n    .string()\n    .min(1, \"RTSP URL is required\")\n    .max(512, \"RTSP URL must not exceed 512 characters\")\n    .regex(/^rtsp:\\/\\/.+/, \"RTSP URL must start with rtsp://\"),\n  roomId: z.number().min(1, \"Room is required\"),\n});\n\nexport const updateCameraPayloadSchema = z.object({\n  name: z\n    .string()\n    .min(1, \"Camera name cannot be empty\")\n    .max(150, \"Camera name must not exceed 150 characters\")\n    .regex(\n      /^[A-Za-z0-9-]+( [A-Za-z0-9-]+)*$/,\n      \"Only letters, numbers, and hyphens with single spaces between words\"\n    ),\n  rtspUrl: z\n    .string()\n    .min(1, \"RTSP URL cannot be empty\")\n    .max(512, \"RTSP URL must not exceed 512 characters\")\n    .regex(/^rtsp:\\/\\/.+/, \"RTSP URL must start with rtsp://\"),\n  roomId: z.number().min(1, \"Room is required\"),\n  isActive: z.boolean(),\n});\n\n// Camera Import Schemas\nexport const importCameraErrorSchema = z.object({\n  rowNumber: z.number(),\n  errorCode: z.string(),\n  message: z.string(),\n});\n\nexport const importCamerasResponseSchema = z.object({\n  errors: z.array(importCameraErrorSchema),\n});\n\n// Slot Schemas\nexport const slotSchema = z.object({\n  id: z.number(),\n  title: z.string().nullish(),\n  description: z.string().nullish(),\n  startTime: z.string(),\n  endTime: z.string(),\n  slotCategory: z.enum([\"LECTURE\", \"LECTURE_WITH_PT\", \"FINAL_EXAM\"]),\n  room: z.object({\n    id: z.number(),\n    name: z.string(),\n    location: z.string().nullable(),\n  }),\n  staffUser: z.object({\n    id: z.number(),\n    username: z.string(),\n    fullName: z.string(),\n  }).nullable().optional(),\n  semester: z\n    .object({\n      id: z.number(),\n      name: z.string(),\n      code: z.string(),\n    })\n    .nullable()\n    .optional(),\n  class: z\n    .object({\n      id: z.number(),\n      code: z.string(),\n      subject: z.object({\n        id: z.number(),\n        name: z.string(),\n        code: z.string(),\n      }),\n      semester: z.object({\n        id: z.number(),\n        name: z.string(),\n        code: z.string(),\n      }),\n    })\n    .nullable()\n    .optional(),\n  subjects: z\n    .array(\n      z.object({\n        id: z.number(),\n        name: z.string(),\n        code: z.string(),\n      })\n    )\n    .optional(),\n  // Coerce missing/null counts to 0 for resilience\n  totalStudent: z\n    .number()\n    .nullish()\n    .transform((v) => v ?? 0),\n  totalPresentStudent: z\n    .number()\n    .nullish()\n    .transform((v) => v ?? 0),\n  totalAbsentStudent: z\n    .number()\n    .nullish()\n    .transform((v) => v ?? 0),\n  totalNotYetStudent: z\n    .number()\n    .nullish()\n    .transform((v) => v ?? 0),\n  isActive: z.boolean(),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n  // Session metadata for face recognition workflow\n  sessionStatus: z\n    .enum([\"NOT_STARTED\", \"RUNNING\", \"STOPPED\"])\n    .default(\"NOT_STARTED\"),\n  scanCount: z.number().default(0),\n  lastSessionStoppedAt: z.string().nullish(),\n  // Exam session metadata (for LECTURE_WITH_PT and FINAL_EXAM)\n  examSessionStatus: z\n    .enum([\"NOT_STARTED\", \"RUNNING\", \"STOPPED\"])\n    .default(\"NOT_STARTED\"),\n  examScanCount: z.number().default(0),\n  lastExamSessionStoppedAt: z.string().nullish(),\n  // Student-specific attendance status (only populated for student-specific queries)\n  // OPTIONAL field - only set when fetching slots for a specific student\n  // Null for other contexts (lecturer view, admin view, etc.)\n  studentAttendanceStatus: z.enum([\"not_yet\", \"present\", \"absent\"]).optional(),\n});\n\nexport const paginatedSlotResponseSchema = z.object({\n  items: z.array(slotSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\nexport const createSlotPayloadSchema = z.object({\n  title: z.string().max(255, \"Title must not exceed 255 characters\").nullish(),\n  description: z\n    .string()\n    .max(1000, \"Description must not exceed 1000 characters\")\n    .nullish(),\n  startTime: z.string().min(1, \"Start time is required\"),\n  endTime: z.string().min(1, \"End time is required\"),\n  slotCategory: z.enum([\"LECTURE\", \"LECTURE_WITH_PT\", \"FINAL_EXAM\"]),\n  semesterId: z.number().min(1, \"Semester is required\"),\n  classId: z.number().nullable(),\n  roomId: z.number(),\n  staffUserId: z.number(),\n  subjectIds: z\n    .array(z.number())\n    .min(1, \"At least one subject is required\")\n    .optional(), // Optional in schema but required for FINAL_EXAM in form validation\n});\n\n// Update slot payload - supports both full update (Data Operator) and partial update (Lecturer)\n// Lecturer (SLOT_UPDATE_CATEGORY): Can only update slotCategory\n// Data Operator (SLOT_UPDATE): Can update all fields\nexport const updateSlotPayloadSchema = z.object({\n  title: z\n    .string()\n    .max(255, \"Title must not exceed 255 characters\")\n    .nullish()\n    .optional(),\n  description: z\n    .string()\n    .max(1000, \"Description must not exceed 1000 characters\")\n    .nullish()\n    .optional(),\n  startTime: z.string().min(1, \"Start time is required\").optional(),\n  endTime: z.string().min(1, \"End time is required\").optional(),\n  slotCategory: z.enum([\"LECTURE\", \"LECTURE_WITH_PT\", \"FINAL_EXAM\"]),\n  semesterId: z.number().min(1, \"Semester is required\").optional(),\n  classId: z.number().nullable().optional(),\n  roomId: z.number().optional(),\n  staffUserId: z.number().optional(),\n  isActive: z.boolean().optional(),\n  subjectIds: z\n    .array(z.number())\n    .optional(), // Optional - only for FINAL_EXAM slots\n});\n\n// Exam Participant Schemas\n// Schema for list view (simplified - lines 486-508 in API docs)\n// Schema for nested API response (backend returns nested student/subject objects)\nconst examParticipantNestedSchema = z.object({\n  id: z.number(),\n  studentUserId: z.number(),\n  student: z.object({\n    userId: z.number(),\n    fullName: z.string(),\n    email: z.string(),\n    rollNumber: z.string().nullable(),\n    baseUrl: z.string().nullable(),\n  }),\n  subject: z.object({\n    id: z.number(),\n    name: z.string(),\n    code: z.string(),\n  }),\n  isEnrolled: z.boolean(),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n});\n\n// Transform nested response to flat structure for UI\nexport const examParticipantSchema = examParticipantNestedSchema.transform((data) => ({\n  id: data.id,\n  studentUserId: data.studentUserId,\n  fullName: data.student.fullName,\n  rollNumber: data.student.rollNumber,\n  email: data.student.email,\n  majorName: null as string | null, // Not in response yet\n  majorCode: null as string | null, // Not in response yet\n  subjectId: data.subject.id,\n  subjectCode: data.subject.code,\n  subjectName: data.subject.name,\n  isEnrolled: data.isEnrolled,\n  enrolledAt: data.createdAt,\n  updatedAt: data.updatedAt,\n}));\n\n// Schema for detail view (full participant - lines 598-634 in API docs)\nexport const examParticipantDetailSchema = z.object({\n  id: z.number(), // Participant record ID (primary key)\n  slotId: z.number(),\n  studentUserId: z.number(),\n  subjectId: z.number(),\n  student: z.object({\n    userId: z.number(),\n    fullName: z.string(),\n    rollNumber: z.string(),\n    email: z.string(),\n    majorName: z.string(),\n  }),\n  slot: z.object({\n    id: z.number(),\n    title: z.string(),\n    startTime: z.string(),\n    endTime: z.string(),\n    slotCategory: z.enum([\"FINAL_EXAM\"]),\n    room: z.object({\n      id: z.number(),\n      name: z.string(),\n      location: z.string().nullable(),\n    }),\n    semester: z.object({\n      id: z.number(),\n      name: z.string(),\n      code: z.string(),\n    }),\n  }),\n  subject: z.object({\n    id: z.number(),\n    name: z.string(),\n    code: z.string(),\n  }),\n  isEnrolled: z.boolean(),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n});\n\n// Paginated list response (lines 459-517 in API docs)\nexport const paginatedExamParticipantResponseSchema = z.object({\n  slot: z.object({\n    id: z.number(),\n    title: z.string().nullish(), // âœ… Fix: Accept null/undefined\n    startTime: z.string(),\n    endTime: z.string(),\n    slotCategory: z.string(),\n    room: z.object({\n      id: z.number(),\n      name: z.string(),\n      location: z.string().nullish(), // âœ… Fix: Accept null/undefined\n    }),\n    semester: z.object({\n      id: z.number(),\n      name: z.string(),\n      code: z.string(),\n    }),\n  }),\n  subject: z.object({\n    id: z.number(),\n    name: z.string(),\n    code: z.string(),\n  }),\n  items: z.array(examParticipantSchema),\n  totalEnrolled: z.number(),\n  totalWithdrawn: z.number(),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\n// Paginated response for ALL participants (no subject filter)\n// Response for GET /exam-slots/{id}/all-participants endpoint\nexport const paginatedExamParticipantAllResponseSchema = z.object({\n  slot: z.object({\n    id: z.number(),\n    title: z.string().nullish(), // âœ… Fix: Accept null/undefined\n    startTime: z.string(),\n    endTime: z.string(),\n    slotCategory: z.string(),\n    room: z\n      .object({\n        id: z.number(),\n        name: z.string(),\n        location: z.string().nullish(), // âœ… Fix: Accept null/undefined\n      })\n      .nullable(),\n    semester: z.object({\n      id: z.number(),\n      name: z.string(),\n      code: z.string(),\n    }),\n  }),\n  // NO subject field at root - vÃ¬ cÃ³ nhiá»u subjects\n  items: z.array(examParticipantSchema), // Má»—i item cÃ³ subject riÃªng\n  totalEnrolled: z.number(),\n  totalWithdrawn: z.number(),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\n// Add participant payload (lines 256-259 in API docs)\nexport const addExamParticipantPayloadSchema = z.object({\n  studentUserId: z.number().min(1, \"Student is required\"),\n  subjectId: z.number().min(1, \"Subject is required\"),\n});\n\n// Update participant payload (lines 665-667 in API docs)\nexport const updateExamParticipantPayloadSchema = z.object({\n  isEnrolled: z.boolean(),\n});\n\n// TODO: Bulk CSV import schemas - lines 856-895 in API docs\n// CSV bulk import returns ONLY errors/warnings array\n// export const bulkImportParticipantsErrorSchema = z.object({\n//   rowNumber: z.number(),\n//   studentId: z.string(),\n//   subjectCode: z.string(),\n//   errorCode: z.string(),\n//   message: z.string(),\n//   type: z.enum([\"ERROR\", \"WARNING\"]),\n// });\n\n// export const bulkImportParticipantsResponseSchema = z.object({\n//   status: z.literal(200),\n//   message: z.literal(\"Import processed.\"),\n//   data: z.array(bulkImportParticipantsErrorSchema), // Empty array [] means all rows succeeded\n// });\n\n// Exam Slot Subject Schemas (for FINAL_EXAM slots)\nexport const examSlotSubjectSchema = z.object({\n  id: z.number(),\n  slotId: z.number(),\n  subject: z.object({\n    id: z.number(),\n    name: z.string(),\n    code: z.string(),\n    isActive: z.boolean(),\n  }),\n  createdAt: z.string(),\n});\n\n// List subjects response (lines 141-159 in API docs)\nexport const examSlotSubjectsResponseSchema = z.object({\n  slotId: z.number(),\n  subjects: z.array(\n    z.object({\n      id: z.number(),\n      name: z.string(),\n      code: z.string(),\n    })\n  ),\n  totalSubjects: z.number(),\n});\n\nexport const addExamSlotSubjectPayloadSchema = z.object({\n  subjectIds: z\n    .array(z.number().min(1))\n    .min(1, \"At least one subject is required\")\n    .max(50, \"Cannot assign more than 50 subjects at once\"),\n});\n\nexport const deleteExamSlotSubjectResponseSchema = z.object({\n  message: z.string(),\n});\n\nexport const addExamSlotSubjectResponseSchema = z.object({\n  slotId: z.number(),\n  subjects: z.array(\n    z.object({\n      id: z.number(),\n      name: z.string(),\n      code: z.string(),\n    })\n  ),\n  assignedCount: z.number(),\n  totalSubjects: z.number(),\n});\n\n// Slot Import Schemas\nexport const importSlotErrorSchema = z.object({\n  rowNumber: z.number(),\n  errorCode: z.string(),\n  message: z.string(),\n});\n\nexport const importSlotsResponseSchema = z.object({\n  errors: z.array(importSlotErrorSchema),\n});\n\n// Slot Session Status (start/stop/rescan responses)\nexport const sessionStatusResponseSchema = z.object({\n  activeCameras: z\n    .number()\n    .nullish()\n    .transform((v) => v ?? 0),\n  failedCameras: z\n    .number()\n    .nullish()\n    .transform((v) => v ?? 0),\n  totalRecognitions: z\n    .number()\n    .nullish()\n    .transform((v) => v ?? 0),\n  studentsWithEmbeddings: z\n    .number()\n    .nullish()\n    .transform((v) => v ?? 0),\n});\n\n// Slot Roster Schemas\nexport const attendanceStatusSchema = z.object({\n  recordId: z.number(),\n  status: z.enum([\"not_yet\", \"present\", \"absent\"]),\n  method: z.enum([\"auto\", \"manual\", \"system_finalize\"]).nullish(),\n  evidenceImageUrl: z.string().nullish(),\n  remark: z.string().nullish(),\n  needsReview: z.boolean().optional(),\n});\n\nexport const slotRosterItemSchema = z.object({\n  student: z.object({\n    userId: z.number(),\n    fullName: z.string(),\n    rollNumber: z.string().nullish(),\n    email: z.string().nullish(),\n    photoUrl: z.string().nullish(), // Photo URL from backend (e.g., \"/api/v1/student-photos/123/123_profile.jpg\")\n  }),\n  subject: z\n    .object({\n      id: z.number(),\n      name: z.string(),\n      code: z.string(),\n    })\n    .nullish(), // Only present for FINAL_EXAM slots\n  regularAttendance: attendanceStatusSchema.nullish(),\n  examAttendance: attendanceStatusSchema.nullish(),\n});\n\nexport const slotRosterResponseSchema = z.array(slotRosterItemSchema);\n\nexport const slotActionResponseSchema = z.object({\n  success: z.boolean().optional(),\n  message: z.string().optional(),\n});\n\n// Attendance Record Schemas\nexport const attendanceRecordSchema = z.object({\n  id: z.number(),\n  student: z.object({\n    userId: z.number(),\n    fullName: z.string(),\n    rollNumber: z.string(),\n    email: z.string(),\n  }),\n  slot: z.object({\n    id: z.number(),\n    title: z.string().nullish(),\n    startTime: z.string(),\n    endTime: z.string(),\n    slotCategory: z.enum([\"LECTURE\", \"LECTURE_WITH_PT\", \"FINAL_EXAM\"]),\n    class: z\n      .object({\n        id: z.number(),\n        code: z.string(),\n        subject: z.object({\n          name: z.string(),\n          code: z.string(),\n        }),\n        semester: z.object({\n          name: z.string(),\n          code: z.string(),\n        }),\n      })\n      .nullish(),\n  }),\n  status: z.enum([\"not_yet\", \"present\", \"absent\"]),\n  method: z.enum([\"auto\", \"manual\", \"system_finalize\"]).nullish(),\n  recordedAt: z.string(),\n  remark: z.string().nullish(),\n  needsReview: z.boolean().optional(),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n});\n\nexport const paginatedAttendanceRecordResponseSchema = z.object({\n  items: z.array(attendanceRecordSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\nexport const updateAttendancePayloadSchema = z.object({\n  recordId: z.number().min(1, \"Record ID is required\"),\n  status: z.enum([\"present\", \"absent\"], {\n    message: \"Status must be either 'present' or 'absent'\",\n  }),\n  remark: z.string().min(1, \"Remark is required for manual attendance updates\"),\n});\n\n// Regular Attendance Remark Schemas\nexport const createRegularAttendanceRemarkPayloadSchema = z.object({\n  remark: z\n    .string()\n    .min(1, \"Remark is required\")\n    .max(1000, \"Remark must not exceed 1000 characters\"),\n});\n\n// Exam Attendance Record Schemas\nexport const examAttendanceRecordSchema = z.object({\n  id: z.number(),\n  student: z.object({\n    userId: z.number(),\n    fullName: z.string(),\n    rollNumber: z.string(),\n    email: z.string(),\n  }),\n  slot: z.object({\n    id: z.number(),\n    title: z.string().nullish(),\n    startTime: z.string(),\n    endTime: z.string(),\n    slotCategory: z.enum([\"LECTURE_WITH_PT\", \"FINAL_EXAM\"]),\n    class: z\n      .object({\n        id: z.number(),\n        code: z.string(),\n        subject: z.object({\n          name: z.string(),\n          code: z.string(),\n        }),\n        semester: z.object({\n          name: z.string(),\n          code: z.string(),\n        }),\n      })\n      .nullish(),\n  }),\n  subject: z\n    .object({\n      id: z.number(),\n      name: z.string(),\n      code: z.string(),\n    })\n    .optional(),\n  status: z.enum([\"not_yet\", \"present\", \"absent\"]),\n  method: z.enum([\"auto\", \"manual\", \"system_finalize\"]).nullish(),\n  recordedAt: z.string(),\n  remark: z.string().nullish(),\n  needsReview: z.boolean().optional(),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n});\n\nexport const paginatedExamAttendanceRecordResponseSchema = z.object({\n  items: z.array(examAttendanceRecordSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\nexport const updateExamAttendancePayloadSchema = z.object({\n  status: z.enum([\"present\", \"absent\"], {\n    message: \"Status must be either 'present' or 'absent'\",\n  }),\n  remark: z\n    .string()\n    .min(1, \"Remark is required for manual exam attendance updates\"),\n});\n\n// Exam Attendance Remark Schemas\nexport const createExamAttendanceRemarkPayloadSchema = z.object({\n  remark: z\n    .string()\n    .min(1, \"Remark is required\")\n    .max(1000, \"Remark must not exceed 1000 characters\"),\n});\n\n// Bulk Update Schemas\nexport const bulkUpdateItemSchema = z.object({\n  recordId: z.number().min(1, \"Record ID is required\"),\n  status: z.enum([\"present\", \"absent\", \"not_yet\"], {\n    message: \"Status must be 'present', 'absent', or 'not_yet'\",\n  }),\n  remark: z\n    .string()\n    .max(1000, \"Remark must not exceed 1000 characters\")\n    .optional(),\n});\n\nexport const bulkAttendanceUpdatePayloadSchema = z.object({\n  updates: z\n    .array(bulkUpdateItemSchema)\n    .min(1, \"At least one update is required\"),\n  notYetResolution: z.enum([\"MARK_AS_ABSENT\", \"MARK_AS_PRESENT\"]).optional(),\n});\n\nexport const updateResultItemSchema = z.object({\n  recordId: z.number(),\n  success: z.boolean(),\n  errorCode: z.string().optional(),\n  errorMessage: z.string().optional(),\n});\n\nexport const bulkUpdateResultSchema = z.object({\n  successCount: z.number(),\n  failureCount: z.number(),\n  convertedCount: z.number(),\n  results: z.array(updateResultItemSchema),\n});\n\nexport const examUpdateResultItemSchema = z.object({\n  recordId: z.number(),\n  success: z.boolean(),\n  errorCode: z.string().optional(),\n  errorMessage: z.string().optional(),\n});\n\nexport const bulkExamUpdateResultSchema = z.object({\n  successCount: z.number(),\n  failureCount: z.number(),\n  convertedCount: z.number(),\n  results: z.array(examUpdateResultItemSchema),\n});\n\n// Submit Attendance (unified) Schemas\nexport const submitAttendanceItemSchema = z.object({\n  studentUserId: z.number().min(1, \"Student user ID is required\"),\n  status: z.enum([\"not_yet\", \"present\", \"absent\"], {\n    message: \"Status must be 'not_yet', 'present', or 'absent'\",\n  }),\n  remark: z.string().max(1000).optional(),\n});\n\nexport const submitAttendancePayloadSchema = z.object({\n  attendanceType: z.enum([\"REGULAR\", \"EXAM\"]).optional(), // Route to correct attendance table\n  notYetResolution: z.enum([\"MARK_AS_ABSENT\", \"MARK_AS_PRESENT\"]).optional(), // How to finalize NOT_YET students\n  submissions: z\n    .array(submitAttendanceItemSchema)\n    .min(1, \"At least one submission is required\")\n    .optional(), // Optional when using notYetResolution for bulk finalization\n});\n\nexport const submitAttendanceResultItemSchema = z.object({\n  studentUserId: z.number(),\n  success: z.boolean(),\n  updatedRecords: z\n    .object({\n      regularAttendance: z\n        .object({\n          id: z.number(),\n          status: z.enum([\"not_yet\", \"present\", \"absent\"]),\n          method: z.enum([\"auto\", \"manual\", \"system_finalize\"]).nullish(),\n          recordedAt: z.string(),\n        })\n        .nullable()\n        .optional(),\n      examAttendance: z\n        .object({\n          id: z.number(),\n          status: z.enum([\"not_yet\", \"present\", \"absent\"]),\n          method: z.enum([\"auto\", \"manual\", \"system_finalize\"]).nullish(),\n          recordedAt: z.string(),\n        })\n        .nullable()\n        .optional(),\n    })\n    .nullable()\n    .optional(),\n  errorCode: z.string().nullish(),\n  errorMessage: z.string().nullish(),\n});\n\nexport const submitAttendanceResponseSchema = z.object({\n  successCount: z.number(),\n  failureCount: z.number(),\n  results: z.array(submitAttendanceResultItemSchema),\n});\n\n// Enrollment Schemas\nexport const enrollmentSchema = z.object({\n  classId: z.number(),\n  studentUserId: z.number(), // Top-level student ID reference\n  student: z.object({\n    fullName: z.string(),\n    rollNumber: z.string(),\n    email: z.string(),\n    major: z\n      .object({\n        name: z.string(),\n        code: z.string(),\n      })\n      .nullish()\n      .transform((v) => v ?? { name: \"Unknown\", code: \"N/A\" }),\n  }),\n  class: z.object({\n    id: z.number(),\n    code: z.string(),\n    subject: z.object({\n      id: z.number(),\n      name: z.string(),\n      code: z.string(),\n    }),\n    semester: z.object({\n      id: z.number(),\n      name: z.string(),\n      code: z.string(),\n    }),\n  }),\n  isEnrolled: z.boolean(),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n});\n\nexport const paginatedEnrollmentResponseSchema = z.object({\n  items: z.array(enrollmentSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\nexport const createEnrollmentPayloadSchema = z.object({\n  classId: z.number().min(1, \"Class is required\"),\n  studentUserId: z.number().min(1, \"Student is required\"),\n});\n\nexport const updateEnrollmentPayloadSchema = z.object({\n  classId: z.number().min(1, \"Class ID is required\"),\n  studentUserId: z.number().min(1, \"Student User ID is required\"),\n  isEnrolled: z.boolean(),\n});\n\nexport const bulkEnrollmentResponseSchema = z.object({\n  totalRows: z.number(),\n  successCount: z.number(),\n  skippedCount: z.number(),\n  failedCount: z.number(),\n  summary: z.object({\n    newEnrollments: z.number(),\n    reEnrollments: z.number(),\n    alreadyEnrolled: z.number(),\n    errors: z.number(),\n  }),\n  errors: z.array(\n    z.object({\n      row: z.number(),\n      studentId: z.string(),\n      classCode: z.string(),\n      semesterCode: z.string(),\n      reason: z.string(),\n    })\n  ),\n  warnings: z.array(\n    z.object({\n      row: z.number(),\n      studentId: z.string(),\n      classCode: z.string(),\n      semesterCode: z.string(),\n      reason: z.string(),\n    })\n  ),\n});\n\nexport const classEnrollmentSchema = z.object({\n  userId: z.number(),\n  studentUserId: z.number(),\n  fullName: z.string(),\n  rollNumber: z.string(),\n  email: z.string(),\n  major: z\n    .object({\n      name: z.string(),\n      code: z.string(),\n    })\n    .nullish()\n    .transform((v) => v ?? { name: \"Unknown\", code: \"N/A\" }),\n  baseUrl: z.string().nullish(),\n  isEnrolled: z.boolean(),\n  enrolledAt: z.string(),\n  updatedAt: z.string(),\n});\n\nexport const paginatedClassEnrollmentResponseSchema = z.object({\n  class: z.object({\n    id: z.number(),\n    code: z.string(),\n    subject: z.object({\n      id: z.number(),\n      name: z.string(),\n      code: z.string(),\n    }),\n    semester: z.object({\n      id: z.number(),\n      name: z.string(),\n      code: z.string(),\n    }),\n  }),\n  items: z.array(classEnrollmentSchema),\n  totalEnrolled: z.number(),\n  totalWithdrawn: z.number(),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\n// Enrollment Import Schemas\nexport const importEnrollmentErrorSchema = z.object({\n  rowNumber: z.number(),\n  errorCode: z.string(),\n  message: z.string(),\n});\n\nexport const importEnrollmentsResponseSchema = z.object({\n  errors: z.array(importEnrollmentErrorSchema),\n});\n\n// Student Profile Schemas\n// Schema for LIST endpoint - minimal fields returned in paginated list\nexport const studentProfileListItemSchema = z.object({\n  userId: z.number(),\n  fullName: z.string(),\n  email: z.string(),\n  username: z.string(),\n  rollNumber: z.string(),\n  major: z.object({\n    id: z.number(),\n    name: z.string(),\n    code: z.string(),\n    isActive: z.boolean(),\n  }),\n  baseUrl: z.string().nullable(),\n  isActive: z.boolean(),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n});\n\n// Schema for DETAIL endpoint - includes additional fields\nexport const studentProfileDetailSchema = studentProfileListItemSchema.extend({\n  photoUrl: z.string().nullable().optional(), // Generated URL from baseUrl by backend, optional if file missing\n  roles: z.tuple([z.literal(\"STUDENT\")]),\n  hasActiveEmbedding: z.boolean(),\n  canUseFaceRecognition: z.boolean(),\n});\n\n// Full schema with optional fields for internal use (Create/Update)\nexport const studentProfileSchema = studentProfileDetailSchema.extend({\n  identityStatus: z.enum([\"PENDING\", \"APPROVED\", \"REJECTED\"]).optional(),\n  latestIdentitySubmissionType: z.enum([\"initial\", \"update\"]).optional(),\n  latestIdentitySubmissionDate: z.string().optional(),\n});\n\nexport const paginatedStudentProfileResponseSchema = z.object({\n  items: z.array(studentProfileListItemSchema), // Use LIST schema for paginated response\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\nexport const createStudentProfilePayloadSchema = z.object({\n  fullName: z\n    .string()\n    .min(1, \"Full name is required\")\n    .max(150, \"Full name must be at most 150 characters\"),\n  email: z\n    .string()\n    .min(1, \"Email is required\")\n    .email(\"Invalid email format\")\n    .max(255, \"Email must be at most 255 characters\"),\n  username: z\n    .string()\n    .min(1, \"Username is required\")\n    .max(50, \"Username must be at most 50 characters\")\n    .regex(\n      /^[a-zA-Z0-9_]+$/,\n      \"Username must contain only letters, numbers, and underscores\"\n    ),\n  rollNumber: z\n    .string()\n    .min(1, \"Roll number is required\")\n    .max(20, \"Roll number must be at most 20 characters\")\n    .regex(\n      /^[A-Za-z0-9]+$/,\n      \"Roll number must contain only letters and digits\"\n    ),\n  majorId: z.number().min(1, \"Major is required\"),\n});\n\nexport const updateStudentProfilePayloadSchema = z.object({\n  fullName: z\n    .string()\n    .min(1, \"Full name cannot be empty\")\n    .max(150, \"Full name must be at most 150 characters\"),\n  email: z\n    .string()\n    .min(1, \"Email cannot be empty\")\n    .email(\"Invalid email format\")\n    .max(255, \"Email must be at most 255 characters\"),\n  rollNumber: z\n    .string()\n    .min(1, \"Roll number cannot be empty\")\n    .max(20, \"Roll number must be at most 20 characters\")\n    .regex(\n      /^[A-Za-z0-9]+$/,\n      \"Roll number must contain only letters and digits\"\n    ),\n  username: z\n    .string()\n    .min(1, \"Username cannot be empty\")\n    .max(50, \"Username must be at most 50 characters\")\n    .regex(\n      /^[A-Za-z0-9_-]+$/,\n      \"Username must contain only letters, digits, underscores, and hyphens\"\n    ),\n  majorId: z.number().min(1, \"Major is required\"),\n  isActive: z.boolean(),\n});\n\nexport const studentClassSchema = z.object({\n  classId: z.number(),\n  classCode: z.string(),\n  subject: z.object({\n    id: z.number(),\n    name: z.string(),\n    code: z.string(),\n  }),\n  semester: z.object({\n    id: z.number(),\n    name: z.string(),\n    code: z.string(),\n  }),\n  isEnrolled: z.boolean(),\n  enrolledAt: z.string(),\n  updatedAt: z.string(),\n});\n\nexport const paginatedStudentClassResponseSchema = z.object({\n  items: z.array(studentClassSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\nexport const attendanceHistoryItemSchema = z.object({\n  recordId: z.string(),\n  recordType: z.enum([\"regular\", \"exam\"]),\n  slotId: z.number(),\n  slotDate: z.string(),\n  slotTime: z.string(),\n  slotCategory: z.enum([\"LECTURE\", \"LECTURE_WITH_PT\", \"FINAL_EXAM\"]),\n  subjectCode: z.string(),\n  subjectName: z.string(),\n  className: z.string().nullable(),\n  lecturerName: z.string(),\n  roomName: z.string(),\n  attendanceStatus: z.enum([\"present\", \"absent\", \"not_yet\"]),\n  method: z.enum([\"auto\", \"manual\", \"system_finalize\"]),\n  remark: z.string().nullable(),\n});\n\nconst attendanceStatsSchema = z.object({\n  totalSlots: z.number(),\n  presentCount: z.number(),\n  absentCount: z.number(),\n  notYetCount: z.number(),\n  attendanceRate: z.number().optional(),\n});\n\nexport const attendanceHistoryResponseSchema = z.object({\n  items: z.array(attendanceHistoryItemSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n  summary: z.object({\n    overall: attendanceStatsSchema,\n    byType: z.object({\n      class: attendanceStatsSchema,\n      exam: attendanceStatsSchema,\n    }),\n    byCategory: z.object({\n      LECTURE: attendanceStatsSchema.optional(),\n      LECTURE_WITH_PT: attendanceStatsSchema.optional(),\n      FINAL_EXAM: attendanceStatsSchema.optional(),\n    }),\n  }),\n});\n\n// Student Profile Import Schemas\nexport const importStudentProfileErrorSchema = z.object({\n  rowNumber: z.number(),\n  errorCode: z.string(),\n  message: z.string(),\n});\n\nexport const importStudentProfilesResponseSchema = z.object({\n  errors: z.array(importStudentProfileErrorSchema),\n});\n\n// Student Profile Bulk Upload Photos & Embeddings Response\nexport const importPhotosEmbeddingsResponseSchema = z.object({\n  successCount: z.number(),\n  failureCount: z.number(),\n  errors: z.array(importStudentProfileErrorSchema),\n});\n\n// Staff Profile Schemas\nexport const staffProfileSchema = z.object({\n  userId: z.number(),\n  fullName: z.string(),\n  email: z.string(),\n  username: z.string(),\n  staffCode: z.string(),\n  roles: z.array(\n    z.enum([\"LECTURER\", \"SUPERVISOR\", \"DATA_OPERATOR\", \"STUDENT\"])\n  ),\n  isActive: z.boolean(),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n});\n\nexport const paginatedStaffProfileResponseSchema = z.object({\n  items: z.array(staffProfileSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\nexport const createStaffProfilePayloadSchema = z.object({\n  fullName: z\n    .string()\n    .min(1, \"Full name is required\")\n    .max(150, \"Full name must be at most 150 characters\")\n    .regex(\n      /^[\\p{L}\\p{M}\\p{P}\\p{Zs}0-9]+$/u,\n      \"Full name contains invalid characters\"\n    ),\n  email: z\n    .string()\n    .min(1, \"Email is required\")\n    .email(\"Invalid email format\")\n    .max(255, \"Email must be at most 255 characters\"),\n  username: z\n    .string()\n    .min(1, \"Username is required\")\n    .max(50, \"Username must be at most 50 characters\")\n    .regex(\n      /^[A-Za-z0-9_]+$/,\n      \"Username must contain only letters, digits, and underscores\"\n    ),\n  staffCode: z\n    .string()\n    .min(1, \"Staff code is required\")\n    .max(20, \"Staff code must be at most 20 characters\")\n    .regex(\n      /^[A-Za-z0-9]+$/,\n      \"Staff code must contain only letters and digits (e.g., LECT0001, SUP001, DOP0123)\"\n    ),\n  roles: z\n    .array(z.enum([\"LECTURER\", \"SUPERVISOR\", \"DATA_OPERATOR\", \"STUDENT\"]))\n    .min(1, \"At least one role is required\"),\n});\n\nexport const updateStaffProfilePayloadSchema = z.object({\n  fullName: z\n    .string()\n    .min(1, \"Full name cannot be empty\")\n    .max(150, \"Full name must be at most 150 characters\")\n    .regex(\n      /^[\\p{L}\\p{M}\\p{P}\\p{Zs}0-9]+$/u,\n      \"Full name contains invalid characters\"\n    ),\n  email: z\n    .string()\n    .min(1, \"Email cannot be empty\")\n    .email(\"Invalid email format\")\n    .max(255, \"Email must be at most 255 characters\"),\n  username: z\n    .string()\n    .min(1, \"Username cannot be empty\")\n    .max(50, \"Username must be at most 50 characters\")\n    .regex(\n      /^[A-Za-z0-9_]+$/,\n      \"Username must contain only letters, digits, and underscores\"\n    ),\n  staffCode: z\n    .string()\n    .min(1, \"Staff code cannot be empty\")\n    .max(20, \"Staff code must be at most 20 characters\")\n    .regex(\n      /^[A-Za-z0-9]+$/,\n      \"Staff code must contain only letters and digits (e.g., LECT0001, SUP001, DOP0123)\"\n    ),\n  roles: z\n    .array(z.enum([\"LECTURER\", \"SUPERVISOR\", \"DATA_OPERATOR\", \"STUDENT\"]))\n    .min(1, \"At least one role is required\"),\n  isActive: z.boolean(),\n});\n\nexport const staffClassSchema = z.object({\n  id: z.number(),\n  code: z.string(),\n  subject: z.object({\n    id: z.number(),\n    name: z.string(),\n    code: z.string(),\n    isActive: z.boolean(),\n  }),\n  semester: z.object({\n    id: z.number(),\n    name: z.string(),\n    code: z.string(),\n  }),\n  role: z.enum([\"LECTURER\", \"SUPERVISOR\"]),\n  isActive: z.boolean(),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n});\n\nexport const paginatedStaffClassResponseSchema = z.object({\n  items: z.array(staffClassSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\n// Staff Subjects Schemas (unique subjects taught/supervised by a staff)\nexport const staffSubjectAssignedClassSchema = z.object({\n  id: z.number(),\n  code: z.string(),\n});\n\nexport const staffSubjectSchema = z.object({\n  id: z.number(),\n  name: z.string(),\n  code: z.string(),\n  majors: z.array(\n    z.object({\n      id: z.number(),\n      name: z.string(),\n      code: z.string(),\n      isActive: z.boolean(),\n    })\n  ),\n  totalClass: z.number(),\n  totalActiveClass: z.number(),\n  role: z.enum([\"LECTURER\", \"SUPERVISOR\"]),\n  assignedClasses: z\n    .array(staffSubjectAssignedClassSchema)\n    .transform((classes) => {\n      // Deduplicate by id (backend may return duplicates due to JOIN)\n      const uniqueMap = new Map(classes.map((c) => [c.id, c]));\n      return Array.from(uniqueMap.values());\n    }),\n  isActive: z.boolean(),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n});\n\nexport const paginatedStaffSubjectResponseSchema = z.object({\n  items: z.array(staffSubjectSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\n// Staff Rooms Schemas (unique rooms used by a staff)\nexport const staffRoomUpcomingSlotSchema = z.object({\n  id: z.number(),\n  title: z.string().nullable(),\n  startTime: z.string(),\n  endTime: z.string(),\n  slotCategory: z.enum([\"LECTURE\", \"LECTURE_WITH_PT\", \"FINAL_EXAM\"]),\n});\n\nexport const staffRoomSchema = z.object({\n  id: z.number(),\n  name: z.string(),\n  location: z.string().nullable(),\n  usageCount: z.number(),\n  lastUsedAt: z.string(),\n  upcomingSlots: z.array(staffRoomUpcomingSlotSchema),\n  isActive: z.boolean(),\n  createdAt: z.string(),\n  updatedAt: z.string(),\n});\n\nexport const paginatedStaffRoomResponseSchema = z.object({\n  items: z.array(staffRoomSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n});\n\n// Staff Profile Import Schemas\nexport const importStaffProfileErrorSchema = z.object({\n  rowNumber: z.number(),\n  errorCode: z.string(),\n  message: z.string(),\n});\n\nexport const importStaffProfilesResponseSchema = z.object({\n  errors: z.array(importStaffProfileErrorSchema),\n});\n\n// Import Exam Slot Participants Schemas\nexport const importExamSlotParticipantErrorSchema = z.object({\n  rowNumber: z.number(),\n  errorCode: z.string(),\n  message: z.string(),\n});\n\nexport const importExamSlotParticipantsResponseSchema = z.object({\n  errors: z.array(importExamSlotParticipantErrorSchema),\n});\n\n// (Removed) WebSocket Message Schemas\n// User Password Update Schemas\nexport const updatePasswordPayloadSchema = z\n  .object({\n    oldPassword: z.string().min(1, \"Current password is required\"),\n    newPassword: z.string().min(1, \"New password is required\"),\n    confirmPassword: z.string().min(1, \"Confirm password is required\"),\n  })\n  .refine((data) => data.newPassword === data.confirmPassword, {\n    message: \"Passwords don't match\",\n    path: [\"confirmPassword\"],\n  });\n\nexport const updatePasswordResponseSchema = z.object({\n  message: z.string(),\n});\n\n// Student Attendance History Schemas\nexport const studentAttendanceHistoryItemSchema = z.object({\n  slotId: z.number(),\n  recordId: z.string().nullable(),\n  recordType: z.enum([\"exam\", \"class\"]).nullable(),\n  slotDate: z.string(),\n  slotTime: z.string(),\n  slotCategory: z.enum([\"LECTURE\", \"LECTURE_WITH_PT\", \"FINAL_EXAM\"]),\n  className: z.string().nullable(),\n  subjectCode: z.string(),\n  subjectName: z.string(),\n  lecturerName: z.string(),\n  roomName: z.string(),\n  attendanceStatus: z.enum([\"present\", \"absent\", \"not_yet\"]).nullable(),\n  method: z.enum([\"auto\", \"manual\"]).nullable(),\n  remark: z.string().nullable(),\n});\n\nexport const studentAttendanceHistorySummarySchema = z.object({\n  overall: z.object({\n    totalSlots: z.number(),\n    presentCount: z.number(),\n    absentCount: z.number(),\n    notYetCount: z.number(),\n    attendanceRate: z.number(),\n  }),\n  byType: z.object({\n    exam: z.object({\n      totalSlots: z.number(),\n      presentCount: z.number(),\n      absentCount: z.number(),\n      notYetCount: z.number(),\n      attendanceRate: z.number(),\n    }),\n    class: z.object({\n      totalSlots: z.number(),\n      presentCount: z.number(),\n      absentCount: z.number(),\n      notYetCount: z.number(),\n      attendanceRate: z.number(),\n    }),\n  }),\n  byCategory: z.record(\n    z.string(),\n    z.object({\n      totalSlots: z.number(),\n      presentCount: z.number(),\n      absentCount: z.number(),\n      notYetCount: z.number(),\n      attendanceRate: z.number(),\n    })\n  ),\n});\n\nexport const studentAttendanceHistoryResponseSchema = z.object({\n  items: z.array(studentAttendanceHistoryItemSchema),\n  totalPages: z.number(),\n  currentPage: z.number(),\n  pageSize: z.number(),\n  totalItems: z.number(),\n  summary: studentAttendanceHistorySummarySchema,\n});\n\nexport const studentAttendanceHistoryParamsSchema = z.object({\n  page: z.number().optional(),\n  pageSize: z.number().optional(),\n  sort: z.enum([\"asc\", \"desc\"]).optional(),\n  search: z.string().optional(),\n  semesterId: z.number().optional(),\n  slotCategory: z.enum([\"LECTURE\", \"LECTURE_WITH_PT\", \"FINAL_EXAM\"]).optional(),\n  attendanceType: z.string().optional(),\n  attendanceStatus: z.enum([\"present\", \"absent\", \"not_yet\"]).optional(),\n  isActive: z.boolean().optional(),\n});\n\n// Lecturer Schedule Schemas\nexport const scheduleItemSchema = z.object({\n  id: z.number(),\n  courseCode: z.string(),\n  courseName: z.string(),\n  className: z.string(),\n  classId: z.string(),\n  startTime: z.string(),\n  endTime: z.string(),\n  room: z.string(),\n});\n\nexport const scheduleDaySchema = z.object({\n  date: z.string(), // YYYY-MM-DD format\n  schedules: z.array(scheduleItemSchema),\n});\n\nexport const monthlyScheduleSchema = z.object({\n  year: z.number(),\n  month: z.number(),\n  days: z.array(scheduleDaySchema),\n});\n\nexport const backendScheduleItemSchema = z.object({\n  id: z.number(),\n  date: z.string(), // YYYY-MM-DD format\n  courseCode: z.string(),\n  courseName: z.string(),\n  className: z.string(),\n  classId: z.string(),\n  startTime: z.string(),\n  endTime: z.string(),\n  room: z.string(),\n});\n\nexport const backendScheduleResponseSchema = z.object({\n  data: z.array(backendScheduleItemSchema),\n});\n\n// Slot Detail Response Schema\nexport const slotDetailStudentSchema = z.object({\n  userId: z.number(),\n  rollNumber: z.string(),\n  fullName: z.string(),\n  email: z.string(),\n  evidenceUrl: z.string().nullish(),\n  photoUrl: z.string().nullish(),\n  status: z.enum([\"not_yet\", \"present\", \"absent\"]).nullish(),\n  recordedAt: z.string().nullish(),\n});\n\nexport const slotDetailDataSchema = z.object({\n  slotId: z.number(),\n  title: z.string(),\n  description: z.string().nullish(),\n  startTime: z.string(),\n  endTime: z.string(),\n  slotCategory: z.enum([\"LECTURE\", \"LECTURE_WITH_PT\", \"FINAL_EXAM\"]),\n  sessionStatus: z.enum([\"NOT_STARTED\", \"STARTED\", \"STOPPED\"]),\n  students: z.array(slotDetailStudentSchema),\n});\n\nexport const slotDetailResponseSchema = z.object({\n  data: slotDetailDataSchema,\n});\n\n// Roster Schema (for lecturer roster page)\nexport const rosterStudentSchema = z.object({\n  id: z.string(),\n  studentId: z.string(),\n  fullName: z.string(),\n  email: z.string(),\n  avatarUrl: z.string().nullish(),\n});\n\nexport const rosterSchema = z.object({\n  classId: z.string(),\n  className: z.string(),\n  courseName: z.string(),\n  courseCode: z.string(),\n  scheduleDate: z.string(), // YYYY-MM-DD\n  students: z.array(rosterStudentSchema),\n  attendanceRecords: z.array(z.any()), // Can be refined later based on actual structure\n});\n"
    }
  ]
}